<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionarios Kinesiología</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

    <body>

    <button class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <div class="container mt-4 mb-5">
        <h1>Cuestionarios de Kinesiología</h1>

        <div class="card mb-4" id="info-paciente-card">
            <div class="card-header">
                Información del Paciente
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="nombrePaciente" class="form-label">Nombre del Paciente:</label>
                        <input type="text" class="form-control" id="nombrePaciente" placeholder="Ingrese nombre (opcional)">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="fechaEvaluacion" class="form-label">Fecha de Evaluación:</label>
                        <input type="date" class="form-control" id="fechaEvaluacion">
                    </div>
                </div>
                <p class="text-muted small">Nota: Esta información se incluirá en los PDF generados.</p>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: 0%;" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">0 de 0 cuestionarios completados</div>
        </div>

        <div class="nav-pills-container">
            <ul class="nav nav-pills" id="questionnaireTabs">
                <!-- Los tabs se generarán dinámicamente con JavaScript -->
            </ul>
        </div>

        <div id="contenedor-cuestionarios">
            <div class="cuestionario-item" id="item-psfs"> <div class="cuestionario-header" onclick="toggleCuestionario('psfs-content')">
              <h4><i class="fas fa-plus-circle"></i> PSFS (Patient-Specific Functional Scale)</h4>
              <div class="resultado-badge no-completado" id="psfs-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="psfs-content" style="display: none;">
              <p class="mb-3">Identificar hasta 3 actividades importantes que el paciente no puede realizar o tiene dificultad debido a su problema. Calificar la capacidad para realizar cada actividad en una escala de 0-10.</p>

              <div class="row mb-3"> <div class="col-md-8"> <div class="mb-3"> <label for="psfs_actividad1" class="form-label">Actividad 1</label>
                    <input type="text" id="psfs_actividad1" name="psfs_actividad1" class="form-control" placeholder="Ej: Subir escaleras, Levantar objetos pesados, etc.">
                  </div>
                </div>
                <div class="col-md-4"> <div class="mb-3"> <label for="psfs_puntuacion1" class="form-label">Puntuación (0-10)</label>
                    <select id="psfs_puntuacion1" name="psfs_puntuacion1" class="form-select" onchange="calcularPSFS()">
                      <option value="">Seleccionar</option>
                      <option value="0">0 - Incapaz de realizar la actividad</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="row mb-3"> <div class="col-md-8"> <div class="mb-3"> <label for="psfs_actividad2" class="form-label">Actividad 2</label>
                    <input type="text" id="psfs_actividad2" name="psfs_actividad2" class="form-control" placeholder="Ej: Sentarse por periodos prolongados, Dormir, etc.">
                  </div>
                </div>
                <div class="col-md-4"> <div class="mb-3"> <label for="psfs_puntuacion2" class="form-label">Puntuación (0-10)</label>
                    <select id="psfs_puntuacion2" name="psfs_puntuacion2" class="form-select" onchange="calcularPSFS()">
                      <option value="">Seleccionar</option>
                      <option value="0">0 - Incapaz de realizar la actividad</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="row mb-3"> <div class="col-md-8"> <div class="mb-3"> <label for="psfs_actividad3" class="form-label">Actividad 3</label>
                    <input type="text" id="psfs_actividad3" name="psfs_actividad3" class="form-control" placeholder="Ej: Girar el cuello, Practicar deporte, etc.">
                  </div>
                </div>
                <div class="col-md-4"> <div class="mb-3"> <label for="psfs_puntuacion3" class="form-label">Puntuación (0-10)</label>
                    <select id="psfs_puntuacion3" name="psfs_puntuacion3" class="form-select" onchange="calcularPSFS()">
                      <option value="">Seleccionar</option>
                      <option value="0">0 - Incapaz de realizar la actividad</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="psfs-resultado">
                    <div class="resultado-label">Puntuación PSFS:</div>
                    <div class="resultado-valor" id="psfs-valor">-</div>
                    <div class="resultado-interpretacion" id="psfs-interpretacion">Complete al menos una actividad para obtener un resultado</div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('psfs-content', 'PSFS')">
                      <i class="fas fa-file-pdf"></i> Guardar PSFS como PDF
                  </button>
              </div>

            </div> </div> ```
            <div class="cuestionario-item" id="item-groc"> <div class="cuestionario-header" onclick="toggleCuestionario('groc-content')">
              <h4><i class="fas fa-plus-circle"></i> GROC (Global Rating of Change)</h4>
              <div class="resultado-badge no-completado" id="groc-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="groc-content" style="display: none;">
              <p class="mb-3">Esta escala evalúa la percepción del paciente sobre el cambio en su condición desde que comenzó el tratamiento.</p>

              <div class="row mb-3"> <div class="col-md-12"> <div class="mb-3"> <label class="form-label">¿Cómo se siente ahora en comparación con cuando comenzó el tratamiento?</label>
                    <div class="groc-scale-container">
                      <div class="groc-scale">
                        <input type="radio" id="groc_-7" name="groc" value="-7" onchange="calcularGROC()">
                        <label for="groc_-7">-7<br>Extremadamente peor</label>

                        <input type="radio" id="groc_-6" name="groc" value="-6" onchange="calcularGROC()">
                        <label for="groc_-6">-6</label>

                        <input type="radio" id="groc_-5" name="groc" value="-5" onchange="calcularGROC()">
                        <label for="groc_-5">-5<br>Mucho peor</label>

                        <input type="radio" id="groc_-4" name="groc" value="-4" onchange="calcularGROC()">
                        <label for="groc_-4">-4</label>

                        <input type="radio" id="groc_-3" name="groc" value="-3" onchange="calcularGROC()">
                        <label for="groc_-3">-3<br>Moderadamente peor</label>

                        <input type="radio" id="groc_-2" name="groc" value="-2" onchange="calcularGROC()">
                        <label for="groc_-2">-2</label>

                        <input type="radio" id="groc_-1" name="groc" value="-1" onchange="calcularGROC()">
                        <label for="groc_-1">-1<br>Un poco peor</label>

                        <input type="radio" id="groc_0" name="groc" value="0" onchange="calcularGROC()">
                        <label for="groc_0">0<br>Sin cambios</label>

                        <input type="radio" id="groc_1" name="groc" value="1" onchange="calcularGROC()">
                        <label for="groc_1">+1<br>Un poco mejor</label>

                        <input type="radio" id="groc_2" name="groc" value="2" onchange="calcularGROC()">
                        <label for="groc_2">+2</label>

                        <input type="radio" id="groc_3" name="groc" value="3" onchange="calcularGROC()">
                        <label for="groc_3">+3<br>Moderadamente mejor</label>

                        <input type="radio" id="groc_4" name="groc" value="4" onchange="calcularGROC()">
                        <label for="groc_4">+4</label>

                        <input type="radio" id="groc_5" name="groc" value="5" onchange="calcularGROC()">
                        <label for="groc_5">+5<br>Mucho mejor</label>

                        <input type="radio" id="groc_6" name="groc" value="6" onchange="calcularGROC()">
                        <label for="groc_6">+6</label>

                        <input type="radio" id="groc_7" name="groc" value="7" onchange="calcularGROC()">
                        <label for="groc_7">+7<br>Completamente recuperado</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="groc-resultado">
                    <div class="resultado-label">Resultado GROC:</div>
                    <div class="resultado-valor" id="groc-valor">-</div>
                    <div class="resultado-interpretacion" id="groc-interpretacion">Seleccione una opción para obtener un resultado</div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('groc-content', 'GROC')">
                      <i class="fas fa-file-pdf"></i> Guardar GROC como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-sane"> <div class="cuestionario-header" onclick="toggleCuestionario('sane-content')">
              <h4><i class="fas fa-plus-circle"></i> SANE (Single Assessment Numeric Evaluation)</h4>
              <div class="resultado-badge no-completado" id="sane-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="sane-content" style="display: none;">
              <p class="mb-3">Una evaluación numérica única donde el paciente califica su función general en una escala de 0-100.</p>

              <div class="row mb-3"> <div class="col-md-12"> <div class="mb-3"> <label for="sane_puntuacion" class="form-label">En una escala de 0 a 100, ¿cómo calificaría su [área afectada] hoy?</label>
                    <p class="text-muted small mb-2">(0 = completamente incapacitado, 100 = normal)</p>
                    <input type="range" id="sane_puntuacion" name="sane_puntuacion" class="form-range w-100" min="0" max="100" step="1" value="50" oninput="calcularSANE()">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="sane_puntuacion_value">50</span>
                      <span>100</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="sane-resultado">
                    <div class="resultado-label">Puntuación SANE:</div>
                    <div class="resultado-valor" id="sane-valor">50%</div>
                    <div class="resultado-interpretacion" id="sane-interpretacion">Función moderada</div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('sane-content', 'SANE')">
                      <i class="fas fa-file-pdf"></i> Guardar SANE como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-bpi"> <div class="cuestionario-header" onclick="toggleCuestionario('bpi-content')">
              <h4><i class="fas fa-plus-circle"></i> Inventario Breve de Dolor (BPI)</h4>
              <div class="resultado-badge no-completado" id="bpi-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="bpi-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa la intensidad del dolor y su interferencia en las actividades diarias.</p>

              <h5>Parte 1: Intensidad del dolor</h5>
              <p class="text-muted small mb-2">Califique su dolor en una escala de 0 a 10 (0 = sin dolor, 10 = el peor dolor imaginable)</p>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_dolor_actual" class="form-label">Dolor ahora mismo</label>
                    <input type="range" id="bpi_dolor_actual" name="bpi_dolor_actual" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_actual_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_dolor_actual_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6"> <div class="mb-3"> <label for="bpi_dolor_promedio" class="form-label">Dolor promedio en las últimas 24 horas</label>
                    <input type="range" id="bpi_dolor_promedio" name="bpi_dolor_promedio" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_promedio_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_dolor_promedio_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_dolor_peor" class="form-label">Peor dolor en las últimas 24 horas</label>
                    <input type="range" id="bpi_dolor_peor" name="bpi_dolor_peor" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_peor_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_dolor_peor_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6"> <div class="mb-3"> <label for="bpi_dolor_menor" class="form-label">Menor dolor en las últimas 24 horas</label>
                    <input type="range" id="bpi_dolor_menor" name="bpi_dolor_menor" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_menor_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_dolor_menor_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
              </div>

              <h5 class="mt-4">Parte 2: Interferencia del dolor</h5>
              <p class="text-muted small mb-2">Califique cómo el dolor ha interferido en las siguientes actividades en una escala de 0 a 10 (0 = no interfiere, 10 = interfiere completamente)</p>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_actividad" class="form-label">Actividad general</label>
                    <input type="range" id="bpi_interferencia_actividad" name="bpi_interferencia_actividad" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_actividad_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_interferencia_actividad_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_animo" class="form-label">Estado de ánimo</label>
                    <input type="range" id="bpi_interferencia_animo" name="bpi_interferencia_animo" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_animo_value').textContent = this.value; calcularBPI();">
                    <div class="d-flex justify-content-between mt-1">
                      <span>0</span>
                      <span id="bpi_interferencia_animo_value">0</span>
                      <span>10</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_caminar" class="form-label">Capacidad para caminar</label>
                     <input type="range" id="bpi_interferencia_caminar" name="bpi_interferencia_caminar" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_caminar_value').textContent = this.value; calcularBPI();">
                     <div class="d-flex justify-content-between mt-1">
                       <span>0</span>
                       <span id="bpi_interferencia_caminar_value">0</span>
                       <span>10</span>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_trabajo" class="form-label">Trabajo habitual</label>
                     <input type="range" id="bpi_interferencia_trabajo" name="bpi_interferencia_trabajo" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_trabajo_value').textContent = this.value; calcularBPI();">
                     <div class="d-flex justify-content-between mt-1">
                       <span>0</span>
                       <span id="bpi_interferencia_trabajo_value">0</span>
                       <span>10</span>
                     </div>
                   </div>
                 </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_relaciones" class="form-label">Relaciones con otras personas</label>
                     <input type="range" id="bpi_interferencia_relaciones" name="bpi_interferencia_relaciones" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_relaciones_value').textContent = this.value; calcularBPI();">
                     <div class="d-flex justify-content-between mt-1">
                       <span>0</span>
                       <span id="bpi_interferencia_relaciones_value">0</span>
                       <span>10</span>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_sueno" class="form-label">Sueño</label>
                     <input type="range" id="bpi_interferencia_sueno" name="bpi_interferencia_sueno" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_sueno_value').textContent = this.value; calcularBPI();">
                     <div class="d-flex justify-content-between mt-1">
                       <span>0</span>
                       <span id="bpi_interferencia_sueno_value">0</span>
                       <span>10</span>
                     </div>
                   </div>
                 </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label for="bpi_interferencia_vida" class="form-label">Capacidad de disfrutar de la vida</label>
                     <input type="range" id="bpi_interferencia_vida" name="bpi_interferencia_vida" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_vida_value').textContent = this.value; calcularBPI();">
                     <div class="d-flex justify-content-between mt-1">
                       <span>0</span>
                       <span id="bpi_interferencia_vida_value">0</span>
                       <span>10</span>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"></div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="bpi-resultado">
                    <div class="resultado-label">Resultados BPI:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Intensidad del dolor:</div>
                        <div class="resultado-valor" id="bpi-intensidad-valor">0.0/10</div>
                        <div class="resultado-interpretacion" id="bpi-intensidad-interpretacion">Sin dolor</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Interferencia del dolor:</div>
                        <div class="resultado-valor" id="bpi-interferencia-valor">0.0/10</div>
                        <div class="resultado-interpretacion" id="bpi-interferencia-interpretacion">Sin interferencia</div>
                      </div>
                    </div>

                    <div class="interpretacion-clinica-container mt-3">
                      <h5>Interpretación Clínica:</h5>
                      <div class="interpretacion-clinica" id="bpi-interpretacion-clinica">
                        Complete el cuestionario para obtener la interpretación clínica.
                      </div>
                    </div>

                    <div class="recomendaciones-container mt-3">
                      <h5>Recomendaciones Terapéuticas:</h5>
                      <div class="recomendaciones" id="bpi-recomendaciones">
                        Complete el cuestionario para obtener recomendaciones terapéuticas.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('bpi-content', 'BPI')">
                      <i class="fas fa-file-pdf"></i> Guardar BPI como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-pcs"> <div class="cuestionario-header" onclick="toggleCuestionario('pcs-content')">
              <h4><i class="fas fa-plus-circle"></i> Escala de Catastrofización ante el Dolor (PCS)</h4>
              <div class="resultado-badge no-completado" id="pcs-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="pcs-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa los pensamientos y sentimientos catastróficos asociados con el dolor. Indique el grado en que experimenta cada uno de estos pensamientos o sentimientos cuando siente dolor.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Cuando siento dolor...</th>
                      <th>Nada</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Intenso</th>
                      <th>Todo el tiempo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Estoy preocupado todo el tiempo pensando en si el dolor desaparecerá</td>
                      <td class="text-center"><input type="radio" name="pcs_item1" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item1" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item1" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item1" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item1" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>2. Siento que no puedo continuar</td>
                      <td class="text-center"><input type="radio" name="pcs_item2" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item2" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item2" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item2" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item2" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>3. Es terrible y pienso que esto nunca va a mejorar</td>
                      <td class="text-center"><input type="radio" name="pcs_item3" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item3" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item3" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item3" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item3" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>4. Es horrible y siento que esto me supera</td>
                      <td class="text-center"><input type="radio" name="pcs_item4" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item4" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item4" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item4" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item4" value="4" onchange="calcularPCS()"></td>
                    </tr>

                    <tr>
                      <td>5. Siento que no puedo soportarlo más</td>
                      <td class="text-center"><input type="radio" name="pcs_item5" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item5" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item5" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item5" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item5" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>6. Temo que el dolor empeore</td>
                      <td class="text-center"><input type="radio" name="pcs_item6" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item6" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item6" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item6" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item6" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>7. Sigo pensando en otras situaciones dolorosas</td>
                      <td class="text-center"><input type="radio" name="pcs_item7" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item7" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item7" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item7" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item7" value="4" onchange="calcularPCS()"></td>
                    </tr>

                    <tr>
                      <td>8. Deseo desesperadamente que desaparezca el dolor</td>
                      <td class="text-center"><input type="radio" name="pcs_item8" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item8" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item8" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item8" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item8" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>9. No puedo apartar el dolor de mi mente</td>
                      <td class="text-center"><input type="radio" name="pcs_item9" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item9" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item9" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item9" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item9" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>10. Sigo pensando en lo mucho que me duele</td>
                      <td class="text-center"><input type="radio" name="pcs_item10" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item10" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item10" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item10" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item10" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>11. Sigo pensando en lo mucho que deseo que desaparezca el dolor</td>
                      <td class="text-center"><input type="radio" name="pcs_item11" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item11" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item11" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item11" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item11" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>12. No hay nada que pueda hacer para reducir la intensidad del dolor</td>
                      <td class="text-center"><input type="radio" name="pcs_item12" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item12" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item12" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item12" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item12" value="4" onchange="calcularPCS()"></td>
                    </tr>
                    <tr>
                      <td>13. Me pregunto si me puede pasar algo grave</td>
                      <td class="text-center"><input type="radio" name="pcs_item13" value="0" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item13" value="1" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item13" value="2" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item13" value="3" onchange="calcularPCS()"></td>
                      <td class="text-center"><input type="radio" name="pcs_item13" value="4" onchange="calcularPCS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="pcs-resultado">
                    <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                        <div class="resultado-valor" id="pcs-valor-total">-/52</div>
                        <div class="resultado-interpretacion" id="pcs-interpretacion-total">Complete el cuestionario</div>
                      </div>
                      <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas:</div>
                        <div class="row"> <div class="col-md-4"> <div class="resultado-sublabel">Rumiación:</div>
                            <div class="resultado-valor" id="pcs-valor-rumiacion">-/16</div>
                          </div>
                          <div class="col-md-4"> <div class="resultado-sublabel">Magnificación:</div>
                            <div class="resultado-valor" id="pcs-valor-magnificacion">-/12</div>
                          </div>
                          <div class="col-md-4"> <div class="resultado-sublabel">Desesperanza:</div>
                            <div class="resultado-valor" id="pcs-valor-desesperanza">-/24</div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="interpretacion-clinica-container mt-3">
                      <h5>Interpretación Clínica:</h5>
                      <div class="interpretacion-clinica" id="pcs-interpretacion-clinica">
                        Complete el cuestionario para obtener la interpretación clínica.
                      </div>
                    </div>

                    <div class="recomendaciones-container mt-3">
                      <h5>Recomendaciones Terapéuticas:</h5>
                      <div class="recomendaciones" id="pcs-recomendaciones">
                        Complete el cuestionario para obtener recomendaciones terapéuticas.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('pcs-content', 'PCS')">
                      <i class="fas fa-file-pdf"></i> Guardar PCS como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-csi"> <div class="cuestionario-header" onclick="toggleCuestionario('csi-content')">
              <h4><i class="fas fa-plus-circle"></i> Inventario de Sensibilización Central (CSI)</h4>
              <div class="resultado-badge no-completado" id="csi-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="csi-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa la presencia de síntomas relacionados con la sensibilización central. Por favor, indique con qué frecuencia ha experimentado cada uno de los siguientes síntomas en los últimos 3 meses.</p>

              <h5>Parte A: Síntomas</h5>
               <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Síntoma</th>
                      <th>Nunca</th>
                      <th>Raramente</th>
                      <th>A veces</th>
                      <th>A menudo</th>
                      <th>Siempre</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Siento dolor en todo mi cuerpo</td>
                      <td class="text-center"><input type="radio" name="csi_item1" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item1" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item1" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item1" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item1" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>2. Tengo ataques de dolor súbito o como si fueran calambres</td>
                      <td class="text-center"><input type="radio" name="csi_item2" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item2" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item2" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item2" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item2" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>3. Tengo dolor en las articulaciones</td>
                      <td class="text-center"><input type="radio" name="csi_item3" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item3" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item3" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item3" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item3" value="4" onchange="calcularCSI()"></td>
                    </tr>
                     <tr>
                      <td>4. Siento las piernas débiles</td>
                      <td class="text-center"><input type="radio" name="csi_item4" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item4" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item4" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item4" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item4" value="4" onchange="calcularCSI()"></td>
                    </tr>
                     <tr>
                      <td>5. Tengo poca energía o me siento fatigado/a</td>
                      <td class="text-center"><input type="radio" name="csi_item5" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item5" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item5" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item5" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item5" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>6. Tengo dolores musculares</td>
                      <td class="text-center"><input type="radio" name="csi_item6" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item6" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item6" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item6" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item6" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>7. Tengo dolores de cabeza o migrañas</td>
                      <td class="text-center"><input type="radio" name="csi_item7" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item7" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item7" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item7" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item7" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>8. Tengo dolor o molestias en el cuello</td>
                      <td class="text-center"><input type="radio" name="csi_item8" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item8" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item8" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item8" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item8" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>9. Tengo dolor o molestias en la mandíbula</td>
                      <td class="text-center"><input type="radio" name="csi_item9" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item9" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item9" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item9" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item9" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>10. Tengo sensibilidad en la vejiga o ardor al orinar</td>
                      <td class="text-center"><input type="radio" name="csi_item10" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item10" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item10" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item10" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item10" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>11. Necesito orinar frecuentemente</td>
                      <td class="text-center"><input type="radio" name="csi_item11" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item11" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item11" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item11" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item11" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>12. Tengo dolor entre las piernas (vagina/pelvis/recto)</td>
                      <td class="text-center"><input type="radio" name="csi_item12" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item12" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item12" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item12" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item12" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>13. Tengo molestias cuando voy al baño</td>
                      <td class="text-center"><input type="radio" name="csi_item13" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item13" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item13" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item13" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item13" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>14. Tengo malestar abdominal y problemas digestivos</td>
                      <td class="text-center"><input type="radio" name="csi_item14" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item14" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item14" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item14" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item14" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>15. Tengo síndrome de colon irritable</td>
                      <td class="text-center"><input type="radio" name="csi_item15" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item15" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item15" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item15" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item15" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>16. Siento entumecimiento u hormigueo en partes de mi cuerpo</td>
                      <td class="text-center"><input type="radio" name="csi_item16" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item16" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item16" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item16" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item16" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>17. Tengo dolor en la región del pecho</td>
                      <td class="text-center"><input type="radio" name="csi_item17" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item17" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item17" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item17" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item17" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>18. Soy sensible a las luces brillantes</td>
                      <td class="text-center"><input type="radio" name="csi_item18" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item18" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item18" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item18" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item18" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>19. Soy sensible a los ruidos</td>
                      <td class="text-center"><input type="radio" name="csi_item19" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item19" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item19" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item19" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item19" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>20. Siento algunas cosas (como ciertos olores, químicos, medicamentos) que empeoran mi dolor</td>
                      <td class="text-center"><input type="radio" name="csi_item20" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item20" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item20" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item20" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item20" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>21. Me siento estresado/a cuando tengo que hacer muchas cosas en poco tiempo</td>
                      <td class="text-center"><input type="radio" name="csi_item21" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item21" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item21" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item21" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item21" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>22. Tengo problemas para concentrarme</td>
                      <td class="text-center"><input type="radio" name="csi_item22" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item22" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item22" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item22" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item22" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>23. Duermo mal</td>
                      <td class="text-center"><input type="radio" name="csi_item23" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item23" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item23" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item23" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item23" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>24. Me siento cansado/a cuando me despierto</td>
                      <td class="text-center"><input type="radio" name="csi_item24" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item24" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item24" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item24" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item24" value="4" onchange="calcularCSI()"></td>
                    </tr>
                    <tr>
                      <td>25. Tengo ansiedad</td>
                      <td class="text-center"><input type="radio" name="csi_item25" value="0" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item25" value="1" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item25" value="2" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item25" value="3" onchange="calcularCSI()"></td>
                      <td class="text-center"><input type="radio" name="csi_item25" value="4" onchange="calcularCSI()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <div class="row"> <div class="col-md-12"> <h5 class="mb-3">Parte B: Diagnósticos relacionados con Sensibilización Central</h5>
                  <p>Marque las condiciones que le han sido diagnosticadas por un médico:</p>

                  <div class="row mb-3"> <div class="col-md-6"> <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_fibromialgia" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_fibromialgia">Fibromialgia</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_sindrome_fatiga" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_sindrome_fatiga">Síndrome de fatiga crónica</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_tmd" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_tmd">Trastorno temporomandibular (TMD)</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_migranas" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_migranas">Migrañas o cefaleas tensionales</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_sii" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_sii">Síndrome de intestino irritable (SII)</label>
                      </div>
                    </div>
                    <div class="col-md-6"> <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_reflujo" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_reflujo">Reflujo o dolor torácico no cardíaco</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_vejiga" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_vejiga">Vejiga irritable o cistitis intersticial</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_quimico" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_quimico">Sensibilidad a químicos/medicamentos</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_lesion_cuello" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_lesion_cuello">Lesión de cuello (incluyendo latigazo)</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="csi_ansiedad" onchange="calcularCSI()">
                        <label class="form-check-label" for="csi_ansiedad">Ansiedad o ataques de pánico</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="csi-resultado">
                    <div class="row"> <div class="col-md-6"> <div class="resultado-label">Puntuación Parte A:</div>
                        <div class="resultado-valor" id="csi-valor-a">-/100</div>
                        <div class="resultado-interpretacion" id="csi-interpretacion-a">Complete el cuestionario</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-label">Diagnósticos Parte B:</div>
                        <div class="resultado-valor" id="csi-valor-b">-/10</div>
                        <div class="resultado-interpretacion" id="csi-interpretacion-b">Condiciones relacionadas con SC</div>
                      </div>
                    </div>

                    <div class="interpretacion-clinica-container mt-3">
                      <h5>Interpretación Clínica:</h5>
                      <div class="interpretacion-clinica" id="csi-interpretacion-clinica">
                        Complete el cuestionario para obtener la interpretación clínica.
                      </div>
                    </div>

                    <div class="recomendaciones-container mt-3">
                      <h5>Recomendaciones Terapéuticas:</h5>
                      <div class="recomendaciones" id="csi-recomendaciones">
                        Complete el cuestionario para obtener recomendaciones terapéuticas.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('csi-content', 'CSI')">
                      <i class="fas fa-file-pdf"></i> Guardar CSI como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-tsk"> <div class="cuestionario-header" onclick="toggleCuestionario('tsk-content')">
              <h4><i class="fas fa-plus-circle"></i> Escala de Tampa de Kinesiofobia (TSK-11)</h4>
              <div class="resultado-badge no-completado" id="tsk-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="tsk-content" style="display: none;">
              <p class="mb-3">Esta escala evalúa el miedo al movimiento y a la reinjuria. Indique su grado de acuerdo con cada afirmación.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Afirmación</th>
                      <th>Totalmente en desacuerdo</th>
                      <th>En desacuerdo</th>
                      <th>De acuerdo</th>
                      <th>Totalmente de acuerdo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Tengo miedo de lesionarme si hago ejercicio</td>
                      <td class="text-center"><input type="radio" name="tsk_item1" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item1" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item1" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item1" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>2. Si dejara que mi dolor aumentara, después no disminuiría</td>
                      <td class="text-center"><input type="radio" name="tsk_item2" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item2" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item2" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item2" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>3. Mi cuerpo me dice que tengo algo peligroso</td>
                      <td class="text-center"><input type="radio" name="tsk_item3" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item3" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item3" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item3" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>4. Mi dolor probablemente se aliviaría si hiciera ejercicio</td>
                      <td class="text-center"><input type="radio" name="tsk_item4" value="4" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item4" value="3" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item4" value="2" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item4" value="1" onchange="calcularTSK()"></td> </tr>
                    <tr>
                      <td>5. Las personas no se toman mi condición médica con suficiente seriedad</td>
                      <td class="text-center"><input type="radio" name="tsk_item5" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item5" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item5" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item5" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>6. Mi lesión ha puesto en riesgo mi cuerpo para siempre</td>
                      <td class="text-center"><input type="radio" name="tsk_item6" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item6" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item6" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item6" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>7. El dolor siempre significa que me he lesionado</td>
                      <td class="text-center"><input type="radio" name="tsk_item7" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item7" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item7" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item7" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>8. Aunque algo me provoque mucho dolor, no es realmente peligroso</td>
                       <td class="text-center"><input type="radio" name="tsk_item8" value="4" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item8" value="3" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item8" value="2" onchange="calcularTSK()"></td> <td class="text-center"><input type="radio" name="tsk_item8" value="1" onchange="calcularTSK()"></td> </tr>
                    <tr>
                      <td>9. Tengo miedo de lesionarme accidentalmente</td>
                      <td class="text-center"><input type="radio" name="tsk_item9" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item9" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item9" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item9" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>10. La manera más segura de evitar que mi dolor empeore es simplemente ser cuidadoso y no hacer movimientos innecesarios</td>
                      <td class="text-center"><input type="radio" name="tsk_item10" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item10" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item10" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item10" value="4" onchange="calcularTSK()"></td>
                    </tr>
                    <tr>
                      <td>11. No tendría tanto dolor si no estuviera ocurriendo algo potencialmente peligroso en mi cuerpo</td>
                      <td class="text-center"><input type="radio" name="tsk_item11" value="1" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item11" value="2" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item11" value="3" onchange="calcularTSK()"></td>
                      <td class="text-center"><input type="radio" name="tsk_item11" value="4" onchange="calcularTSK()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="tsk-resultado">
                    <div class="resultado-label">Puntuación TSK-11:</div>
                    <div class="resultado-valor" id="tsk-valor">-/44</div>
                    <div class="resultado-interpretacion" id="tsk-interpretacion">Complete el cuestionario para obtener un resultado</div>

                    <div class="interpretacion-clinica-container mt-3">
                      <h5>Interpretación Clínica:</h5>
                      <div class="interpretacion-clinica" id="tsk-interpretacion-clinica">
                        Complete el cuestionario para obtener la interpretación clínica.
                      </div>
                    </div>

                    <div class="recomendaciones-container mt-3">
                      <h5>Recomendaciones Terapéuticas:</h5>
                      <div class="recomendaciones" id="tsk-recomendaciones">
                        Complete el cuestionario para obtener recomendaciones terapéuticas.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('tsk-content', 'TSK-11')">
                      <i class="fas fa-file-pdf"></i> Guardar TSK-11 como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-dn4"> <div class="cuestionario-header" onclick="toggleCuestionario('dn4-content')">
              <h4><i class="fas fa-plus-circle"></i> Cuestionario de Dolor Neuropático (DN4)</h4>
              <div class="resultado-badge no-completado" id="dn4-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="dn4-content" style="display: none;">
              <p class="mb-3">Este cuestionario ayuda a identificar el dolor neuropático. Responda Sí o No a las siguientes preguntas basadas en las características del dolor del paciente.</p>

              <h5>Parte 1: Entrevista al paciente</h5>
              <p class="text-muted small mb-2">¿El dolor tiene una o más de las siguientes características?</p>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">1. ¿Quemazón?</label> <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="dn4_quemazon" id="dn4_quemazon_si" value="1" onchange="calcularDN4()">
                      <label class="form-check-label" for="dn4_quemazon_si">Sí</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="dn4_quemazon" id="dn4_quemazon_no" value="0" onchange="calcularDN4()">
                      <label class="form-check-label" for="dn4_quemazon_no">No</label>
                    </div>
                  </div>
                </div>
                <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">2. ¿Sensación de frío doloroso?</label> <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="dn4_frio" id="dn4_frio_si" value="1" onchange="calcularDN4()">
                      <label class="form-check-label" for="dn4_frio_si">Sí</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="dn4_frio" id="dn4_frio_no" value="0" onchange="calcularDN4()">
                      <label class="form-check-label" for="dn4_frio_no">No</label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">3. ¿Descargas eléctricas?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_descargas" id="dn4_descargas_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_descargas_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_descargas" id="dn4_descargas_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_descargas_no">No</label>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"></div>
              </div>

              <h5 class="mt-4">¿Se asocia el dolor con uno o más de los siguientes síntomas en la misma zona?</h5>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">4. ¿Hormigueo?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hormigueo" id="dn4_hormigueo_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hormigueo_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hormigueo" id="dn4_hormigueo_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hormigueo_no">No</label>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">5. ¿Alfileres y agujas?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_alfileres" id="dn4_alfileres_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_alfileres_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_alfileres" id="dn4_alfileres_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_alfileres_no">No</label>
                     </div>
                   </div>
                 </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">6. ¿Entumecimiento?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_entumecimiento" id="dn4_entumecimiento_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_entumecimiento_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_entumecimiento" id="dn4_entumecimiento_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_entumecimiento_no">No</label>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">7. ¿Picazón?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_picazon" id="dn4_picazon_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_picazon_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_picazon" id="dn4_picazon_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_picazon_no">No</label>
                     </div>
                   </div>
                 </div>
              </div>

              <h5 class="mt-4">Parte 2: Examen del paciente</h5>
              <p class="text-muted small mb-2">¿El dolor está localizado en una zona donde el examen físico puede mostrar una o más de las siguientes características?</p>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">8. ¿Hipoestesia al tacto?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hipoestesia" id="dn4_hipoestesia_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hipoestesia_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hipoestesia" id="dn4_hipoestesia_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hipoestesia_no">No</label>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">9. ¿Hipoestesia al pinchazo?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hipoestesia_pinchazo" id="dn4_hipoestesia_pinchazo_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hipoestesia_pinchazo_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_hipoestesia_pinchazo" id="dn4_hipoestesia_pinchazo_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_hipoestesia_pinchazo_no">No</label>
                     </div>
                   </div>
                 </div>
              </div>

              <div class="row mb-3"> <div class="col-md-6"> <div class="mb-3"> <label class="form-label d-block">10. ¿Se provoca o incrementa el dolor por cepillado?</label> <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_cepillado" id="dn4_cepillado_si" value="1" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_cepillado_si">Sí</label>
                     </div>
                     <div class="form-check form-check-inline">
                       <input class="form-check-input" type="radio" name="dn4_cepillado" id="dn4_cepillado_no" value="0" onchange="calcularDN4()">
                       <label class="form-check-label" for="dn4_cepillado_no">No</label>
                     </div>
                   </div>
                 </div>
                 <div class="col-md-6"></div>
              </div>

              <div class="row"> <div class="col-md-12"> <div class="resultado-container" id="dn4-resultado">
                    <div class="resultado-label">Puntuación DN4:</div>
                    <div class="resultado-valor" id="dn4-valor">0/10</div>
                    <div class="resultado-interpretacion" id="dn4-interpretacion">Complete el cuestionario para obtener un resultado</div>

                    <div class="interpretacion-clinica-container mt-3">
                      <h5>Interpretación Clínica:</h5>
                      <div class="interpretacion-clinica" id="dn4-interpretacion-clinica">
                        Complete el cuestionario para obtener la interpretación clínica.
                      </div>
                    </div>

                    <div class="recomendaciones-container mt-3">
                      <h5>Recomendaciones Terapéuticas:</h5>
                      <div class="recomendaciones" id="dn4-recomendaciones">
                        Complete el cuestionario para obtener recomendaciones terapéuticas.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('dn4-content', 'DN4')">
                      <i class="fas fa-file-pdf"></i> Guardar DN4 como PDF
                  </button>
              </div>

            </div> </div> 
            <div class="cuestionario-item" id="item-ndi"> <div class="cuestionario-header" onclick="toggleCuestionario('ndi-content')">
              <h4><i class="fas fa-plus-circle"></i> Índice de Discapacidad Cervical (NDI)</h4>
              <div class="resultado-badge no-completado" id="ndi-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="ndi-content" style="display: none;">
              <p class="mb-3">Este cuestionario ha sido diseñado para dar información sobre cómo su dolor de cuello afecta su capacidad para realizar actividades de la vida diaria. Por favor, responda cada sección marcando SOLO UNA opción que mejor se aplique a usted.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Sección</th>
                      <th>Opción 0</th>
                      <th>Opción 1</th>
                      <th>Opción 2</th>
                      <th>Opción 3</th>
                      <th>Opción 4</th>
                      <th>Opción 5</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Intensidad del dolor</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="0" onchange="calcularNDI()"><br>No tengo dolor en este momento</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="1" onchange="calcularNDI()"><br>El dolor es muy leve en este momento</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="2" onchange="calcularNDI()"><br>El dolor es moderado en este momento</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="3" onchange="calcularNDI()"><br>El dolor es bastante fuerte en este momento</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="4" onchange="calcularNDI()"><br>El dolor es muy fuerte en este momento</td>
                      <td class="text-center"><input type="radio" name="ndi_item1" value="5" onchange="calcularNDI()"><br>El dolor es el peor imaginable en este momento</td>
                    </tr>

                    <tr>
                      <td>2. Cuidado personal (lavarse, vestirse, etc.)</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="0" onchange="calcularNDI()"><br>Puedo cuidarme normalmente sin que me aumente el dolor</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="1" onchange="calcularNDI()"><br>Puedo cuidarme normalmente, pero esto me aumenta el dolor</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="2" onchange="calcularNDI()"><br>Cuidarme me duele, y lo hago lenta y cuidadosamente</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="3" onchange="calcularNDI()"><br>Necesito alguna ayuda, pero puedo hacer la mayor parte de mi cuidado personal</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="4" onchange="calcularNDI()"><br>Necesito ayuda todos los días en la mayor parte de mi cuidado personal</td>
                      <td class="text-center"><input type="radio" name="ndi_item2" value="5" onchange="calcularNDI()"><br>No puedo vestirme, me lavo con dificultad y me quedo en la cama</td>
                    </tr>

                    <tr>
                      <td>3. Levantar peso</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="0" onchange="calcularNDI()"><br>Puedo levantar objetos pesados sin aumento del dolor</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="1" onchange="calcularNDI()"><br>Puedo levantar objetos pesados pero me aumenta el dolor</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="2" onchange="calcularNDI()"><br>El dolor me impide levantar objetos pesados del suelo, pero puedo hacerlo si están convenientemente colocados (ej. en una mesa)</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="3" onchange="calcularNDI()"><br>El dolor me impide levantar objetos pesados, pero puedo levantar objetos medianos o ligeros si están convenientemente colocados</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="4" onchange="calcularNDI()"><br>Solo puedo levantar objetos muy ligeros</td>
                      <td class="text-center"><input type="radio" name="ndi_item3" value="5" onchange="calcularNDI()"><br>No puedo levantar ni cargar nada</td>
                    </tr>

                    <tr>
                      <td>4. Lectura</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="0" onchange="calcularNDI()"><br>Puedo leer tanto como quiera sin dolor en el cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="1" onchange="calcularNDI()"><br>Puedo leer tanto como quiera con un ligero dolor en el cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="2" onchange="calcularNDI()"><br>Puedo leer tanto como quiera con dolor moderado en el cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="3" onchange="calcularNDI()"><br>No puedo leer tanto como quisiera debido a un dolor moderado en el cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="4" onchange="calcularNDI()"><br>Apenas puedo leer debido a un gran dolor en el cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item4" value="5" onchange="calcularNDI()"><br>No puedo leer nada en absoluto</td>
                    </tr>

                    <tr>
                      <td>5. Dolor de cabeza</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="0" onchange="calcularNDI()"><br>No tengo ningún dolor de cabeza</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="1" onchange="calcularNDI()"><br>Tengo dolores de cabeza leves que ocurren con poca frecuencia</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="2" onchange="calcularNDI()"><br>Tengo dolores de cabeza moderados que ocurren con poca frecuencia</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="3" onchange="calcularNDI()"><br>Tengo dolores de cabeza moderados que ocurren con frecuencia</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="4" onchange="calcularNDI()"><br>Tengo dolores de cabeza intensos que ocurren con frecuencia</td>
                      <td class="text-center"><input type="radio" name="ndi_item5" value="5" onchange="calcularNDI()"><br>Tengo dolores de cabeza casi constantemente</td>
                    </tr>

                    <tr>
                      <td>6. Concentración</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="0" onchange="calcularNDI()"><br>Puedo concentrarme completamente cuando quiero sin dificultad</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="1" onchange="calcularNDI()"><br>Puedo concentrarme completamente cuando quiero con ligera dificultad</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="2" onchange="calcularNDI()"><br>Tengo un poco de dificultad para concentrarme cuando quiero</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="3" onchange="calcularNDI()"><br>Tengo bastante dificultad para concentrarme cuando quiero</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="4" onchange="calcularNDI()"><br>Tengo mucha dificultad para concentrarme cuando quiero</td>
                      <td class="text-center"><input type="radio" name="ndi_item6" value="5" onchange="calcularNDI()"><br>No puedo concentrarme en absoluto</td>
                    </tr>

                    <tr>
                      <td>7. Trabajo</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="0" onchange="calcularNDI()"><br>Puedo trabajar tanto como quiera</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="1" onchange="calcularNDI()"><br>Puedo hacer mi trabajo habitual, pero no más</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="2" onchange="calcularNDI()"><br>Puedo hacer la mayor parte de mi trabajo habitual, pero no más</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="3" onchange="calcularNDI()"><br>No puedo hacer mi trabajo habitual</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="4" onchange="calcularNDI()"><br>Apenas puedo hacer algún trabajo</td>
                      <td class="text-center"><input type="radio" name="ndi_item7" value="5" onchange="calcularNDI()"><br>No puedo hacer ningún trabajo</td>
                    </tr>

                    <tr>
                      <td>8. Conducir</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="0" onchange="calcularNDI()"><br>Puedo conducir sin dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="1" onchange="calcularNDI()"><br>Puedo conducir tanto como quiera, pero con un ligero dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="2" onchange="calcularNDI()"><br>Puedo conducir tanto como quiera, pero con un dolor moderado de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="3" onchange="calcularNDI()"><br>No puedo conducir tanto como quisiera debido al dolor moderado de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="4" onchange="calcularNDI()"><br>Apenas puedo conducir debido al intenso dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item8" value="5" onchange="calcularNDI()"><br>No puedo conducir por el dolor de cuello</td>
                    </tr>

                    <tr>
                      <td>9. Dormir</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="0" onchange="calcularNDI()"><br>No tengo ningún problema para dormir</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="1" onchange="calcularNDI()"><br>Mi sueño está ligeramente perturbado (menos de 1 hora de insomnio)</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="2" onchange="calcularNDI()"><br>Mi sueño está moderadamente perturbado (1-2 horas de insomnio)</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="3" onchange="calcularNDI()"><br>Mi sueño está bastante perturbado (2-3 horas de insomnio)</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="4" onchange="calcularNDI()"><br>Mi sueño está muy perturbado (3-5 horas de insomnio)</td>
                      <td class="text-center"><input type="radio" name="ndi_item9" value="5" onchange="calcularNDI()"><br>Mi sueño está completamente perturbado (5-7 horas de insomnio)</td>
                    </tr>

                    <tr>
                      <td>10. Actividades recreativas</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="0" onchange="calcularNDI()"><br>Puedo participar en todas mis actividades recreativas sin dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="1" onchange="calcularNDI()"><br>Puedo participar en todas mis actividades recreativas con algo de dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="2" onchange="calcularNDI()"><br>Puedo participar en la mayoría de mis actividades recreativas habituales, pero no en todas, debido al dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="3" onchange="calcularNDI()"><br>Puedo participar en pocas de mis actividades recreativas habituales debido al dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="4" onchange="calcularNDI()"><br>Apenas puedo hacer actividades recreativas debido al dolor de cuello</td>
                      <td class="text-center"><input type="radio" name="ndi_item10" value="5" onchange="calcularNDI()"><br>No puedo realizar ninguna actividad recreativa</td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="resultado-container" id="ndi-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="ndi-valor-total">-/50</div>
                    <div class="resultado-interpretacion" id="ndi-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Interpretación:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Porcentaje:</div>
                        <div class="resultado-valor" id="ndi-valor-porcentaje">-%</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Nivel de discapacidad:</div>
                        <div class="resultado-valor" id="ndi-nivel-discapacidad">-</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="ndi-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="ndi-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('ndi-content', 'NDI')">
                      <i class="fas fa-file-pdf"></i> Guardar NDI como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-quickdash"> <div class="cuestionario-header" onclick="toggleCuestionario('quickdash-content')">
              <h4><i class="fas fa-plus-circle"></i> Cuestionario QuickDASH (Discapacidad del Brazo, Hombro y Mano)</h4>
              <div class="resultado-badge no-completado" id="quickdash-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="quickdash-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa su capacidad para realizar actividades con sus brazos, hombros o manos, así como los síntomas asociados. Por favor, responda cada pregunta basándose en su condición durante la última semana.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Actividad</th>
                      <th>Sin dificultad</th>
                      <th>Dificultad leve</th>
                      <th>Dificultad moderada</th>
                      <th>Dificultad severa</th>
                      <th>Imposible de realizar</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Abrir un frasco nuevo o apretado</td>
                      <td class="text-center"><input type="radio" name="quickdash_item1" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item1" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item1" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item1" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item1" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                    <tr>
                      <td>2. Realizar tareas domésticas pesadas (p. ej. lavar paredes, fregar el suelo)</td>
                      <td class="text-center"><input type="radio" name="quickdash_item2" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item2" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item2" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item2" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item2" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                    <tr>
                      <td>3. Cargar una bolsa de compras o un maletín</td>
                      <td class="text-center"><input type="radio" name="quickdash_item3" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item3" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item3" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item3" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item3" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                    <tr>
                      <td>4. Lavarse la espalda</td>
                      <td class="text-center"><input type="radio" name="quickdash_item4" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item4" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item4" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item4" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item4" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                    <tr>
                      <td>5. Usar un cuchillo para cortar alimentos</td>
                      <td class="text-center"><input type="radio" name="quickdash_item5" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item5" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item5" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item5" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item5" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                     <tr>
                       <td>6. Actividades recreativas que requieren poco esfuerzo (jugar a las cartas, tejer, etc.)</td>
                       <td class="text-center"><input type="radio" name="quickdash_item6" value="1" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item6" value="2" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item6" value="3" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item6" value="4" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item6" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                     <tr>
                       <td>7. Actividades recreativas en las que se mueve el brazo libremente (ping pong, bádminton, natación, etc.)</td>
                       <td class="text-center"><input type="radio" name="quickdash_item7" value="1" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item7" value="2" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item7" value="3" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item7" value="4" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item7" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                     <tr>
                       <td>8. Actividades que requieren transportar objetos (p. ej. usar herramientas, conducir, etc.)</td>
                       <td class="text-center"><input type="radio" name="quickdash_item8" value="1" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item8" value="2" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item8" value="3" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item8" value="4" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item8" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Durante la última semana...</th>
                      <th>Nada</th>
                      <th>Un poco</th>
                      <th>Regular</th>
                      <th>Bastante</th>
                      <th>Mucho</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>9. ¿Cuánta dificultad ha tenido para dormir debido a dolor en brazo, hombro o mano?</td>
                      <td class="text-center"><input type="radio" name="quickdash_item9" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item9" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item9" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item9" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item9" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                    <tr>
                      <td>10. ¿Se siente menos capaz, confiado o útil debido a su problema en brazo, hombro o mano?</td>
                      <td class="text-center"><input type="radio" name="quickdash_item10" value="1" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item10" value="2" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item10" value="3" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item10" value="4" onchange="calcularQuickDASH()"></td>
                      <td class="text-center"><input type="radio" name="quickdash_item10" value="5" onchange="calcularQuickDASH()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <div class="table-responsive"> <table class="table table-bordered mb-4">
                   <thead>
                     <tr>
                       <th>Califique la gravedad de los siguientes síntomas en la última semana</th>
                       <th>Ninguno</th>
                       <th>Leve</th>
                       <th>Moderado</th>
                       <th>Severo</th>
                       <th>Extremo</th>
                     </tr>
                   </thead>
                   <tbody>
                     <tr>
                       <td>11. Dolor en brazo, hombro o mano</td>
                       <td class="text-center"><input type="radio" name="quickdash_item11" value="1" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item11" value="2" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item11" value="3" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item11" value="4" onchange="calcularQuickDASH()"></td>
                       <td class="text-center"><input type="radio" name="quickdash_item11" value="5" onchange="calcularQuickDASH()"></td>
                     </tr>
                   </tbody>
                 </table>
                </div> <div class="resultado-container" id="quickdash-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="quickdash-valor-total">-/100</div>
                    <div class="resultado-interpretacion" id="quickdash-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Interpretación:</div>
                    <div class="row"> <div class="col-md-12"> <div class="resultado-sublabel">Nivel de discapacidad:</div>
                        <div class="resultado-valor" id="quickdash-nivel-discapacidad">-</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="quickdash-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="quickdash-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('quickdash-content', 'QuickDASH')">
                      <i class="fas fa-file-pdf"></i> Guardar QuickDASH como PDF
                  </button>
              </div>

            </div> </div> 
            <div class="cuestionario-item" id="item-spadi"> <div class="cuestionario-header" onclick="toggleCuestionario('spadi-content')">
              <h4><i class="fas fa-plus-circle"></i> Índice de Dolor y Discapacidad de Hombro (SPADI)</h4>
              <div class="resultado-badge no-completado" id="spadi-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="spadi-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa su dolor y discapacidad en el hombro. Por favor, marque en cada pregunta el número que mejor represente su experiencia durante la última semana.</p>

              <h5 class="mt-4 mb-3">Escala de Dolor</h5>
              <p>¿Qué tan intenso es su dolor? (0 = sin dolor, 10 = el peor dolor imaginable)</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Situación</th>
                      <th colspan="11">Intensidad del dolor (0-10)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. En su peor momento</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor1" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>2. Al acostarse sobre el lado afectado</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_dolor2" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                     <tr>
                       <td>3. Al alcanzar algo en un estante alto</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="0" onchange="calcularSPADI()"><br>0</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="1" onchange="calcularSPADI()"><br>1</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="2" onchange="calcularSPADI()"><br>2</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="3" onchange="calcularSPADI()"><br>3</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="4" onchange="calcularSPADI()"><br>4</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="5" onchange="calcularSPADI()"><br>5</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="6" onchange="calcularSPADI()"><br>6</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="7" onchange="calcularSPADI()"><br>7</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="8" onchange="calcularSPADI()"><br>8</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="9" onchange="calcularSPADI()"><br>9</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor3" value="10" onchange="calcularSPADI()"><br>10</td>
                     </tr>
                     <tr>
                       <td>4. Al tocarse la nuca</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="0" onchange="calcularSPADI()"><br>0</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="1" onchange="calcularSPADI()"><br>1</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="2" onchange="calcularSPADI()"><br>2</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="3" onchange="calcularSPADI()"><br>3</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="4" onchange="calcularSPADI()"><br>4</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="5" onchange="calcularSPADI()"><br>5</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="6" onchange="calcularSPADI()"><br>6</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="7" onchange="calcularSPADI()"><br>7</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="8" onchange="calcularSPADI()"><br>8</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="9" onchange="calcularSPADI()"><br>9</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor4" value="10" onchange="calcularSPADI()"><br>10</td>
                     </tr>
                     <tr>
                       <td>5. Al empujar con el brazo afectado</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="0" onchange="calcularSPADI()"><br>0</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="1" onchange="calcularSPADI()"><br>1</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="2" onchange="calcularSPADI()"><br>2</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="3" onchange="calcularSPADI()"><br>3</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="4" onchange="calcularSPADI()"><br>4</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="5" onchange="calcularSPADI()"><br>5</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="6" onchange="calcularSPADI()"><br>6</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="7" onchange="calcularSPADI()"><br>7</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="8" onchange="calcularSPADI()"><br>8</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="9" onchange="calcularSPADI()"><br>9</td>
                       <td class="text-center"><input type="radio" name="spadi_dolor5" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">Escala de Discapacidad</h5>
              <p>¿Qué tanta dificultad tiene al realizar las siguientes actividades? (0 = sin dificultad, 10 = tan difícil que requiere ayuda)</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Actividad</th>
                      <th colspan="11">Grado de dificultad (0-10)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Lavarse el cabello</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap1" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>2. Lavarse la espalda</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap2" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>3. Ponerse o quitarse una camiseta o jersey</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap3" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>4. Ponerse una camisa que se abotona por delante</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap4" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>5. Ponerse los pantalones</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap5" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>6. Colocar un objeto en un estante alto</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap6" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>7. Cargar un objeto pesado de 5 kg</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap7" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                    <tr>
                      <td>8. Sacar algo del bolsillo trasero</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="0" onchange="calcularSPADI()"><br>0</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="1" onchange="calcularSPADI()"><br>1</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="2" onchange="calcularSPADI()"><br>2</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="3" onchange="calcularSPADI()"><br>3</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="4" onchange="calcularSPADI()"><br>4</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="5" onchange="calcularSPADI()"><br>5</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="6" onchange="calcularSPADI()"><br>6</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="7" onchange="calcularSPADI()"><br>7</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="8" onchange="calcularSPADI()"><br>8</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="9" onchange="calcularSPADI()"><br>9</td>
                      <td class="text-center"><input type="radio" name="spadi_discap8" value="10" onchange="calcularSPADI()"><br>10</td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="resultado-container" id="spadi-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="spadi-valor-total">-/100</div>
                    <div class="resultado-interpretacion" id="spadi-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Dolor:</div>
                        <div class="resultado-valor" id="spadi-valor-dolor">-%</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Discapacidad:</div>
                        <div class="resultado-valor" id="spadi-valor-discapacidad">-%</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="spadi-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="spadi-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('spadi-content', 'SPADI')">
                      <i class="fas fa-file-pdf"></i> Guardar SPADI como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-oswestry"> <div class="cuestionario-header" onclick="toggleCuestionario('oswestry-content')">
              <h4><i class="fas fa-plus-circle"></i> Índice de Discapacidad de Oswestry (ODI)</h4>
              <div class="resultado-badge no-completado" id="oswestry-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="oswestry-content" style="display: none;">
              <p class="mb-3">Este cuestionario ha sido diseñado para conocer cómo su dolor de espalda está afectando su capacidad para realizar actividades de la vida diaria. Por favor, conteste cada sección marcando SOLO UNA opción, aquella que mejor describa su situación actual.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th colspan="6" class="bg-light text-start"><strong>1. Intensidad del dolor</strong></th> </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="0" onchange="calcularOswestry()"><br>Puedo soportar el dolor sin necesidad de tomar analgésicos</td>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="1" onchange="calcularOswestry()"><br>El dolor es fuerte pero puedo arreglármelas sin tomar analgésicos</td>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="2" onchange="calcularOswestry()"><br>Los analgésicos me alivian completamente el dolor</td>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="3" onchange="calcularOswestry()"><br>Los analgésicos me alivian un poco el dolor</td>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="4" onchange="calcularOswestry()"><br>Los analgésicos apenas me alivian el dolor</td>
                      <td class="text-center"><input type="radio" name="oswestry_item1" value="5" onchange="calcularOswestry()"><br>Los analgésicos no me alivian el dolor y no los tomo</td>
                    </tr>
                  </tbody>
                  <thead>
                    <tr>
                       <th colspan="6" class="bg-light text-start"><strong>2. Cuidados personales (lavarse, vestirse, etc.)</strong></th> </tr>
                   </thead>
                   <tbody>
                     <tr>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="0" onchange="calcularOswestry()"><br>Me las puedo arreglar solo sin que me aumente el dolor</td>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="1" onchange="calcularOswestry()"><br>Me las puedo arreglar solo pero esto me aumenta el dolor</td>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="2" onchange="calcularOswestry()"><br>Lavarme, vestirme, etc., me produce dolor y tengo que hacerlo despacio y con cuidado</td>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="3" onchange="calcularOswestry()"><br>Necesito alguna ayuda pero consigo hacer la mayoría de las cosas yo solo</td>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="4" onchange="calcularOswestry()"><br>Necesito ayuda para hacer la mayoría de las cosas</td>
                       <td class="text-center"><input type="radio" name="oswestry_item2" value="5" onchange="calcularOswestry()"><br>No puedo vestirme, me cuesta lavarme y suelo quedarme en la cama</td>
                     </tr>
                   </tbody>
                   <thead>
                     <tr>
                        <th colspan="6" class="bg-light text-start"><strong>3. Levantar peso</strong></th> </tr>
                   </thead>
                   <tbody>
                      <tr>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="0" onchange="calcularOswestry()"><br>Puedo levantar objetos pesados sin que me aumente el dolor</td>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="1" onchange="calcularOswestry()"><br>Puedo levantar objetos pesados pero me aumenta el dolor</td>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="2" onchange="calcularOswestry()"><br>El dolor me impide levantar objetos pesados del suelo, pero puedo hacerlo si están colocados en un sitio fácil como por ejemplo en una mesa</td>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="3" onchange="calcularOswestry()"><br>El dolor me impide levantar objetos pesados, pero sí puedo levantar objetos ligeros o medianos si están colocados en un sitio fácil</td>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="4" onchange="calcularOswestry()"><br>Sólo puedo levantar objetos muy ligeros</td>
                        <td class="text-center"><input type="radio" name="oswestry_item3" value="5" onchange="calcularOswestry()"><br>No puedo levantar ni acarrear ningún objeto</td>
                      </tr>
                    </tbody>
                    <thead>
                      <tr>
                         <th colspan="6" class="bg-light text-start"><strong>4. Caminar</strong></th> </tr>
                    </thead>
                    <tbody>
                       <tr>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="0" onchange="calcularOswestry()"><br>El dolor no me impide caminar cualquier distancia</td>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="1" onchange="calcularOswestry()"><br>El dolor me impide caminar más de un kilómetro</td>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="2" onchange="calcularOswestry()"><br>El dolor me impide caminar más de 500 metros</td>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="3" onchange="calcularOswestry()"><br>El dolor me impide caminar más de 250 metros</td>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="4" onchange="calcularOswestry()"><br>Sólo puedo caminar usando un bastón o muletas</td>
                         <td class="text-center"><input type="radio" name="oswestry_item4" value="5" onchange="calcularOswestry()"><br>Permanezco en la cama casi todo el tiempo y tengo que ir a rastras al baño</td>
                       </tr>
                     </tbody>
                     <thead>
                       <tr>
                          <th colspan="6" class="bg-light text-start"><strong>5. Estar sentado</strong></th> </tr>
                     </thead>
                     <tbody>
                        <tr>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="0" onchange="calcularOswestry()"><br>Puedo estar sentado en cualquier tipo de silla todo el tiempo que quiera</td>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="1" onchange="calcularOswestry()"><br>Puedo estar sentado en mi silla favorita todo el tiempo que quiera</td>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="2" onchange="calcularOswestry()"><br>El dolor me impide estar sentado más de una hora</td>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="3" onchange="calcularOswestry()"><br>El dolor me impide estar sentado más de media hora</td>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="4" onchange="calcularOswestry()"><br>El dolor me impide estar sentado más de 10 minutos</td>
                          <td class="text-center"><input type="radio" name="oswestry_item5" value="5" onchange="calcularOswestry()"><br>El dolor me impide estar sentado</td>
                        </tr>
                      </tbody>
                      <thead>
                        <tr>
                           <th colspan="6" class="bg-light text-start"><strong>6. Estar de pie</strong></th> </tr>
                      </thead>
                      <tbody>
                         <tr>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="0" onchange="calcularOswestry()"><br>Puedo estar de pie tanto tiempo como quiera sin que me aumente el dolor</td>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="1" onchange="calcularOswestry()"><br>Puedo estar de pie tanto tiempo como quiera pero me aumenta el dolor</td>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="2" onchange="calcularOswestry()"><br>El dolor me impide estar de pie más de una hora</td>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="3" onchange="calcularOswestry()"><br>El dolor me impide estar de pie más de media hora</td>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="4" onchange="calcularOswestry()"><br>El dolor me impide estar de pie más de 10 minutos</td>
                           <td class="text-center"><input type="radio" name="oswestry_item6" value="5" onchange="calcularOswestry()"><br>El dolor me impide estar de pie</td>
                         </tr>
                       </tbody>
                       <thead>
                         <tr>
                            <th colspan="6" class="bg-light text-start"><strong>7. Dormir</strong></th> </tr>
                       </thead>
                       <tbody>
                          <tr>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="0" onchange="calcularOswestry()"><br>El dolor no me impide dormir bien</td>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="1" onchange="calcularOswestry()"><br>Sólo puedo dormir si tomo pastillas</td>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="2" onchange="calcularOswestry()"><br>Incluso tomando pastillas duermo menos de 6 horas</td>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="3" onchange="calcularOswestry()"><br>Incluso tomando pastillas duermo menos de 4 horas</td>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="4" onchange="calcularOswestry()"><br>Incluso tomando pastillas duermo menos de 2 horas</td>
                            <td class="text-center"><input type="radio" name="oswestry_item7" value="5" onchange="calcularOswestry()"><br>El dolor me impide totalmente dormir</td>
                          </tr>
                        </tbody>
                        <thead>
                          <tr>
                             <th colspan="6" class="bg-light text-start"><strong>8. Actividad sexual</strong></th> </tr>
                        </thead>
                        <tbody>
                           <tr>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="0" onchange="calcularOswestry()"><br>Mi actividad sexual es normal y no me aumenta el dolor</td>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="1" onchange="calcularOswestry()"><br>Mi actividad sexual es normal pero me aumenta el dolor</td>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="2" onchange="calcularOswestry()"><br>Mi actividad sexual es casi normal pero me aumenta mucho el dolor</td>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="3" onchange="calcularOswestry()"><br>Mi actividad sexual se ha visto muy limitada a causa del dolor</td>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="4" onchange="calcularOswestry()"><br>Mi actividad sexual es casi nula a causa del dolor</td>
                             <td class="text-center"><input type="radio" name="oswestry_item8" value="5" onchange="calcularOswestry()"><br>El dolor me impide todo tipo de actividad sexual</td>
                           </tr>
                         </tbody>
                         <thead>
                           <tr>
                              <th colspan="6" class="bg-light text-start"><strong>9. Vida social</strong></th> </tr>
                         </thead>
                         <tbody>
                            <tr>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="0" onchange="calcularOswestry()"><br>Mi vida social es normal y no me aumenta el dolor</td>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="1" onchange="calcularOswestry()"><br>Mi vida social es normal pero me aumenta el dolor</td>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="2" onchange="calcularOswestry()"><br>El dolor no tiene un efecto importante en mi vida social, pero sí impide mis actividades más enérgicas como bailar, etc.</td>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="3" onchange="calcularOswestry()"><br>El dolor ha limitado mi vida social y no salgo tan a menudo</td>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="4" onchange="calcularOswestry()"><br>El dolor ha limitado mi vida social al hogar</td>
                              <td class="text-center"><input type="radio" name="oswestry_item9" value="5" onchange="calcularOswestry()"><br>No tengo vida social a causa del dolor</td>
                            </tr>
                          </tbody>
                          <thead>
                            <tr>
                               <th colspan="6" class="bg-light text-start"><strong>10. Viajar</strong></th> </tr>
                          </thead>
                          <tbody>
                             <tr>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="0" onchange="calcularOswestry()"><br>Puedo viajar a cualquier sitio sin que me aumente el dolor</td>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="1" onchange="calcularOswestry()"><br>Puedo viajar a cualquier sitio, pero me aumenta el dolor</td>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="2" onchange="calcularOswestry()"><br>El dolor es fuerte pero aguanto viajes de más de 2 horas</td>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="3" onchange="calcularOswestry()"><br>El dolor me limita a viajes de menos de una hora</td>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="4" onchange="calcularOswestry()"><br>El dolor me limita a viajes cortos y necesarios de menos de 30 minutos</td>
                               <td class="text-center"><input type="radio" name="oswestry_item10" value="5" onchange="calcularOswestry()"><br>El dolor me impide viajar excepto para ir al médico o al hospital</td>
                             </tr>
                           </tbody>
                </table>
              </div> <div class="resultado-container" id="oswestry-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="oswestry-valor-total">-/50</div>
                    <div class="resultado-interpretacion" id="oswestry-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Interpretación:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Porcentaje:</div>
                        <div class="resultado-valor" id="oswestry-valor-porcentaje">-%</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Nivel de discapacidad:</div>
                        <div class="resultado-valor" id="oswestry-nivel-discapacidad">-</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="oswestry-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="oswestry-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('oswestry-content', 'Oswestry')">
                      <i class="fas fa-file-pdf"></i> Guardar Oswestry como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-rolandmorris"> <div class="cuestionario-header" onclick="toggleCuestionario('rolandmorris-content')">
              <h4><i class="fas fa-plus-circle"></i> Cuestionario de Discapacidad de Roland Morris (RMDQ)</h4>
              <div class="resultado-badge no-completado" id="rolandmorris-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="rolandmorris-content" style="display: none;">
              <p class="mb-3">Cuando su espalda le duele, puede que le sea difícil hacer algunas de las cosas que habitualmente hace. Esta lista contiene algunas frases que las personas han usado para describir cómo se encuentran cuando les duele la espalda. Cuando las lea, puede que encuentre algunas que describan su estado actual. Cuando lea la lista, piense en cómo se encuentra <strong>hoy</strong>. Marque la casilla si la frase describe su estado actual.</p>

              <div class="form-check mb-2"> <input type="checkbox" class="form-check-input" id="rolandmorris_item1" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item1">1. Me quedo en casa la mayor parte del tiempo por mi dolor de espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item2" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item2">2. Cambio de postura con frecuencia para intentar aliviar mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item3" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item3">3. Debido a mi espalda, camino más lentamente de lo normal.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item4" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item4">4. Debido a mi espalda, no hago ninguno de los trabajos que habitualmente hago en casa.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item5" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item5">5. Por mi espalda, uso el pasamanos para subir escaleras.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item6" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item6">6. A causa de mi espalda, debo acostarme más a menudo para descansar.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item7" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item7">7. Debido a mi espalda, necesito agarrarme a algo para levantarme de los sillones o sofás.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item8" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item8">8. Por culpa de mi espalda, pido a los demás que me hagan las cosas.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item9" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item9">9. Me visto más lentamente de lo normal a causa de mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item10" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item10">10. A causa de mi espalda, sólo me quedo de pie durante cortos períodos de tiempo.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item11" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item11">11. A causa de mi espalda, procuro evitar inclinarme o arrodillarme.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item12" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item12">12. Me cuesta levantarme de una silla por culpa de mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item13" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item13">13. Me duele la espalda casi siempre.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item14" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item14">14. Me cuesta darme la vuelta en la cama por culpa de mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item15" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item15">15. Debido a mi dolor de espalda, no tengo mucho apetito.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item16" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item16">16. Me cuesta ponerme los calcetines (o medias) por mi dolor de espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item17" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item17">17. Debido a mi dolor de espalda, tan solo ando distancias cortas.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item18" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item18">18. Duermo peor debido a mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item19" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item19">19. Por mi dolor de espalda, deben ayudarme a vestirme.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item20" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item20">20. Estoy casi todo el día sentado a causa de mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item21" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item21">21. Evito hacer trabajos pesados en casa, por culpa de mi espalda.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item22" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item22">22. Por mi dolor de espalda, estoy más irritable y de peor humor de lo normal.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item23" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item23">23. A causa de mi espalda, subo las escaleras más lentamente de lo normal.</label>
              </div>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="rolandmorris_item24" onchange="calcularRolandMorris()">
                <label class="form-check-label" for="rolandmorris_item24">24. Me quedo casi constantemente en la cama por mi espalda.</label>
              </div>

              <div class="resultado-container mt-4" id="rolandmorris-resultado"> <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="rolandmorris-valor-total">-/24</div>
                    <div class="resultado-interpretacion" id="rolandmorris-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Interpretación:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Porcentaje:</div>
                        <div class="resultado-valor" id="rolandmorris-valor-porcentaje">-%</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Nivel de discapacidad:</div>
                        <div class="resultado-valor" id="rolandmorris-nivel-discapacidad">-</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="rolandmorris-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="rolandmorris-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('rolandmorris-content', 'Roland Morris')">
                      <i class="fas fa-file-pdf"></i> Guardar Roland Morris como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-womac"> <div class="cuestionario-header" onclick="toggleCuestionario('womac-content')">
              <h4><i class="fas fa-plus-circle"></i> Índice de Osteoartritis WOMAC</h4>
              <div class="resultado-badge no-completado" id="womac-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="womac-content" style="display: none;">
              <p class="mb-3">Las siguientes preguntas evalúan el dolor, rigidez y función física en relación con su articulación (rodilla o cadera). Por favor, indique la intensidad de estos síntomas durante las últimas 48 horas.</p>

              <h5 class="mt-4 mb-3">Sección A: DOLOR</h5>
              <p>¿Cuánto dolor tiene usted?</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Pregunta</th>
                      <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Al caminar por una superficie plana</td>
                      <td class="text-center"><input type="radio" name="womac_a1" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a1" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a1" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a1" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a1" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>2. Al subir o bajar escaleras</td>
                      <td class="text-center"><input type="radio" name="womac_a2" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a2" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a2" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a2" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a2" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>3. Por la noche en la cama</td>
                      <td class="text-center"><input type="radio" name="womac_a3" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a3" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a3" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a3" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a3" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>4. Al estar sentado o acostado</td>
                      <td class="text-center"><input type="radio" name="womac_a4" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a4" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a4" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a4" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a4" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>5. Al estar de pie</td>
                      <td class="text-center"><input type="radio" name="womac_a5" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a5" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a5" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a5" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_a5" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">Sección B: RIGIDEZ</h5>
              <p>¿Cuánta rigidez presenta?</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Pregunta</th>
                      <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. ¿Qué tan intensa es su rigidez después de despertarse por la mañana?</td>
                      <td class="text-center"><input type="radio" name="womac_b1" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b1" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b1" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b1" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b1" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>2. ¿Qué tan intensa es su rigidez después de estar sentado, acostado o descansando durante el día?</td>
                      <td class="text-center"><input type="radio" name="womac_b2" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b2" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b2" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b2" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_b2" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">Sección C: FUNCIÓN FÍSICA</h5>
              <p>¿Qué grado de dificultad tiene al realizar las siguientes actividades?</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th>Pregunta</th>
                      <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Bajar escaleras</td>
                      <td class="text-center"><input type="radio" name="womac_c1" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c1" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c1" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c1" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c1" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>2. Subir escaleras</td>
                      <td class="text-center"><input type="radio" name="womac_c2" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c2" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c2" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c2" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c2" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                    <tr>
                      <td>3. Levantarse de una silla</td>
                      <td class="text-center"><input type="radio" name="womac_c3" value="0" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c3" value="1" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c3" value="2" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c3" value="3" onchange="calcularWOMAC()"></td>
                      <td class="text-center"><input type="radio" name="womac_c3" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                     <tr>
                       <td>4. Estar de pie</td>
                       <td class="text-center"><input type="radio" name="womac_c4" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c4" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c4" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c4" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c4" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>5. Agacharse para coger algo del suelo</td>
                       <td class="text-center"><input type="radio" name="womac_c5" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c5" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c5" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c5" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c5" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>6. Caminar en terreno llano</td>
                       <td class="text-center"><input type="radio" name="womac_c6" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c6" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c6" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c6" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c6" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>7. Entrar y salir de un coche</td>
                       <td class="text-center"><input type="radio" name="womac_c7" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c7" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c7" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c7" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c7" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>8. Ir de compras</td>
                       <td class="text-center"><input type="radio" name="womac_c8" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c8" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c8" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c8" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c8" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>9. Ponerse calcetines o medias</td>
                       <td class="text-center"><input type="radio" name="womac_c9" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c9" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c9" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c9" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c9" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>10. Levantarse de la cama</td>
                       <td class="text-center"><input type="radio" name="womac_c10" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c10" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c10" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c10" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c10" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>11. Quitarse calcetines o medias</td>
                       <td class="text-center"><input type="radio" name="womac_c11" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c11" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c11" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c11" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c11" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>12. Estar acostado en la cama</td>
                       <td class="text-center"><input type="radio" name="womac_c12" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c12" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c12" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c12" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c12" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>13. Entrar o salir de la bañera/ducha</td>
                       <td class="text-center"><input type="radio" name="womac_c13" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c13" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c13" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c13" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c13" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>14. Estar sentado</td>
                       <td class="text-center"><input type="radio" name="womac_c14" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c14" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c14" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c14" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c14" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>15. Sentarse y levantarse del inodoro</td>
                       <td class="text-center"><input type="radio" name="womac_c15" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c15" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c15" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c15" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c15" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>16. Realizar tareas domésticas pesadas</td>
                       <td class="text-center"><input type="radio" name="womac_c16" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c16" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c16" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c16" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c16" value="4" onchange="calcularWOMAC()"></td>
                     </tr>
                     <tr>
                       <td>17. Realizar tareas domésticas ligeras</td>
                       <td class="text-center"><input type="radio" name="womac_c17" value="0" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c17" value="1" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c17" value="2" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c17" value="3" onchange="calcularWOMAC()"></td>
                       <td class="text-center"><input type="radio" name="womac_c17" value="4" onchange="calcularWOMAC()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="resultado-container" id="womac-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="womac-valor-total">-/96</div>
                    <div class="resultado-interpretacion" id="womac-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas (0-100%):</div>
                    <div class="row"> <div class="col-md-4"> <div class="resultado-sublabel">Dolor:</div>
                        <div class="resultado-valor" id="womac-valor-dolor">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Rigidez:</div>
                        <div class="resultado-valor" id="womac-valor-rigidez">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Función:</div>
                        <div class="resultado-valor" id="womac-valor-funcion">-%</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="womac-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="womac-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('womac-content', 'WOMAC')">
                      <i class="fas fa-file-pdf"></i> Guardar WOMAC como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-startmsk"> <div class="cuestionario-header" onclick="toggleCuestionario('startmsk-content')">
              <h4><i class="fas fa-plus-circle"></i> START MSK Tool (Estratificación de Riesgo Musculoesquelético)</h4>
              <div class="resultado-badge no-completado" id="startmsk-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="startmsk-content" style="display: none;">
              <p class="mb-3">Esta herramienta ayuda a identificar factores de riesgo para el desarrollo de dolor persistente y problemas funcionales. Por favor, responda a las siguientes preguntas pensando en su dolor musculoesquelético durante las últimas 2 semanas.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:70%;">Pregunta</th> <th style="width:15%;">En desacuerdo</th> <th style="width:15%;">De acuerdo</th> </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Mi dolor a veces se extiende a otras partes (por ejemplo, a mi espalda, hombro, brazos, piernas).</td>
                      <td class="text-center"><input type="radio" name="startmsk_item1" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item1" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>2. He tenido dolor en otros lugares del cuerpo además de mi dolencia principal.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item2" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item2" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>3. Me limito en ciertas actividades que podrían empeorar mi dolor.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item3" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item3" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>4. En el último par de semanas, he tenido problemas para vestirme (por ejemplo, ponerme calcetines, pantalones o zapatos) debido a mi dolor.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item4" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item4" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>5. Me preocupa que mi dolor pueda empeorar.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item5" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item5" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>6. Siento que mi problema es terrible y que nunca va a mejorar.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item6" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item6" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>7. En general, no he disfrutado de las cosas que solía disfrutar.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item7" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item7" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>8. En las últimas 2 semanas, me he sentido tenso o ansioso.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item8" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item8" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>9. En las últimas 2 semanas, me he sentido deprimido o con bajo estado de ánimo.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item9" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item9" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                    <tr>
                      <td>10. No estoy seguro de poder manejar mi dolor por mí mismo.</td>
                      <td class="text-center"><input type="radio" name="startmsk_item10" value="0" onchange="calcularStartMSK()"></td>
                      <td class="text-center"><input type="radio" name="startmsk_item10" value="1" onchange="calcularStartMSK()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="resultado-container" id="startmsk-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="startmsk-valor-total">-/10</div>
                    <div class="resultado-interpretacion" id="startmsk-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Física (ítems 1-4):</div>
                        <div class="resultado-valor" id="startmsk-valor-fisica">-/4</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Psicosocial (ítems 5-10):</div>
                        <div class="resultado-valor" id="startmsk-valor-psicosocial">-/6</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="startmsk-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="startmsk-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('startmsk-content', 'START MSK')">
                      <i class="fas fa-file-pdf"></i> Guardar START MSK como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-startback"> <div class="cuestionario-header" onclick="toggleCuestionario('startback-content')">
              <h4><i class="fas fa-plus-circle"></i> START Back Tool (Estratificación de Riesgo para Dolor Lumbar)</h4>
              <div class="resultado-badge no-completado" id="startback-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="startback-content" style="display: none;">
              <p class="mb-3">Piense en las últimas 2 semanas al responder estas preguntas. Por favor, indique si está de acuerdo o en desacuerdo con las siguientes afirmaciones.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:70%;">Pregunta</th> <th style="width:15%;">En desacuerdo</th> <th style="width:15%;">De acuerdo</th> </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Mi dolor de espalda se ha extendido por mi pierna(s) en algún momento en las últimas 2 semanas.</td>
                      <td class="text-center"><input type="radio" name="startback_item1" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item1" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>2. He tenido dolor en hombro o cuello en algún momento en las últimas 2 semanas.</td>
                      <td class="text-center"><input type="radio" name="startback_item2" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item2" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>3. Solo he caminado distancias cortas debido a mi dolor de espalda.</td>
                      <td class="text-center"><input type="radio" name="startback_item3" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item3" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>4. En las últimas 2 semanas, me he vestido más lentamente de lo normal debido a mi dolor de espalda.</td>
                      <td class="text-center"><input type="radio" name="startback_item4" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item4" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>5. No es realmente seguro para una persona en mi condición estar físicamente activa.</td>
                      <td class="text-center"><input type="radio" name="startback_item5" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item5" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>6. Me he preocupado mucho por mi dolor de espalda.</td>
                      <td class="text-center"><input type="radio" name="startback_item6" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item6" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>7. Siento que mi dolor de espalda es terrible y que nunca va a mejorar.</td>
                      <td class="text-center"><input type="radio" name="startback_item7" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item7" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                    <tr>
                      <td>8. En general, no he disfrutado de las cosas que solía disfrutar.</td>
                      <td class="text-center"><input type="radio" name="startback_item8" value="0" onchange="calcularStartBack()"></td>
                      <td class="text-center"><input type="radio" name="startback_item8" value="1" onchange="calcularStartBack()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <p class="mb-2">9. En general, ¿cuánto le ha molestado su dolor de espalda en las últimas 2 semanas?</p>
              <div class="mb-4"> <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="startback_item9" id="startback_item9_0" value="0" onchange="calcularStartBack()">
                  <label class="form-check-label" for="startback_item9_0">Nada</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="startback_item9" id="startback_item9_1" value="1" onchange="calcularStartBack()">
                  <label class="form-check-label" for="startback_item9_1">Un poco</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="startback_item9" id="startback_item9_2" value="2" onchange="calcularStartBack()">
                  <label class="form-check-label" for="startback_item9_2">Moderadamente</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="startback_item9" id="startback_item9_3" value="3" onchange="calcularStartBack()">
                  <label class="form-check-label" for="startback_item9_3">Bastante</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="startback_item9" id="startback_item9_4" value="4" onchange="calcularStartBack()">
                  <label class="form-check-label" for="startback_item9_4">Mucho</label>
                </div>
                </div>

              <div class="resultado-container" id="startback-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="startback-valor-total">-/9</div>
                    <div class="resultado-interpretacion" id="startback-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="row"> <div class="col-md-6">
                            <div class="resultado-label">Subescala psicosocial:</div>
                            <div class="resultado-valor" id="startback-valor-psicosocial">-/5</div>
                         </div>
                         <div class="col-md-6">
                            <div class="resultado-sublabel">Grupo de riesgo:</div>
                            <div class="resultado-valor" id="startback-grupo-riesgo">-</div>
                        </div>
                     </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="startback-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="startback-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('startback-content', 'START Back')">
                      <i class="fas fa-file-pdf"></i> Guardar START Back como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-lefs"> <div class="cuestionario-header" onclick="toggleCuestionario('lefs-content')">
              <h4><i class="fas fa-plus-circle"></i> Escala Funcional de Extremidad Inferior (LEFS)</h4>
              <div class="resultado-badge no-completado" id="lefs-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="lefs-content" style="display: none;">
              <p class="mb-3">Estamos interesados en conocer si tiene dificultad para realizar las actividades enumeradas a continuación debido a su problema en la extremidad inferior (cadera, rodilla, tobillo o pie). Por favor, marque una respuesta para cada actividad.</p>

              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Actividad</th> <th>Extrema dificultad o imposible</th>
                      <th>Bastante dificultad</th>
                      <th>Dificultad moderada</th>
                      <th>Poca dificultad</th>
                      <th>Sin dificultad</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1. Cualquier actividad habitual, incluyendo tareas domésticas</td>
                      <td class="text-center"><input type="radio" name="lefs_item1" value="0" onchange="calcularLEFS()"></td>
                      <td class="text-center"><input type="radio" name="lefs_item1" value="1" onchange="calcularLEFS()"></td>
                      <td class="text-center"><input type="radio" name="lefs_item1" value="2" onchange="calcularLEFS()"></td>
                      <td class="text-center"><input type="radio" name="lefs_item1" value="3" onchange="calcularLEFS()"></td>
                      <td class="text-center"><input type="radio" name="lefs_item1" value="4" onchange="calcularLEFS()"></td>
                    </tr>
                     <tr>
                       <td>2. Aficiones, actividades recreativas o deportivas</td>
                       <td class="text-center"><input type="radio" name="lefs_item2" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item2" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item2" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item2" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item2" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>3. Entrar o salir de la bañera</td>
                       <td class="text-center"><input type="radio" name="lefs_item3" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item3" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item3" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item3" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item3" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>4. Caminar entre habitaciones</td>
                       <td class="text-center"><input type="radio" name="lefs_item4" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item4" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item4" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item4" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item4" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>5. Ponerse zapatos o calcetines</td>
                       <td class="text-center"><input type="radio" name="lefs_item5" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item5" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item5" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item5" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item5" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>6. Agacharse</td>
                       <td class="text-center"><input type="radio" name="lefs_item6" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item6" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item6" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item6" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item6" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>7. Levantar un objeto, como una bolsa de comestibles del suelo</td>
                       <td class="text-center"><input type="radio" name="lefs_item7" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item7" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item7" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item7" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item7" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>8. Realizar actividades ligeras en casa</td>
                       <td class="text-center"><input type="radio" name="lefs_item8" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item8" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item8" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item8" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item8" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>9. Realizar actividades pesadas en casa</td>
                       <td class="text-center"><input type="radio" name="lefs_item9" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item9" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item9" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item9" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item9" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>10. Entrar o salir de un coche</td>
                       <td class="text-center"><input type="radio" name="lefs_item10" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item10" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item10" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item10" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item10" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>11. Caminar 2 cuadras (unos 200 m)</td>
                       <td class="text-center"><input type="radio" name="lefs_item11" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item11" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item11" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item11" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item11" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>12. Caminar 1 km</td>
                       <td class="text-center"><input type="radio" name="lefs_item12" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item12" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item12" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item12" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item12" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>13. Subir o bajar 10 escalones (aproximadamente 1 piso)</td>
                       <td class="text-center"><input type="radio" name="lefs_item13" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item13" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item13" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item13" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item13" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>14. Estar de pie durante 1 hora</td>
                       <td class="text-center"><input type="radio" name="lefs_item14" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item14" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item14" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item14" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item14" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>15. Sentarse durante 1 hora</td>
                       <td class="text-center"><input type="radio" name="lefs_item15" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item15" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item15" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item15" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item15" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>16. Correr en superficie nivelada</td>
                       <td class="text-center"><input type="radio" name="lefs_item16" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item16" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item16" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item16" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item16" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>17. Correr sobre césped</td>
                       <td class="text-center"><input type="radio" name="lefs_item17" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item17" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item17" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item17" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item17" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>18. Hacer giros o pivotes sobre su pierna afectada</td>
                       <td class="text-center"><input type="radio" name="lefs_item18" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item18" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item18" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item18" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item18" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>19. Ponerse en cuclillas</td>
                       <td class="text-center"><input type="radio" name="lefs_item19" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item19" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item19" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item19" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item19" value="4" onchange="calcularLEFS()"></td>
                     </tr>
                     <tr>
                       <td>20. Arrodillarse</td>
                       <td class="text-center"><input type="radio" name="lefs_item20" value="0" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item20" value="1" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item20" value="2" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item20" value="3" onchange="calcularLEFS()"></td>
                       <td class="text-center"><input type="radio" name="lefs_item20" value="4" onchange="calcularLEFS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <div class="resultado-container" id="lefs-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total:</div>
                    <div class="resultado-valor" id="lefs-valor-total">-/80</div>
                    <div class="resultado-interpretacion" id="lefs-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Interpretación:</div>
                    <div class="row"> <div class="col-md-6"> <div class="resultado-sublabel">Porcentaje de función:</div>
                        <div class="resultado-valor" id="lefs-valor-porcentaje">-%</div>
                      </div>
                      <div class="col-md-6"> <div class="resultado-sublabel">Nivel de discapacidad:</div>
                        <div class="resultado-valor" id="lefs-nivel-discapacidad">-</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="lefs-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="lefs-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('lefs-content', 'LEFS')">
                      <i class="fas fa-file-pdf"></i> Guardar LEFS como PDF
                  </button>
              </div>

            </div> </div>
            <div class="cuestionario-item" id="item-hoos"> <div class="cuestionario-header" onclick="toggleCuestionario('hoos-content')">
              <h4><i class="fas fa-plus-circle"></i> Cuestionario HOOS (Función y Síntomas de Cadera)</h4>
              <div class="resultado-badge no-completado" id="hoos-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="hoos-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa su percepción sobre su cadera y su capacidad para realizar actividades cotidianas. Responda cada pregunta seleccionando la opción que mejor describa su situación durante la última semana.</p>

              <h5 class="mt-4 mb-3">S. SÍNTOMAS Y RIGIDEZ</h5>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Pregunta</th> <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>S1. ¿Ha notado crujidos, chasquidos u otro tipo de ruidos en su cadera?</td>
                      <td class="text-center"><input type="radio" name="hoos_s1" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s1" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s1" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s1" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s1" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                    <tr>
                      <td>S2. ¿Tiene dificultad para abrir las piernas completamente?</td>
                      <td class="text-center"><input type="radio" name="hoos_s2" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s2" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s2" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s2" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s2" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                    <tr>
                      <td>S3. ¿Tiene dificultad para caminar con zancadas largas?</td>
                      <td class="text-center"><input type="radio" name="hoos_s3" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s3" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s3" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s3" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s3" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                    <tr>
                      <td>S4. ¿Cuánta rigidez nota en su cadera justo después de despertarse por la mañana?</td>
                      <td class="text-center"><input type="radio" name="hoos_s4" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s4" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s4" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s4" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s4" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                    <tr>
                      <td>S5. ¿Cuánta rigidez nota en su cadera después de estar sentado o descansando durante el día?</td>
                      <td class="text-center"><input type="radio" name="hoos_s5" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s5" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s5" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s5" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_s5" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <h5 class="mt-4 mb-3">P. DOLOR</h5>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">¿Cuánto dolor ha notado en su cadera?</th> <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>P1. ¿Con qué frecuencia nota dolor en la cadera?</td>
                      <td class="text-center"><input type="radio" name="hoos_p1" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_p1" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_p1" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_p1" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_p1" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                     <tr>
                       <td>P2. Al extender la cadera completamente</td>
                       <td class="text-center"><input type="radio" name="hoos_p2" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p2" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p2" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p2" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p2" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P3. Al flexionar la cadera completamente</td>
                       <td class="text-center"><input type="radio" name="hoos_p3" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p3" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p3" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p3" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p3" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P4. Al caminar sobre una superficie plana</td>
                       <td class="text-center"><input type="radio" name="hoos_p4" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p4" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p4" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p4" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p4" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P5. Al subir o bajar escaleras</td>
                       <td class="text-center"><input type="radio" name="hoos_p5" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p5" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p5" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p5" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p5" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P6. Por la noche en la cama</td>
                       <td class="text-center"><input type="radio" name="hoos_p6" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p6" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p6" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p6" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p6" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P7. Al estar sentado o tumbado</td>
                       <td class="text-center"><input type="radio" name="hoos_p7" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p7" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p7" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p7" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p7" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P8. Al estar de pie</td>
                       <td class="text-center"><input type="radio" name="hoos_p8" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p8" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p8" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p8" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p8" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P9. Al caminar sobre una superficie dura (asfalto, hormigón, etc.)</td>
                       <td class="text-center"><input type="radio" name="hoos_p9" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p9" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p9" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p9" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p9" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>P10. Al caminar sobre una superficie irregular</td>
                       <td class="text-center"><input type="radio" name="hoos_p10" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p10" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p10" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p10" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_p10" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">A. ACTIVIDADES DE LA VIDA DIARIA</h5>
              <p>Las siguientes preguntas tratan sobre su nivel de funcionamiento en las actividades cotidianas. Indique el grado de dificultad que ha experimentado a causa de su cadera.</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Actividad</th> <th>Ninguna</th>
                      <th>Leve</th>
                      <th>Moderada</th>
                      <th>Severa</th>
                      <th>Extrema</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>A1. Bajar escaleras</td>
                      <td class="text-center"><input type="radio" name="hoos_a1" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_a1" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_a1" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_a1" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_a1" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                     <tr>
                       <td>A2. Subir escaleras</td>
                       <td class="text-center"><input type="radio" name="hoos_a2" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a2" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a2" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a2" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a2" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A3. Levantarse de una silla</td>
                       <td class="text-center"><input type="radio" name="hoos_a3" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a3" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a3" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a3" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a3" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A4. Permanecer de pie</td>
                       <td class="text-center"><input type="radio" name="hoos_a4" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a4" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a4" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a4" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a4" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A5. Agacharse/recoger algo del suelo</td>
                       <td class="text-center"><input type="radio" name="hoos_a5" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a5" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a5" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a5" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a5" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A6. Caminar sobre una superficie plana</td>
                       <td class="text-center"><input type="radio" name="hoos_a6" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a6" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a6" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a6" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a6" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A7. Entrar/salir de un coche</td>
                       <td class="text-center"><input type="radio" name="hoos_a7" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a7" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a7" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a7" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a7" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A8. Ir de compras</td>
                       <td class="text-center"><input type="radio" name="hoos_a8" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a8" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a8" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a8" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a8" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A9. Ponerse los calcetines/medias</td>
                       <td class="text-center"><input type="radio" name="hoos_a9" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a9" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a9" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a9" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a9" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A10. Levantarse de la cama</td>
                       <td class="text-center"><input type="radio" name="hoos_a10" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a10" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a10" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a10" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a10" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A11. Quitarse los calcetines/medias</td>
                       <td class="text-center"><input type="radio" name="hoos_a11" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a11" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a11" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a11" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a11" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A12. Tumbarse en la cama (darse la vuelta, mantener la posición de la cadera)</td>
                       <td class="text-center"><input type="radio" name="hoos_a12" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a12" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a12" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a12" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a12" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A13. Entrar/salir de la bañera</td>
                       <td class="text-center"><input type="radio" name="hoos_a13" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a13" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a13" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a13" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a13" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A14. Sentarse</td>
                       <td class="text-center"><input type="radio" name="hoos_a14" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a14" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a14" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a14" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a14" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A15. Sentarse/levantarse del inodoro</td>
                       <td class="text-center"><input type="radio" name="hoos_a15" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a15" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a15" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a15" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a15" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A16. Realizar tareas domésticas pesadas (mover cajas pesadas, fregar suelos, etc.)</td>
                       <td class="text-center"><input type="radio" name="hoos_a16" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a16" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a16" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a16" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a16" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>A17. Realizar tareas domésticas ligeras (cocinar, quitar el polvo, etc.)</td>
                       <td class="text-center"><input type="radio" name="hoos_a17" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a17" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a17" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a17" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_a17" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <h5 class="mt-4 mb-3">SP. DEPORTES Y ACTIVIDADES RECREATIVAS</h5>
              <p>Las siguientes preguntas se refieren a su capacidad física cuando realiza actividades más exigentes. Responda según su experiencia durante la última semana.</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Actividad</th> <th>Ninguna</th>
                      <th>Leve</th>
                      <th>Moderada</th>
                      <th>Severa</th>
                      <th>Extrema</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>SP1. Ponerse en cuclillas</td>
                      <td class="text-center"><input type="radio" name="hoos_sp1" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_sp1" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_sp1" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_sp1" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_sp1" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                     <tr>
                       <td>SP2. Correr</td>
                       <td class="text-center"><input type="radio" name="hoos_sp2" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp2" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp2" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp2" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp2" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>SP3. Girar/pivotar sobre la pierna afectada</td>
                       <td class="text-center"><input type="radio" name="hoos_sp3" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp3" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp3" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp3" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp3" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>SP4. Caminar sobre superficie irregular</td>
                       <td class="text-center"><input type="radio" name="hoos_sp4" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp4" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp4" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp4" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_sp4" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">Q. CALIDAD DE VIDA</h5>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Pregunta</th> <th>Nunca</th>
                      <th>Mensualmente</th>
                      <th>Semanalmente</th>
                      <th>Diariamente</th>
                      <th>Constantemente</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Q1. ¿Con qué frecuencia es consciente de su problema de cadera?</td>
                      <td class="text-center"><input type="radio" name="hoos_q1" value="0" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_q1" value="1" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_q1" value="2" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_q1" value="3" onchange="calcularHOOS()"></td>
                      <td class="text-center"><input type="radio" name="hoos_q1" value="4" onchange="calcularHOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <div class="table-responsive"> <table class="table table-bordered mb-4">
                   <thead>
                     <tr>
                       <th style="width:50%;">Pregunta</th> <th>Nada</th>
                       <th>Ligeramente</th>
                       <th>Moderadamente</th>
                       <th>Gravemente</th>
                       <th>Totalmente</th>
                     </tr>
                   </thead>
                   <tbody>
                     <tr>
                       <td>Q2. ¿Ha modificado su estilo de vida para evitar actividades que podrían dañar su cadera?</td>
                       <td class="text-center"><input type="radio" name="hoos_q2" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q2" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q2" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q2" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q2" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>Q3. ¿Cuánta preocupación siente por la falta de confianza en su cadera?</td>
                       <td class="text-center"><input type="radio" name="hoos_q3" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q3" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q3" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q3" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q3" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                     <tr>
                       <td>Q4. En general, ¿cuánta dificultad le supone su cadera?</td>
                       <td class="text-center"><input type="radio" name="hoos_q4" value="0" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q4" value="1" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q4" value="2" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q4" value="3" onchange="calcularHOOS()"></td>
                       <td class="text-center"><input type="radio" name="hoos_q4" value="4" onchange="calcularHOOS()"></td>
                     </tr>
                   </tbody>
                 </table>
               </div> <div class="resultado-container" id="hoos-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total Promedio:</div>
                    <div class="resultado-valor" id="hoos-valor-total">-%</div>
                    <div class="resultado-interpretacion" id="hoos-interpretacion-total">Complete el cuestionario</div>
                  </div>
                  <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas (0-100%):</div>
                    <div class="row mb-2"> <div class="col-md-4"> <div class="resultado-sublabel">Dolor:</div>
                        <div class="resultado-valor" id="hoos-valor-dolor">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Síntomas:</div>
                        <div class="resultado-valor" id="hoos-valor-sintomas">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">AVD:</div>
                        <div class="resultado-valor" id="hoos-valor-avd">-%</div>
                      </div>
                    </div>
                    <div class="row"> <div class="col-md-4"> <div class="resultado-sublabel">Deporte:</div>
                        <div class="resultado-valor" id="hoos-valor-deporte">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Calidad de vida:</div>
                        <div class="resultado-valor" id="hoos-valor-qol">-%</div>
                      </div>
                      <div class="col-md-4"></div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="hoos-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="hoos-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('hoos-content', 'HOOS')">
                      <i class="fas fa-file-pdf"></i> Guardar HOOS como PDF
                  </button>
              </div>

            </div> </div> <div class="cuestionario-item" id="item-koos"> <div class="cuestionario-header" onclick="toggleCuestionario('koos-content')">
              <h4><i class="fas fa-plus-circle"></i> Cuestionario KOOS (Función y Síntomas de Rodilla)</h4>
              <div class="resultado-badge no-completado" id="koos-badge">No completado</div>
            </div>
            <div class="cuestionario-content" id="koos-content" style="display: none;">
              <p class="mb-3">Este cuestionario evalúa su percepción sobre su rodilla y su capacidad para realizar actividades cotidianas. Responda cada pregunta seleccionando la opción que mejor describa su situación durante la última semana.</p>

              <h5 class="mt-4 mb-3">S. SÍNTOMAS Y RIGIDEZ</h5>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Pregunta</th> <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>S1. ¿Ha notado hinchazón en la rodilla?</td>
                      <td class="text-center"><input type="radio" name="koos_s1" value="0" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_s1" value="1" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_s1" value="2" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_s1" value="3" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_s1" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                     <tr>
                       <td>S2. ¿Ha sentido crujidos, chasquidos u otro tipo de ruidos al mover la rodilla?</td>
                       <td class="text-center"><input type="radio" name="koos_s2" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s2" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s2" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s2" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s2" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>S3. ¿Le ha ocurrido que la rodilla se bloquee o quede atascada al moverla?</td>
                       <td class="text-center"><input type="radio" name="koos_s3" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s3" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s3" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s3" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s3" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>S4. ¿Puede extender la rodilla completamente?</td>
                       <td class="text-center"><input type="radio" name="koos_s4" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s4" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s4" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s4" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s4" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>S5. ¿Puede doblar la rodilla completamente?</td>
                       <td class="text-center"><input type="radio" name="koos_s5" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s5" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s5" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s5" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s5" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>S6. ¿Cuánta rigidez nota en su rodilla al despertar por la mañana?</td>
                       <td class="text-center"><input type="radio" name="koos_s6" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s6" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s6" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s6" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s6" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>S7. ¿Cuánta rigidez nota en su rodilla después de estar sentado o descansando durante el día?</td>
                       <td class="text-center"><input type="radio" name="koos_s7" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s7" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s7" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s7" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_s7" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <h5 class="mt-4 mb-3">P. DOLOR</h5>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">¿Cuánto dolor ha notado en su rodilla?</th> <th>Ninguno</th>
                      <th>Leve</th>
                      <th>Moderado</th>
                      <th>Severo</th>
                      <th>Extremo</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>P1. ¿Con qué frecuencia nota dolor en la rodilla?</td>
                      <td class="text-center"><input type="radio" name="koos_p1" value="0" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_p1" value="1" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_p1" value="2" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_p1" value="3" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_p1" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                     <tr>
                       <td>P2. Al girar o pivotar sobre la rodilla</td>
                       <td class="text-center"><input type="radio" name="koos_p2" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p2" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p2" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p2" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p2" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P3. Al extender completamente la rodilla</td>
                       <td class="text-center"><input type="radio" name="koos_p3" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p3" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p3" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p3" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p3" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P4. Al flexionar completamente la rodilla</td>
                       <td class="text-center"><input type="radio" name="koos_p4" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p4" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p4" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p4" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p4" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P5. Al caminar sobre una superficie plana</td>
                       <td class="text-center"><input type="radio" name="koos_p5" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p5" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p5" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p5" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p5" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P6. Al subir o bajar escaleras</td>
                       <td class="text-center"><input type="radio" name="koos_p6" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p6" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p6" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p6" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p6" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P7. Por la noche en la cama</td>
                       <td class="text-center"><input type="radio" name="koos_p7" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p7" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p7" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p7" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p7" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P8. Al estar sentado o tumbado</td>
                       <td class="text-center"><input type="radio" name="koos_p8" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p8" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p8" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p8" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p8" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>P9. Al estar de pie</td>
                       <td class="text-center"><input type="radio" name="koos_p9" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p9" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p9" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p9" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_p9" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">A. ACTIVIDADES DE LA VIDA DIARIA</h5>
              <p>Las siguientes preguntas tratan sobre su nivel de funcionamiento en las actividades cotidianas. Indique el grado de dificultad que ha experimentado a causa de su rodilla.</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Actividad</th> <th>Ninguna</th>
                      <th>Leve</th>
                      <th>Moderada</th>
                      <th>Severa</th>
                      <th>Extrema</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>A1. Bajar escaleras</td>
                      <td class="text-center"><input type="radio" name="koos_a1" value="0" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_a1" value="1" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_a1" value="2" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_a1" value="3" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_a1" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                     <tr>
                       <td>A2. Subir escaleras</td>
                       <td class="text-center"><input type="radio" name="koos_a2" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a2" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a2" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a2" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a2" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A3. Levantarse de una silla</td>
                       <td class="text-center"><input type="radio" name="koos_a3" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a3" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a3" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a3" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a3" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A4. Permanecer de pie</td>
                       <td class="text-center"><input type="radio" name="koos_a4" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a4" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a4" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a4" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a4" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A5. Agacharse/recoger algo del suelo</td>
                       <td class="text-center"><input type="radio" name="koos_a5" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a5" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a5" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a5" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a5" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A6. Caminar sobre una superficie plana</td>
                       <td class="text-center"><input type="radio" name="koos_a6" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a6" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a6" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a6" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a6" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A7. Entrar/salir de un coche</td>
                       <td class="text-center"><input type="radio" name="koos_a7" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a7" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a7" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a7" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a7" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A8. Ir de compras</td>
                       <td class="text-center"><input type="radio" name="koos_a8" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a8" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a8" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a8" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a8" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A9. Ponerse los calcetines/medias</td>
                       <td class="text-center"><input type="radio" name="koos_a9" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a9" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a9" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a9" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a9" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A10. Levantarse de la cama</td>
                       <td class="text-center"><input type="radio" name="koos_a10" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a10" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a10" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a10" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a10" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A11. Quitarse los calcetines/medias</td>
                       <td class="text-center"><input type="radio" name="koos_a11" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a11" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a11" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a11" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a11" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A12. Tumbarse en la cama</td>
                       <td class="text-center"><input type="radio" name="koos_a12" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a12" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a12" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a12" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a12" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A13. Entrar/salir de la bañera</td>
                       <td class="text-center"><input type="radio" name="koos_a13" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a13" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a13" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a13" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a13" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A14. Sentarse</td>
                       <td class="text-center"><input type="radio" name="koos_a14" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a14" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a14" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a14" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a14" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A15. Sentarse/levantarse del inodoro</td>
                       <td class="text-center"><input type="radio" name="koos_a15" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a15" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a15" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a15" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a15" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A16. Realizar tareas domésticas pesadas (mover cajas pesadas, fregar suelos, etc.)</td>
                       <td class="text-center"><input type="radio" name="koos_a16" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a16" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a16" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a16" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a16" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>A17. Realizar tareas domésticas ligeras (cocinar, quitar el polvo, etc.)</td>
                       <td class="text-center"><input type="radio" name="koos_a17" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a17" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a17" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a17" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_a17" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">SP. DEPORTES Y ACTIVIDADES RECREATIVAS</h5>
              <p>Las siguientes preguntas se refieren a su capacidad física cuando realiza actividades más exigentes. Responda según su experiencia durante la última semana.</p>
              <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Actividad</th> <th>Ninguna</th>
                      <th>Leve</th>
                      <th>Moderada</th>
                      <th>Severa</th>
                      <th>Extrema</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>SP1. Ponerse en cuclillas</td>
                      <td class="text-center"><input type="radio" name="koos_sp1" value="0" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_sp1" value="1" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_sp1" value="2" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_sp1" value="3" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_sp1" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                     <tr>
                       <td>SP2. Correr</td>
                       <td class="text-center"><input type="radio" name="koos_sp2" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp2" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp2" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp2" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp2" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>SP3. Saltar</td>
                       <td class="text-center"><input type="radio" name="koos_sp3" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp3" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp3" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp3" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp3" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>SP4. Girar o pivotar sobre la rodilla afectada</td>
                       <td class="text-center"><input type="radio" name="koos_sp4" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp4" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp4" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp4" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp4" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>SP5. Arrodillarse</td>
                       <td class="text-center"><input type="radio" name="koos_sp5" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp5" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp5" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp5" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_sp5" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
              </div> <h5 class="mt-4 mb-3">Q. CALIDAD DE VIDA</h5>
               <div class="table-responsive"> <table class="table table-bordered mb-4">
                  <thead>
                    <tr>
                      <th style="width:50%;">Pregunta</th> <th>Nunca</th>
                      <th>Mensualmente</th>
                      <th>Semanalmente</th>
                      <th>Diariamente</th>
                      <th>Constantemente</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Q1. ¿Con qué frecuencia es consciente de su problema de rodilla?</td>
                      <td class="text-center"><input type="radio" name="koos_q1" value="0" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_q1" value="1" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_q1" value="2" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_q1" value="3" onchange="calcularKOOS()"></td>
                      <td class="text-center"><input type="radio" name="koos_q1" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <div class="table-responsive"> <table class="table table-bordered mb-4">
                   <thead>
                     <tr>
                       <th style="width:50%;">Pregunta</th> <th>Nada</th>
                       <th>Ligeramente</th>
                       <th>Moderadamente</th>
                       <th>Gravemente</th>
                       <th>Totalmente</th>
                     </tr>
                   </thead>
                   <tbody>
                     <tr>
                       <td>Q2. ¿Ha modificado su estilo de vida para evitar actividades que podrían dañar su rodilla?</td>
                       <td class="text-center"><input type="radio" name="koos_q2" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q2" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q2" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q2" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q2" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>Q3. ¿Cuánta preocupación siente por la falta de confianza en su rodilla?</td>
                       <td class="text-center"><input type="radio" name="koos_q3" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q3" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q3" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q3" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q3" value="4" onchange="calcularKOOS()"></td>
                     </tr>
                     <tr>
                       <td>Q4. En general, ¿cuánta dificultad le supone su rodilla?</td>
                       <td class="text-center"><input type="radio" name="koos_q4" value="0" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q4" value="1" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q4" value="2" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q4" value="3" onchange="calcularKOOS()"></td>
                       <td class="text-center"><input type="radio" name="koos_q4" value="4" onchange="calcularKOOS()"></td>
                    </tr>
                  </tbody>
                </table>
               </div> <div class="resultado-container" id="koos-resultado">
                <div class="row"> <div class="col-lg-4 col-md-12 mb-3 mb-lg-0"> <div class="resultado-label">Puntuación Total Promedio:</div>
                    <div class="resultado-valor" id="koos-valor-total">-%</div>
                    <div class="resultado-interpretacion" id="koos-interpretacion-total">Complete el cuestionario</div>
                  </div>
                   <div class="col-lg-8 col-md-12"> <div class="resultado-label">Subescalas (0-100%):</div>
                    <div class="row mb-2"> <div class="col-md-4"> <div class="resultado-sublabel">Dolor:</div>
                        <div class="resultado-valor" id="koos-valor-dolor">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Síntomas:</div>
                        <div class="resultado-valor" id="koos-valor-sintomas">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">AVD:</div>
                        <div class="resultado-valor" id="koos-valor-avd">-%</div>
                      </div>
                    </div>
                    <div class="row"> <div class="col-md-4"> <div class="resultado-sublabel">Deporte:</div>
                        <div class="resultado-valor" id="koos-valor-deporte">-%</div>
                      </div>
                      <div class="col-md-4"> <div class="resultado-sublabel">Calidad de vida:</div>
                        <div class="resultado-valor" id="koos-valor-qol">-%</div>
                      </div>
                       <div class="col-md-4"></div>
                    </div>
                  </div>
                </div>

                <div class="interpretacion-clinica-container mt-3">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="koos-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>

                <div class="recomendaciones-container mt-3">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="koos-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>

              <div class="text-center mt-3">
                  <button class="btn btn-success btn-sm" onclick="guardarCuestionarioComoPDF('koos-content', 'KOOS')">
                      <i class="fas fa-file-pdf"></i> Guardar KOOS como PDF
                  </button>
              </div>

            </div> </div> </div> </div> 
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        

            
<script>
        // ***** INICIO JAVASCRIPT ORIGINAL *****

        // Función para alternar la visibilidad de los cuestionarios
        function toggleCuestionario(contentId) {
          const content = document.getElementById(contentId);
          if (!content) {
            console.error('Elemento no encontrado:', contentId);
            return;
          }

          const header = content.previousElementSibling;
          if (content.style.display === "none" || !content.style.display) {
            content.style.display = "block";
            if (header) header.classList.add("active");
          } else {
            content.style.display = "none";
            if (header) header.classList.remove("active");
          }
        }

        // Función para calcular escala PSFS
        function calcularPSFS() {
          const puntuacion1Value = document.getElementById('psfs_puntuacion1')?.value; // Added safety check
          const puntuacion2Value = document.getElementById('psfs_puntuacion2')?.value; // Added safety check
          const puntuacion3Value = document.getElementById('psfs_puntuacion3')?.value; // Added safety check

          let valores = [];

          if (puntuacion1Value !== "" && puntuacion1Value !== null) valores.push(parseFloat(puntuacion1Value));
          if (puntuacion2Value !== "" && puntuacion2Value !== null) valores.push(parseFloat(puntuacion2Value));
          if (puntuacion3Value !== "" && puntuacion3Value !== null) valores.push(parseFloat(puntuacion3Value));

          // Actualizar badge
          const badge = document.getElementById('psfs-badge');
          if (badge) { // Added safety check
              if (valores.length > 0) {
                  badge.textContent = "Completado";
                  badge.classList.remove("no-completado"); // Ensure default class is removed
                  badge.classList.add("completado", "badge-verde");
              } else {
                  badge.textContent = "No completado";
                  badge.classList.remove("completado", "badge-verde");
                  badge.classList.add("no-completado");
              }
          }

          // Calcular promedio si hay valores
          const valorEl = document.getElementById('psfs-valor');
          const interpretacionEl = document.getElementById('psfs-interpretacion');

          if (valores.length > 0 && valorEl && interpretacionEl) { // Added safety checks
            const promedio = valores.reduce((a, b) => a + b, 0) / valores.length;
            const promedioRedondeado = promedio.toFixed(1);

            valorEl.textContent = promedioRedondeado;
            // Interpretación según el valor
            if (promedio < 3) {
              interpretacionEl.textContent = "Limitación severa de la función";
              interpretacionEl.className = "resultado-interpretacion rojo";
            } else if (promedio < 6) {
              interpretacionEl.textContent = "Limitación moderada de la función";
              interpretacionEl.className = "resultado-interpretacion amarillo";
            } else if (promedio < 8) {
              interpretacionEl.textContent = "Limitación leve de la función";
              interpretacionEl.className = "resultado-interpretacion verde-claro";
            } else {
              interpretacionEl.textContent = "Función normal o casi normal";
              interpretacionEl.className = "resultado-interpretacion verde";
            }
          } else if (valorEl && interpretacionEl) { // Reset if no values
              valorEl.textContent = "-";
              interpretacionEl.textContent = "Complete al menos una actividad para obtener un resultado";
              interpretacionEl.className = "resultado-interpretacion";
          }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular GROC
        function calcularGROC() {
          const checkedRadio = document.querySelector('input[name="groc"]:checked');
          const badge = document.getElementById('groc-badge');
          const valorEl = document.getElementById('groc-valor');
          const interpretacionEl = document.getElementById('groc-interpretacion');

          if (checkedRadio && badge && valorEl && interpretacionEl) { // Added safety checks
            const valorGROC = parseInt(checkedRadio.value);

            // Actualizar badge
            badge.textContent = "Completado";
            badge.classList.remove("no-completado");
            badge.classList.add("completado", "badge-verde");

            valorEl.textContent = valorGROC > 0 ? `+${valorGROC}`: `${valorGROC}`; // Add sign
            // Interpretación según el valor
            if (valorGROC <= -5) {
              interpretacionEl.textContent = "Cambio negativo importante (mucho peor)";
              interpretacionEl.className = "resultado-interpretacion rojo";
            } else if (valorGROC < 0) {
              interpretacionEl.textContent = "Cambio negativo (peor)";
              interpretacionEl.className = "resultado-interpretacion amarillo";
            } else if (valorGROC === 0) {
              interpretacionEl.textContent = "Sin cambios";
              interpretacionEl.className = "resultado-interpretacion"; // Default style
            } else if (valorGROC <= 3) {
              interpretacionEl.textContent = "Cambio positivo mínimo (un poco mejor)";
              interpretacionEl.className = "resultado-interpretacion verde-claro";
            } else if (valorGROC <= 5) {
              interpretacionEl.textContent = "Cambio positivo moderado (mejor)";
              interpretacionEl.className = "resultado-interpretacion verde";
            } else {
              interpretacionEl.textContent = "Cambio positivo importante (mucho mejor)";
              interpretacionEl.className = "resultado-interpretacion verde";
            }
          } else {
              // Reset if not checked or elements not found
              if (badge) {
                 badge.textContent = "No completado";
                 badge.classList.remove("completado", "badge-verde");
                 badge.classList.add("no-completado");
              }
              if (valorEl) valorEl.textContent = "-";
              if (interpretacionEl) {
                   interpretacionEl.textContent = "Seleccione una opción para obtener un resultado";
                   interpretacionEl.className = "resultado-interpretacion";
              }
          }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular SANE
        function calcularSANE() {
          const puntuacionInput = document.getElementById('sane_puntuacion');
          const puntuacionValueDisplay = document.getElementById('sane_puntuacion_value');
          const badge = document.getElementById('sane-badge');
          const valorEl = document.getElementById('sane-valor');
          const interpretacionEl = document.getElementById('sane-interpretacion');

           if (!puntuacionInput || !puntuacionValueDisplay || !badge || !valorEl || !interpretacionEl) {
                console.error("Faltan elementos para calcular SANE");
                return; // Exit if essential elements are missing
           }

          const puntuacion = puntuacionInput.value;
          // Actualizar el valor mostrado junto al slider
          puntuacionValueDisplay.textContent = puntuacion;

          // Actualizar badge (SANE siempre se considera 'completado' si la función se llama)
          badge.textContent = "Completado";
          badge.classList.remove("no-completado");
          badge.classList.add("completado", "badge-verde");

          valorEl.textContent = puntuacion + "%";
          // Interpretación según el valor
          if (puntuacion < 30) {
            interpretacionEl.textContent = "Función muy reducida";
            interpretacionEl.className = "resultado-interpretacion rojo";
          } else if (puntuacion < 50) {
            interpretacionEl.textContent = "Función deficiente";
            interpretacionEl.className = "resultado-interpretacion amarillo";
          } else if (puntuacion < 70) {
            interpretacionEl.textContent = "Función moderada";
            interpretacionEl.className = "resultado-interpretacion amarillo";
          } else if (puntuacion < 90) {
            interpretacionEl.textContent = "Buena función";
            interpretacionEl.className = "resultado-interpretacion verde-claro";
          } else {
            interpretacionEl.textContent = "Función normal o casi normal";
            interpretacionEl.className = "resultado-interpretacion verde";
          }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función auxiliar para identificar las áreas más afectadas en BPI
        function getAreasAfectadas(areas) {
          // Filtrar áreas con valor ≥ 5 (afectación moderada-alta)
          const areasAfectadas = areas.filter(area => area.valor >= 5)
                                      .sort((a, b) => b.valor - a.valor) // Ordenar por valor descendente
                                      .map(area => area.area);

          if (areasAfectadas.length === 0) {
            return "ningún área en particular";
          } else if (areasAfectadas.length === 1) {
            return `principalmente ${areasAfectadas[0]}`;
          } else if (areasAfectadas.length === 2) {
            return `principalmente ${areasAfectadas[0]} y ${areasAfectadas[1]}`;
          } else {
            const ultimaArea = areasAfectadas.pop();
            return `principalmente ${areasAfectadas.join(', ')} y ${ultimaArea}`;
          }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // Función para calcular resultados del Inventario Breve de Dolor (BPI)
        function calcularBPI() {
            // Get all required elements safely
            const dolorActualEl = document.getElementById('bpi_dolor_actual');
            const dolorPromedioEl = document.getElementById('bpi_dolor_promedio');
            const dolorPeorEl = document.getElementById('bpi_dolor_peor');
            const dolorMenorEl = document.getElementById('bpi_dolor_menor');
            const interfActividadEl = document.getElementById('bpi_interferencia_actividad');
            const interfAnimoEl = document.getElementById('bpi_interferencia_animo');
            const interfCaminarEl = document.getElementById('bpi_interferencia_caminar');
            const interfTrabajoEl = document.getElementById('bpi_interferencia_trabajo');
            const interfRelacionesEl = document.getElementById('bpi_interferencia_relaciones');
            const interfSuenoEl = document.getElementById('bpi_interferencia_sueno');
            const interfVidaEl = document.getElementById('bpi_interferencia_vida');

            const intensidadValorEl = document.getElementById('bpi-intensidad-valor');
            const interferenciaValorEl = document.getElementById('bpi-interferencia-valor');
            const intensidadInterpretacionEl = document.getElementById('bpi-intensidad-interpretacion');
            const interferenciaInterpretacionEl = document.getElementById('bpi-interferencia-interpretacion');
            const interpretacionClinicaEl = document.getElementById('bpi-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('bpi-recomendaciones');
            const bpiBadge = document.getElementById('bpi-badge');
            const resultadoContainer = document.getElementById('bpi-resultado');

            // Exit if any essential element is missing
            if (!dolorActualEl || !dolorPromedioEl || !dolorPeorEl || !dolorMenorEl ||
                !interfActividadEl || !interfAnimoEl || !interfCaminarEl || !interfTrabajoEl ||
                !interfRelacionesEl || !interfSuenoEl || !interfVidaEl || !intensidadValorEl ||
                !interferenciaValorEl || !intensidadInterpretacionEl || !interferenciaInterpretacionEl ||
                !interpretacionClinicaEl || !recomendacionesEl || !bpiBadge || !resultadoContainer) {
                console.error("Faltan elementos esenciales para calcular BPI.");
                return;
            }

            // Recoger valores de intensidad del dolor
            const dolorActual = parseInt(dolorActualEl.value) || 0;
            const dolorPromedio = parseInt(dolorPromedioEl.value) || 0;
            const dolorPeor = parseInt(dolorPeorEl.value) || 0;
            const dolorMenor = parseInt(dolorMenorEl.value) || 0;

            // Recoger valores de interferencia
            const interferencia_actividad = parseInt(interfActividadEl.value) || 0;
            const interferencia_animo = parseInt(interfAnimoEl.value) || 0;
            const interferencia_caminar = parseInt(interfCaminarEl.value) || 0;
            const interferencia_trabajo = parseInt(interfTrabajoEl.value) || 0;
            const interferencia_relaciones = parseInt(interfRelacionesEl.value) || 0;
            const interferencia_sueno = parseInt(interfSuenoEl.value) || 0;
            const interferencia_vida = parseInt(interfVidaEl.value) || 0;

            // Calcular promedios
            const intensidadTotal = (dolorActual + dolorPromedio + dolorPeor + dolorMenor);
            const numIntensidad = 4; // Always 4 items
            const intensidadRedondeada = (intensidadTotal / numIntensidad).toFixed(1);

            const totalInterferencias = interferencia_actividad + interferencia_animo + interferencia_caminar +
                                      interferencia_trabajo + interferencia_relaciones + interferencia_sueno +
                                      interferencia_vida;
            const numInterferencias = 7; // Always 7 items
            const interferenciaRedondeada = (totalInterferencias / numInterferencias).toFixed(1);

            // Mostrar resultados
            intensidadValorEl.textContent = intensidadRedondeada + '/10';
            interferenciaValorEl.textContent = interferenciaRedondeada + '/10';

            // Interpretación de la intensidad del dolor
            let intensidadInterpretacion = '';
            let intensidadColor = '';
            if (intensidadRedondeada < 1) {
                intensidadInterpretacion = 'Sin dolor'; intensidadColor = 'verde';
            } else if (intensidadRedondeada < 4) {
                intensidadInterpretacion = 'Dolor leve'; intensidadColor = 'verde-claro';
            } else if (intensidadRedondeada < 7) {
                intensidadInterpretacion = 'Dolor moderado'; intensidadColor = 'amarillo';
            } else {
                intensidadInterpretacion = 'Dolor severo'; intensidadColor = 'rojo';
            }
            intensidadInterpretacionEl.textContent = intensidadInterpretacion;
            intensidadInterpretacionEl.className = 'resultado-interpretacion ' + intensidadColor;


            // Interpretación de la interferencia
            let interferenciaInterpretacion = '';
            let interferenciaColor = '';
            if (interferenciaRedondeada < 1) {
                interferenciaInterpretacion = 'Sin interferencia'; interferenciaColor = 'verde';
            } else if (interferenciaRedondeada < 4) {
                interferenciaInterpretacion = 'Interferencia leve'; interferenciaColor = 'verde-claro';
            } else if (interferenciaRedondeada < 7) {
                interferenciaInterpretacion = 'Interferencia moderada'; interferenciaColor = 'amarillo';
            } else {
                interferenciaInterpretacion = 'Interferencia severa'; interferenciaColor = 'rojo';
            }
            interferenciaInterpretacionEl.textContent = interferenciaInterpretacion;
            interferenciaInterpretacionEl.className = 'resultado-interpretacion ' + interferenciaColor;

            // Nivel de gravedad general
            let nivelGravedad = '';
            if (intensidadRedondeada >= 7 || interferenciaRedondeada >= 7) {
                nivelGravedad = 'severo';
                resultadoContainer.className = 'resultado-container nivel-severo';
            } else if (intensidadRedondeada >= 4 || interferenciaRedondeada >= 4) {
                nivelGravedad = 'moderado';
                resultadoContainer.className = 'resultado-container nivel-moderado';
            } else {
                nivelGravedad = 'leve';
                resultadoContainer.className = 'resultado-container nivel-leve';
            }

            // Actualizar el badge (BPI se considera completo si se llama la función, ya que los sliders tienen valor inicial)
             bpiBadge.textContent = 'Completado';
             bpiBadge.classList.remove('no-completado');
             bpiBadge.classList.add('completado', 'badge-verde');


            // Actualizar interpretación clínica
             interpretacionClinicaEl.innerHTML = `
                <p>El paciente presenta un dolor de intensidad <strong>${intensidadInterpretacion.toLowerCase()}</strong>
                (${intensidadRedondeada}/10) con una interferencia <strong>${interferenciaInterpretacion.toLowerCase()}</strong>
                (${interferenciaRedondeada}/10) en sus actividades diarias.</p>
                <p>Este patrón sugiere un impacto <strong>${nivelGravedad}</strong> del dolor en la calidad de vida
                del paciente, afectando principalmente ${getAreasAfectadas([
                  { area: 'actividad general', valor: interferencia_actividad },
                  { area: 'estado de ánimo', valor: interferencia_animo },
                  { area: 'capacidad para caminar', valor: interferencia_caminar },
                  { area: 'trabajo habitual', valor: interferencia_trabajo },
                  { area: 'relaciones sociales', valor: interferencia_relaciones },
                  { area: 'sueño', valor: interferencia_sueno },
                  { area: 'disfrute de la vida', valor: interferencia_vida }
                ])}.</p>
              `;

            // Actualizar recomendaciones terapéuticas
            if (nivelGravedad === 'severo') {
                recomendacionesEl.innerHTML = `
                  <p>Considerar un enfoque multidisciplinar que incluya:</p>
                  <ul>
                    <li>Evaluación por especialista en dolor para posible ajuste farmacológico</li>
                    <li>Combinar terapia manual con modalidades analgésicas</li>
                    <li>Educación en neurociencia del dolor y estrategias de afrontamiento</li>
                    <li>Programa de ejercicios graduados con progresión cuidadosa</li>
                    <li>Valorar impacto psicológico y posible derivación a psicología</li>
                    <li>Seguimiento frecuente para ajustar intervenciones según respuesta</li>
                  </ul>
                `;
            } else if (nivelGravedad === 'moderado') {
                recomendacionesEl.innerHTML = `
                  <p>Se recomienda:</p>
                  <ul>
                    <li>Combinar terapia manual y ejercicio terapéutico</li>
                    <li>Educación sobre manejo del dolor y pacing de actividades</li>
                    <li>Implementar estrategias de autorregulación (respiración, relajación)</li>
                    <li>Programa de ejercicios para mejorar la funcionalidad</li>
                    <li>Revisar impacto en actividades diarias y plantear modificaciones</li>
                    <li>Seguimiento para evaluar evolución</li>
                  </ul>
                `;
            } else { // Leve
                recomendacionesEl.innerHTML = `
                  <p>Se sugiere:</p>
                  <ul>
                    <li>Terapia manual enfocada en zonas específicas de dolor</li>
                    <li>Programa de ejercicios para mantener y mejorar funcionalidad</li>
                    <li>Educación sobre factores moduladores del dolor</li>
                    <li>Estrategias de autocuidado y manejo de síntomas</li>
                    <li>Fomentar retorno gradual a actividades normales</li>
                  </ul>
                `;
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // ***** FIN JAVASCRIPT PARTE 1 *****

    // ***** INICIO JAVASCRIPT PARTE 2 *****

        // --- Funciones Auxiliares PCS ---
        function getDescripcionCatastrofizacion(nivel) {
          switch(nivel) {
            case "Bajo": return "una tendencia mínima a tener pensamientos negativos exagerados en relación con la experiencia del dolor";
            case "Moderado": return "cierta tendencia a amplificar las amenazas del dolor, con pensamientos y sentimientos negativos recurrentes";
            case "Alto": return "una fuerte tendencia a amplificar las amenazas del dolor, con pensamientos y sentimientos negativos muy marcados, lo que puede interferir significativamente con la recuperación";
            default: return "";
          }
        }
        function getDescripcionRumiacion(puntaje) {
          if (puntaje <= 5) return "Baja tendencia a centrarse excesivamente en pensamientos dolorosos";
          else if (puntaje <= 10) return "Moderada tendencia a centrarse repetitivamente en pensamientos relacionados con el dolor";
          else return "Alta tendencia a la rumiación, con dificultad para apartar los pensamientos sobre el dolor";
        }
        function getDescripcionMagnificacion(puntaje) {
          if (puntaje <= 3) return "Baja tendencia a exagerar las amenazas del dolor";
          else if (puntaje <= 7) return "Moderada tendencia a exagerar las amenazas y preocuparse por consecuencias negativas";
          else return "Alta tendencia a magnificar la gravedad del dolor y sus posibles consecuencias";
        }
        function getDescripcionDesesperanza(puntaje) {
          if (puntaje <= 8) return "Baja sensación de no poder hacer frente al dolor";
          else if (puntaje <= 16) return "Moderado sentimiento de impotencia y dificultad para manejar el dolor";
          else return "Alta sensación de impotencia y desesperanza ante la situación dolorosa";
        }
        // --- Fin Funciones Auxiliares PCS ---

        // Función para calcular la Escala de Catastrofización ante el Dolor (PCS)
        function calcularPCS() {
            let valoresItems = [];
            let completo = true;
            let itemsRespondidos = 0;

            for (let i = 1; i <= 13; i++) {
                const itemValue = document.querySelector(`input[name="pcs_item${i}"]:checked`)?.value;
                if (itemValue !== undefined) {
                    valoresItems.push(parseInt(itemValue));
                    itemsRespondidos++;
                } else {
                    valoresItems.push(0); // Assume 0 if not answered for calculation, but mark as incomplete
                    completo = false;
                }
            }

            // El cuestionario PCS requiere que TODOS los 13 ítems estén respondidos
            completo = itemsRespondidos === 13;

            const puntuacionTotal = valoresItems.reduce((sum, val) => sum + val, 0);
            // Rumiación: ítems 8, 9, 10, 11 (índices 7, 8, 9, 10)
            const rumiacion = valoresItems[7] + valoresItems[8] + valoresItems[9] + valoresItems[10];
            // Magnificación: ítems 6, 7, 13 (índices 5, 6, 12)
            const magnificacion = valoresItems[5] + valoresItems[6] + valoresItems[12];
            // Desesperanza: ítems 1, 2, 3, 4, 5, 12 (índices 0, 1, 2, 3, 4, 11) -> Correction: items 1-5, 12
             const desesperanza = valoresItems[0] + valoresItems[1] + valoresItems[2] + valoresItems[3] + valoresItems[4] + valoresItems[11]; // Corrected indices for Desesperanza based on common PCS structure (Needs verification with source)

            // Update UI Elements safely
            const badge = document.getElementById('pcs-badge');
            const valorTotalEl = document.getElementById('pcs-valor-total');
            const valorRumiacionEl = document.getElementById('pcs-valor-rumiacion');
            const valorMagnificacionEl = document.getElementById('pcs-valor-magnificacion');
            const valorDesesperanzaEl = document.getElementById('pcs-valor-desesperanza');
            const interpretacionTotalEl = document.getElementById('pcs-interpretacion-total');
            const resultadoContainer = document.getElementById('pcs-resultado');
            const interpretacionClinicaEl = document.getElementById('pcs-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('pcs-recomendaciones');

            if (badge) {
                if (completo) {
                    badge.textContent = "Completado";
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde");
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

             if(valorTotalEl) valorTotalEl.textContent = `${puntuacionTotal}/52`;
             if(valorRumiacionEl) valorRumiacionEl.textContent = `${rumiacion}/16`;
             if(valorMagnificacionEl) valorMagnificacionEl.textContent = `${magnificacion}/12`;
             if(valorDesesperanzaEl) valorDesesperanzaEl.textContent = `${desesperanza}/24`;


            if (completo && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let nivelCatastrofizacion = "";
                let colorClass = "";
                if (puntuacionTotal >= 30) { // Punto de corte común para clínicamente significativo
                    nivelCatastrofizacion = "Alto";
                    interpretacionTotalEl.textContent = "Nivel alto de catastrofización (≥30)";
                    interpretacionTotalEl.className = "resultado-interpretacion rojo";
                    resultadoContainer.className = "resultado-container nivel-severo";
                    colorClass="alto";
                } else if (puntuacionTotal >= 20) {
                     nivelCatastrofizacion = "Moderado";
                     interpretacionTotalEl.textContent = "Nivel moderado de catastrofización (20-29)";
                     interpretacionTotalEl.className = "resultado-interpretacion amarillo";
                     resultadoContainer.className = "resultado-container nivel-moderado";
                      colorClass="moderado";
                }
                 else {
                    nivelCatastrofizacion = "Bajo";
                    interpretacionTotalEl.textContent = "Nivel bajo de catastrofización (<20)";
                    interpretacionTotalEl.className = "resultado-interpretacion verde";
                    resultadoContainer.className = "resultado-container nivel-leve";
                     colorClass="bajo";
                }
                 if(badge) badge.className = `resultado-badge completado ${colorClass}`;


                interpretacionClinicaEl.innerHTML = `
                    <p>El paciente presenta un nivel <strong>${nivelCatastrofizacion.toLowerCase()}</strong> de catastrofización ante el dolor (${puntuacionTotal}/52), lo que indica ${getDescripcionCatastrofizacion(nivelCatastrofizacion)}.</p>
                    <p>Análisis de subescalas:</p>
                    <ul>
                        <li><strong>Rumiación</strong> (${rumiacion}/16): ${getDescripcionRumiacion(rumiacion)}</li>
                        <li><strong>Magnificación</strong> (${magnificacion}/12): ${getDescripcionMagnificacion(magnificacion)}</li>
                        <li><strong>Desesperanza</strong> (${desesperanza}/24): ${getDescripcionDesesperanza(desesperanza)}</li>
                    </ul>
                    <p>La catastrofización ante el dolor es un factor psicológico que puede influir negativamente en la experiencia del dolor, la respuesta al tratamiento y la recuperación funcional.</p>
                    `;

                if (nivelCatastrofizacion === "Bajo") {
                    recomendacionesEl.innerHTML = `
                        <p>Con un nivel bajo de catastrofización, se recomienda:</p>
                        <ul>
                            <li>Mantener la educación sobre el dolor y reforzar conceptos que desmitifiquen creencias erróneas (nivel de evidencia 1A)</li>
                            <li>Enfoque principal en terapia física activa y ejercicio terapéutico (nivel de evidencia 1A)</li>
                            <li>Proporcionar retroalimentación positiva sobre los avances y capacidades (nivel de evidencia 1B)</li>
                            <li>Fomentar estrategias de afrontamiento activas (nivel de evidencia 1B)</li>
                            <li>Monitorizar periódicamente para detectar posibles cambios en la catastrofización (nivel de evidencia 2A)</li>
                        </ul>`;
                } else if (nivelCatastrofizacion === "Moderado") {
                     recomendacionesEl.innerHTML = `
                        <p>Con un nivel moderado de catastrofización, se recomienda:</p>
                        <ul>
                            <li>Implementar educación en neurociencia del dolor para modificar creencias maladaptativas (nivel de evidencia 1A)</li>
                            <li>Técnicas de reestructuración cognitiva para identificar y desafiar pensamientos catastróficos (nivel de evidencia 1A)</li>
                            <li>Entrenamiento en atención plena (mindfulness) para reducir la rumiación (nivel de evidencia 1B)</li>
                            <li>Ejercicio terapéutico graduado con énfasis en la autoeficacia (nivel de evidencia 1A)</li>
                            <li>Estrategias de exposición gradual a actividades evitadas (nivel de evidencia 1B)</li>
                            <li>Considerar abordaje interdisciplinar si no hay mejoría (nivel de evidencia 1A)</li>
                        </ul>`;
                } else { // Alto
                     recomendacionesEl.innerHTML = `
                        <p>Con un nivel alto de catastrofizacion (≥30), considerado clínicamente significativo, se recomienda:</p>
                        <ul>
                            <li>Abordaje interdisciplinar que incluya psicología clínica (nivel de evidencia 1A)</li>
                            <li>Educación intensiva en neurociencia del dolor (nivel de evidencia 1A)</li>
                            <li>Terapia cognitivo-conductual estructurada para el manejo del dolor (nivel de evidencia 1A)</li>
                            <li>Técnicas específicas para reducir la rumiación y la desesperanza (nivel de evidencia 1B)</li>
                            <li>Ejercicio terapéutico con exposición gradual muy controlada (nivel de evidencia 1A)</li>
                            <li>Entrenamiento en habilidades específicas de regulación emocional (nivel de evidencia 1B)</li>
                            <li>Establecer objetivos funcionales a corto plazo muy concretos y alcanzables (nivel de evidencia 1A)</li>
                            <li>Seguimiento cercano y reevaluación frecuente (nivel de evidencia 1B)</li>
                        </ul>`;
                }

            } else {
                // Reset if incomplete or elements missing
                if (interpretacionTotalEl) {
                    interpretacionTotalEl.textContent = "Complete el cuestionario";
                    interpretacionTotalEl.className = "resultado-interpretacion";
                }
                 if (resultadoContainer) resultadoContainer.className = "resultado-container";
                 if (interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if (recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado"; // Ensure badge resets

            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // --- Funciones Auxiliares CSI ---
        function getDescripcionSC(nivel) {
          switch(nivel) {
            case "Subclínico": return "una presencia mínima de síntomas asociados con la sensibilización del sistema nervioso central";
            case "Leve": return "una presencia leve de síntomas relacionados con la sensibilización central, que podrían estar comenzando a afectar la vida diaria";
            case "Moderado": return "una clara evidencia de sensibilización central que probablemente esté contribuyendo significativamente a la condición del paciente y afectando su funcionalidad (Punto de corte ≥40)";
            case "Severo": return "un alto grado de sensibilización central que probablemente sea un factor determinante en la condición del paciente, con impacto sustancial en múltiples áreas de la vida";
            case "Extremo": return "un grado extremo de sensibilización central con manifestaciones generalizadas y profundo impacto en la calidad de vida y funcionalidad";
            default: return "";
          }
        }
        function obtenerDiagnosticosTexto(diagnosticos) {
          const nombresdiagnosticos = [
            "fibromialgia", "síndrome de fatiga crónica", "trastorno temporomandibular",
            "migrañas o cefaleas tensionales", "síndrome de intestino irritable",
            "reflujo o dolor torácico no cardíaco", "vejiga irritable o cistitis intersticial",
            "sensibilidad a químicos/medicamentos", "lesión de cuello (incluyendo latigazo)",
            "ansiedad o ataques de pánico"
          ];
          const seleccionados = diagnosticos.map((seleccionado, index) => seleccionado ? nombresdiagnosticos[index] : null).filter(Boolean);

          if (seleccionados.length === 0) return "ninguno";
          if (seleccionados.length === 1) return seleccionados[0];

          const ultimoDiagnostico = seleccionados.pop();
          return `${seleccionados.join(', ')} y ${ultimoDiagnostico}`;
        }
        // --- Fin Funciones Auxiliares CSI ---

        // Función para calcular el Inventario de Sensibilización Central (CSI)
        function calcularCSI() {
            let valoresItems = [];
            let itemsCompletados = 0;

            for (let i = 1; i <= 25; i++) {
                const itemValue = document.querySelector(`input[name="csi_item${i}"]:checked`)?.value;
                if (itemValue !== undefined) {
                    valoresItems.push(parseInt(itemValue));
                    itemsCompletados++;
                } else {
                    valoresItems.push(0); // Assume 0 if not answered for calculation
                }
            }

            // El CSI se considera completo si al menos 23/25 (aprox 90%) preguntas están respondidas
            const completo = itemsCompletados >= 23;
            const puntuacionA = valoresItems.reduce((sum, val) => sum + val, 0);

            const diagnosticos = [
                document.getElementById('csi_fibromialgia')?.checked, document.getElementById('csi_sindrome_fatiga')?.checked,
                document.getElementById('csi_tmd')?.checked, document.getElementById('csi_migranas')?.checked,
                document.getElementById('csi_sii')?.checked, document.getElementById('csi_reflujo')?.checked,
                document.getElementById('csi_vejiga')?.checked, document.getElementById('csi_quimico')?.checked,
                document.getElementById('csi_lesion_cuello')?.checked, document.getElementById('csi_ansiedad')?.checked
            ];
            const numeroDiagnosticos = diagnosticos.filter(Boolean).length;

            // Update UI Elements safely
            const badge = document.getElementById('csi-badge');
            const valorAEl = document.getElementById('csi-valor-a');
            const valorBEl = document.getElementById('csi-valor-b');
            const interpretacionAEl = document.getElementById('csi-interpretacion-a');
            const interpretacionBEl = document.getElementById('csi-interpretacion-b');
            const resultadoContainer = document.getElementById('csi-resultado');
            const interpretacionClinicaEl = document.getElementById('csi-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('csi-recomendaciones');

            if (badge) {
                if (completo) {
                    badge.textContent = "Completado";
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde");
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

             if(valorAEl) valorAEl.textContent = `${puntuacionA}/100`;
             if(valorBEl) valorBEl.textContent = `${numeroDiagnosticos}/10`;

            if (completo && interpretacionAEl && interpretacionBEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                 let nivelSC = "";
                 let colorClass = "";
                if (puntuacionA < 30) { nivelSC = "Subclínico"; colorClass="leve"; interpretacionAEl.textContent = "Sensibilización central subclínica"; interpretacionAEl.className = "resultado-interpretacion verde"; }
                else if (puntuacionA < 40) { nivelSC = "Leve"; colorClass="leve"; interpretacionAEl.textContent = "Sensibilización central leve"; interpretacionAEl.className = "resultado-interpretacion verde-claro"; }
                else if (puntuacionA < 50) { nivelSC = "Moderado"; colorClass="moderado"; interpretacionAEl.textContent = "Sensibilización central moderada (≥40)"; interpretacionAEl.className = "resultado-interpretacion amarillo"; }
                else if (puntuacionA < 60) { nivelSC = "Severo"; colorClass="severo"; interpretacionAEl.textContent = "Sensibilización central severa"; interpretacionAEl.className = "resultado-interpretacion rojo"; }
                else { nivelSC = "Extremo"; colorClass="severo"; interpretacionAEl.textContent = "Sensibilización central extrema"; interpretacionAEl.className = "resultado-interpretacion rojo"; }
                resultadoContainer.className = `resultado-container nivel-${colorClass}`;

                if (numeroDiagnosticos === 0) interpretacionBEl.textContent = "Sin diagnósticos relacionados";
                else if (numeroDiagnosticos === 1) interpretacionBEl.textContent = "1 diagnóstico relacionado";
                else interpretacionBEl.textContent = `${numeroDiagnosticos} diagnósticos relacionados`;

                const diagnosticosTexto = obtenerDiagnosticosTexto(diagnosticos);
                interpretacionClinicaEl.innerHTML = `
                    <p>El paciente presenta un nivel <strong>${nivelSC.toLowerCase()}</strong> de sensibilización central (Parte A: ${puntuacionA}/100), lo que sugiere ${getDescripcionSC(nivelSC)}.</p>
                    ${numeroDiagnosticos > 0 ?
                    `
                    <p>Además, refiere ${numeroDiagnosticos} ${numeroDiagnosticos === 1 ? 'diagnóstico previo relacionado' : 'diagnósticos previos relacionados'} con síndromes de sensibilización central: ${diagnosticosTexto}.</p>
                    <p>La presencia de estos diagnósticos ${numeroDiagnosticos > 2 ? 'múltiples ' : ''}aumenta la probabilidad de que los mecanismos de sensibilización central estén contribuyendo a la presentación clínica actual.</p>
                    ` : '<p>No se reportan diagnósticos previos relacionados con síndromes de sensibilización central.</p>'}
                    <p>La sensibilización central implica una amplificación de la señalización neural dentro del sistema nervioso central que provoca hipersensibilidad al dolor y procesamiento sensorial alterado.</p>`;

                 // Recomendaciones (similar a como estaban antes)
                  if (nivelSC === "Subclínico" || nivelSC === "Leve") {
                    recomendacionesEl.innerHTML = `
                        <p>Con un nivel ${nivelSC.toLowerCase()} de sensibilización central, se recomienda:</p>
                        <ul>
                          <li>Educación en neurociencia del dolor para entender los mecanismos de sensibilización (nivel de evidencia 1A)</li>
                          <li>Ejercicio terapéutico de intensidad moderada, priorizando actividades no provocadoras de dolor (nivel de evidencia 1A)</li>
                          <li>Técnicas de desensibilización gradual para normalizar el procesamiento sensorial (nivel de evidencia 1B)</li>
                          <li>Terapia manual no agresiva con enfoque en reducir la hiperalgesia (nivel de evidencia 1B)</li>
                          <li>Estrategias de autorregulación como respiración diafragmática y relajación muscular progresiva (nivel de evidencia 1B)</li>
                          <li>Monitorización regular de los síntomas para detectar cambios (nivel de evidencia 2A)</li>
                        </ul>`;
                 } else if (nivelSC === "Moderado") { // ≥ 40 es clínicamente relevante
                     recomendacionesEl.innerHTML = `
                        <p>Con un nivel moderado de sensibilización central (≥40), se recomienda:</p>
                        <ul>
                          <li>Programa estructurado de educación en neurociencia del dolor (nivel de evidencia 1A)</li>
                          <li>Ejercicio terapéutico progresivo con exposición gradual, priorizando actividades aeróbicas de baja intensidad (nivel de evidencia 1A)</li>
                          <li>Técnicas de extinción del miedo al movimiento (nivel de evidencia 1B)</li>
                          <li>Desensibilización sistemática para hipersensibilidad sensorial (nivel de evidencia 1B)</li>
                          <li>Entrenamiento en mindfulness para reducir hipervigilancia (nivel de evidencia 1B)</li>
                          <li>Abordaje de factores contextuales (sueño, estrés, patrones de actividad) que pueden perpetuar la sensibilización (nivel de evidencia 1A)</li>
                          <li>Considerar derivación a especialista en dolor si no hay mejoría en 4-6 semanas (nivel de evidencia 2A)</li>
                        </ul>`;
                 } else { // Severo o Extremo
                     recomendacionesEl.innerHTML = `
                        <p>Con un nivel ${nivelSC.toLowerCase()} de sensibilización central, se recomienda:</p>
                        <ul>
                          <li>Abordaje interdisciplinar con participación de especialista en dolor (nivel de evidencia 1A)</li>
                          <li>Programa intensivo de educación en neurociencia del dolor (nivel de evidencia 1A)</li>
                          <li>Exposición gradual muy cuidadosa a estímulos que provocan dolor, monitorizando respuestas (nivel de evidencia 1A)</li>
                          <li>Terapia de aceptación y compromiso para reducir el impacto de la hipersensibilidad (nivel de evidencia 1A)</li>
                          <li>Programa de actividad física individualizado con progresión muy gradual (nivel de evidencia 1A)</li>
                          <li>Técnicas específicas para regular el sistema nervioso autónomo (nivel de evidencia 1B)</li>
                          <li>Estrategias de gestión del sueño (nivel de evidencia 1A)</li>
                          <li>Intervenciones para reducir el estrés y la ansiedad (nivel de evidencia 1A)</li>
                          <li>Plan de tratamiento a largo plazo con objetivos funcionales realistas (nivel de evidencia 1A)</li>
                          <li>Considerar derivación para evaluación de tratamiento farmacológico dirigido a mecanismos de sensibilización central (nivel de evidencia 1A)</li>
                        </ul>`;
                 }

            } else {
                // Reset if incomplete or elements missing
                 if(interpretacionAEl) interpretacionAEl.textContent = "Complete el cuestionario";
                 if(interpretacionBEl) interpretacionBEl.textContent = "Complete el cuestionario";
                 if(interpretacionAEl) interpretacionAEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // --- Funciones Auxiliares TSK ---
        function getDescripcionKinesiofobia(nivel) {
          switch(nivel) {
            case "Mínima": return "un bajo temor al movimiento y buena confianza en la capacidad de su cuerpo para tolerar la actividad física";
            case "Moderada": return "cierto grado de temor al movimiento que podría estar limitando su participación en algunas actividades físicas";
            case "Severa": return "un alto grado de temor al movimiento que probablemente está limitando significativamente su recuperación funcional y participación en actividades físicas";
            default: return "";
          }
        }
        function getPensamientosKinesiofobia(nivel) {
          switch(nivel) {
            case "Mínima": return "generalmente no asocia el movimiento con daño o peligro, lo que favorece una buena adherencia al ejercicio terapéutico";
            case "Moderada": return "presenta algunas creencias de que ciertos movimientos podrían ser perjudiciales, lo que podría estar interfiriendo con su recuperación óptima";
            case "Severa": return "tiene fuertes creencias de que el movimiento y la actividad física pueden causar daño o reinjuria, lo que está obstaculizando significativamente su progreso";
            default: return "";
          }
        }
        // --- Fin Funciones Auxiliares TSK ---

        // Función para calcular la Escala de Tampa de Kinesiofobia (TSK-11)
        function calcularTSK() {
            let valoresItems = [];
            let completo = true;
            let itemsRespondidos = 0;

            for (let i = 1; i <= 11; i++) {
                const itemValue = document.querySelector(`input[name="tsk_item${i}"]:checked`)?.value;
                if (itemValue !== undefined) {
                    valoresItems.push(parseInt(itemValue));
                     itemsRespondidos++;
                } else {
                    valoresItems.push(0); // Assume 0 if not answered
                    completo = false;
                }
            }

            // TSK-11 requiere que TODOS los 11 ítems estén respondidos
            completo = itemsRespondidos === 11;

            const puntuacionTotal = valoresItems.reduce((sum, val) => sum + val, 0);

            // Update UI elements safely
            const badge = document.getElementById('tsk-badge');
            const valorEl = document.getElementById('tsk-valor');
            const interpretacionEl = document.getElementById('tsk-interpretacion');
            const resultadoContainer = document.getElementById('tsk-resultado');
            const interpretacionClinicaEl = document.getElementById('tsk-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('tsk-recomendaciones');

            if (badge) {
                if (completo) {
                    badge.textContent = "Completado";
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde");
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

             if(valorEl) valorEl.textContent = `${puntuacionTotal}/44`;

            if (completo && interpretacionEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                 let nivelKinesiofobia = "";
                 let colorClass = "";
                 // Cut-offs may vary, using common ones (e.g., >37 often high, but TSK-11 might differ)
                 // Let's use terciles approximately: 11-22 (Low), 23-33 (Moderate), 34-44 (High)
                 // Adjusting based on previous logic: <17 Min, 17-27 Mod, >27 Sev
                 if (puntuacionTotal > 27) { // Previous logic used >27 Severa
                     nivelKinesiofobia = "Severa";
                     interpretacionEl.textContent = "Nivel severo de kinesiofobia (>27)";
                     interpretacionEl.className = "resultado-interpretacion rojo";
                     resultadoContainer.className = "resultado-container nivel-severo";
                     colorClass="alto";
                 } else if (puntuacionTotal >= 17) { // Previous logic used <=27 Moderada
                     nivelKinesiofobia = "Moderada";
                     interpretacionEl.textContent = "Nivel moderado de kinesiofobia (17-27)";
                     interpretacionEl.className = "resultado-interpretacion amarillo";
                     resultadoContainer.className = "resultado-container nivel-moderado";
                     colorClass="moderado";
                 } else { // < 17
                     nivelKinesiofobia = "Mínima";
                     interpretacionEl.textContent = "Nivel mínimo de kinesiofobia (<17)";
                     interpretacionEl.className = "resultado-interpretacion verde";
                     resultadoContainer.className = "resultado-container nivel-leve";
                     colorClass="bajo";
                 }
                  if(badge) badge.className = `resultado-badge completado ${colorClass}`;


                 interpretacionClinicaEl.innerHTML = `
                    <p>El paciente presenta un nivel de kinesiofobia <strong>${nivelKinesiofobia.toLowerCase()}</strong> (${puntuacionTotal}/44), lo que indica ${getDescripcionKinesiofobia(nivelKinesiofobia)}.</p>
                    <p>La kinesiofobia, o miedo al movimiento, puede influir negativamente en la recuperación funcional al limitar la participación en actividades físicas y ejercicios terapéuticos.</p>
                    <p>Este resultado sugiere que el paciente ${getPensamientosKinesiofobia(nivelKinesiofobia)}.</p>
                    `;

                 if (nivelKinesiofobia === "Mínima") {
                     recomendacionesEl.innerHTML = `
                        <p>Con un nivel mínimo de kinesiofobia, se recomienda:</p>
                        <ul>
                            <li>Reforzar positivamente la confianza actual en el movimiento (nivel de evidencia 1A)</li>
                            <li>Educación preventiva básica sobre conceptos erróneos del dolor (nivel de evidencia 1A)</li>
                            <li>Prescripción de ejercicio terapéutico regular, enfatizando la progresión gradual (nivel de evidencia 1A)</li>
                            <li>Fomentar la autogestión y participación activa en actividades funcionales (nivel de evidencia 1A)</li>
                            <li>Monitorizar periódicamente para detectar cambios en las creencias sobre el movimiento (nivel de evidencia 2B)</li>
                        </ul>`;
                 } else if (nivelKinesiofobia === "Moderada") {
                      recomendacionesEl.innerHTML = `
                        <p>Con un nivel moderado de kinesiofobia, se recomienda:</p>
                        <ul>
                            <li>Implementar educación en neurociencia del dolor para abordar creencias erróneas (nivel de evidencia 1A)</li>
                            <li>Ejercicio terapéutico con exposición gradual a movimientos temidos (nivel de evidencia 1A)</li>
                            <li>Estrategias cognitivo-conductuales para modificar creencias sobre el daño y el dolor (nivel de evidencia 1A)</li>
                            <li>Establecer objetivos funcionales basados en actividades significativas para el paciente (nivel de evidencia 1B)</li>
                            <li>Implementar técnicas de imaginería motora para movimientos que generan aprensión (nivel de evidencia 1B)</li>
                            <li>Proporcionar retroalimentación positiva durante la realización de ejercicios (nivel de evidencia 1B)</li>
                        </ul>`;
                 } else { // Severa
                      recomendacionesEl.innerHTML = `
                        <p>Con un nivel severo de kinesiofobia, se recomienda:</p>
                        <ul>
                            <li>Programa estructurado de educación en neurociencia del dolor (nivel de evidencia 1A)</li>
                            <li>Intervención cognitivo-conductual específica para abordar el miedo-evitación (nivel de evidencia 1A)</li>
                            <li>Exposición gradual muy progresiva a actividades y movimientos temidos (nivel de evidencia 1A)</li>
                            <li>Técnicas de desensibilización sistemática (nivel de evidencia 1B)</li>
                            <li>Establecer objetivos funcionales muy pequeños y alcanzables para construir confianza (nivel de evidencia 1A)</li>
                            <li>Considerar abordaje multidisciplinar si no hay mejora (nivel de evidencia 1A)</li>
                            <li>Uso de diario de exposición a movimientos para registro de expectativas vs. resultados reales (nivel de evidencia 1B)</li>
                            <li>Técnicas de atención plena (mindfulness) para reducir la ansiedad anticipatoria (nivel de evidencia 1B)</li>
                        </ul>`;
                 }

            } else {
                 // Reset if incomplete or elements missing
                  if (interpretacionEl) {
                    interpretacionEl.textContent = "Complete el cuestionario para obtener un resultado";
                    interpretacionEl.className = "resultado-interpretacion";
                  }
                  if (resultadoContainer) resultadoContainer.className = "resultado-container";
                  if (interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                  if (recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                  if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // ***** FIN JAVASCRIPT PARTE 2 *****

    // ***** INICIO JAVASCRIPT PARTE 3 *****

        // Función para calcular el puntaje del DN4
        function calcularDN4() {
            const items = [
                'dn4_quemazon', 'dn4_frio', 'dn4_descargas', 'dn4_hormigueo',
                'dn4_alfileres', 'dn4_entumecimiento', 'dn4_picazon',
                'dn4_hipoestesia', 'dn4_hipoestesia_pinchazo', 'dn4_cepillado'
            ];
            let puntaje = 0;
            let respondidos = 0;

            items.forEach(name => {
                const radioChecked = document.querySelector(`input[name="${name}"]:checked`);
                if (radioChecked) {
                    puntaje += parseInt(radioChecked.value);
                    respondidos++;
                }
            });

            // Update UI elements safely
            const valorElement = document.getElementById('dn4-valor');
            const interpretacionElement = document.getElementById('dn4-interpretacion');
            const interpretacionClinicaElement = document.getElementById('dn4-interpretacion-clinica');
            const recomendacionesElement = document.getElementById('dn4-recomendaciones');
            const badgeElement = document.getElementById('dn4-badge');
            const resultadoContainer = document.getElementById('dn4-resultado'); // Needed for coloring

            // Consider complete if all 10 are answered
            const completo = respondidos === 10;

            if (badgeElement) {
                if (completo) {
                    badgeElement.textContent = "Completado";
                    badgeElement.classList.remove('no-completado');
                    badgeElement.classList.add('completado', 'badge-verde');
                } else {
                    badgeElement.textContent = "No completado";
                    badgeElement.classList.remove('completado', 'badge-verde');
                    badgeElement.classList.add('no-completado');
                }
            }

            if (valorElement) valorElement.textContent = `${puntaje}/10`;

            if (completo && interpretacionElement && interpretacionClinicaElement && recomendacionesElement && resultadoContainer) {
                 let colorClass = "";
                 if (puntaje >= 4) {
                     interpretacionElement.textContent = "Probable dolor neuropático (≥4)";
                     interpretacionElement.className = "resultado-interpretacion rojo";
                     colorClass = "nivel-severo"; // Use severity classes for consistency

                     interpretacionClinicaElement.innerHTML = `
                        <p>Con un puntaje de ${puntaje}/10, el paciente presenta características altamente sugestivas de dolor neuropático. El DN4 tiene una sensibilidad del 83% y una especificidad del 90% con este punto de corte.</p>
                        <p>Las características presentes sugieren alteraciones en el procesamiento somatosensorial.</p>`;
                     recomendacionesElement.innerHTML = `
                        <ul>
                          <li>Implementar electroestimulación nerviosa transcutánea (TENS) con frecuencia alta (>80 Hz) (nivel de evidencia 1B)</li>
                          <li>Aplicar educación en neurociencia del dolor (nivel de evidencia 1A)</li>
                          <li>Utilizar técnicas de desensibilización gradual progresiva (nivel de evidencia 1B)</li>
                          <li>Incorporar ejercicio terapéutico de baja a moderada intensidad (nivel de evidencia 1A)</li>
                          <li>Aplicar terapia manual no agresiva como movilización neural (nivel de evidencia 2A)</li>
                          <li>Considerar terapia por espejo o imaginería motora graduada (nivel de evidencia 1B)</li>
                        </ul>`;

                 } else {
                     interpretacionElement.textContent = "Dolor no neuropático (<4)";
                     interpretacionElement.className = "resultado-interpretacion verde";
                     colorClass = "nivel-leve";

                     interpretacionClinicaElement.innerHTML = `
                        <p>Con un puntaje de ${puntaje}/10, el paciente no presenta un patrón típico de dolor neuropático. El dolor probablemente sea de origen nociceptivo o nociplástico.</p>`;
                     recomendacionesElement.innerHTML = `
                        <ul>
                          <li>Aplicar terapia manual específica según origen nociceptivo (nivel de evidencia 1A)</li>
                          <li>Prescribir ejercicio terapéutico específico y progresivo (nivel de evidencia 1A)</li>
                          <li>Implementar TENS en modalidad convencional (nivel de evidencia 1B)</li>
                          <li>Aplicar termoterapia superficial según fase (nivel de evidencia 1B)</li>
                          <li>Educación en autocuidado y manejo activo del dolor (nivel de evidencia 1A)</li>
                          <li>Realizar reevaluación periódica para identificar cambios (nivel de evidencia 2A)</li>
                        </ul>`;
                 }
                 resultadoContainer.className = `resultado-container ${colorClass}`;

            } else {
                 // Reset if incomplete or elements missing
                 if (interpretacionElement) {
                    interpretacionElement.textContent = "Complete el cuestionario para obtener un resultado";
                    interpretacionElement.className = "resultado-interpretacion";
                 }
                  if (interpretacionClinicaElement) interpretacionClinicaElement.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                  if (recomendacionesElement) recomendacionesElement.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                  if (resultadoContainer) resultadoContainer.className = "resultado-container";
                  if(badgeElement) badgeElement.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular NDI - Neck Disability Index
        function calcularNDI() {
            const items = [];
            let itemsRespondidos = 0;
            for (let i = 1; i <= 10; i++) {
                const item = document.querySelector(`input[name="ndi_item${i}"]:checked`);
                items.push(item);
                if (item) itemsRespondidos++;
            }

            // NDI requiere que TODOS los 10 ítems estén respondidos
            const completo = itemsRespondidos === 10;

            // Update UI elements safely
            const badge = document.getElementById('ndi-badge');
            const valorTotalEl = document.getElementById('ndi-valor-total');
            const valorPorcentajeEl = document.getElementById('ndi-valor-porcentaje');
            const nivelDiscapacidadEl = document.getElementById('ndi-nivel-discapacidad');
            const interpretacionTotalEl = document.getElementById('ndi-interpretacion-total'); // Added this line
            const resultadoContainer = document.getElementById('ndi-resultado');
            const interpretacionClinicaEl = document.getElementById('ndi-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('ndi-recomendaciones');

            if (badge) {
                 if (completo) {
                     badge.textContent = "Completado"; // We will update this later with level
                     badge.classList.remove("no-completado");
                     badge.classList.add("completado", "badge-verde"); // Start green
                 } else {
                     badge.textContent = "No completado";
                     badge.classList.remove("completado", "badge-verde");
                     badge.classList.add("no-completado");
                 }
            }

            if (completo && valorTotalEl && valorPorcentajeEl && nivelDiscapacidadEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let totalNDI = 0;
                items.forEach(item => {
                    if (item) totalNDI += parseInt(item.value);
                });

                const porcentajeNDI = (totalNDI / 50) * 100;
                const porcentajeRedondeado = porcentajeNDI.toFixed(1);

                let nivelDiscapacidad = "";
                let colorBadge = "";
                let colorClase = "";
                if (porcentajeNDI <= 20) { // 0-4 points = 0-8%; 5-14 points = 10-28% -> Common practice uses 0-20% Minimal
                    nivelDiscapacidad = "Discapacidad mínima"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (porcentajeNDI <= 40) { // 15-24 points = 30-48% -> Common practice uses 21-40% Moderate
                    nivelDiscapacidad = "Discapacidad moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else if (porcentajeNDI <= 60) { // 25-34 points = 50-68% -> Common practice uses 41-60% Severe
                    nivelDiscapacidad = "Discapacidad severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                } else if (porcentajeNDI <= 80) { // 35-44 points = 70-88% -> Common practice uses 61-80% Crippled
                     nivelDiscapacidad = "Discapacidad muy severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                }
                 else { // 45-50 points = 90-100% -> Common practice uses >80% Bed bound
                    nivelDiscapacidad = "Discapacidad completa"; colorBadge = "alto"; colorClase = "nivel-severo";
                }


                valorTotalEl.textContent = totalNDI + "/50";
                valorPorcentajeEl.textContent = porcentajeRedondeado + "%";
                nivelDiscapacidadEl.textContent = nivelDiscapacidad;
                interpretacionTotalEl.textContent = nivelDiscapacidad; // Update interpretation text
                 interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                 resultadoContainer.className = "resultado-container " + colorClase;
                 if(badge) badge.textContent = nivelDiscapacidad; // Update badge text
                 if(badge) badge.className = "resultado-badge completado " + colorBadge; // Update badge color


                 // Generate clinical interpretation
                let interpretacionClinica = "";
                if (porcentajeNDI <= 20) {
                    interpretacionClinica = `
                        <p>Puntuación NDI de <strong>${totalNDI}/50 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad mínima</strong>.</p>
                        <p>Impacto funcional bajo, puede realizar la mayoría de actividades. Dolor/molestias leves.</p>`;
                } else if (porcentajeNDI <= 40) {
                    interpretacionClinica = `
                        <p>Puntuación NDI de <strong>${totalNDI}/50 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad moderada</strong>.</p>
                        <p>Limitaciones funcionales significativas (posturas prolongadas, trabajo). Dolor moderado. Posible afectación de sueño/concentración.</p>`;
                } else if (porcentajeNDI <= 60) {
                     interpretacionClinica = `
                        <p>Puntuación NDI de <strong>${totalNDI}/50 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad severa</strong>.</p>
                        <p>Limitaciones importantes en la mayoría de AVD. Dificultad autocuidado. Dolor intenso. Restricciones laborales/recreativas severas.</p>`;
                } else if (porcentajeNDI <= 80) {
                     interpretacionClinica = `
                        <p>Puntuación NDI de <strong>${totalNDI}/50 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad muy severa ("Crippled")</strong>.</p>
                        <p>Limitaciones extremas. Dependencia parcial para AVD. Dolor muy intenso y constante. Impacto severo en calidad de vida.</p>`;
                } else {
                    interpretacionClinica = `
                        <p>Puntuación NDI de <strong>${totalNDI}/50 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad completa ("Bed-bound")</strong>.</p>
                        <p>Incapacidad para mayoría de actividades. Dependencia significativa. Dolor incapacitante. Considerar banderas rojas y evaluación especializada.</p>`;
                }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Generate therapeutic recommendations
                 let recomendationsHTML = "";
                 if (porcentajeNDI <= 20) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Mínima):</h6>
                        <ul>
                            <li>Educación en higiene postural y ergonomía.</li>
                            <li>Ejercicios de movilidad y fortalecimiento cervical preventivo.</li>
                            <li>Técnicas de automanejo y estiramientos.</li>
                            <li>Evaluación de factores de riesgo laborales/recreativos.</li>
                        </ul>`;
                 } else if (porcentajeNDI <= 40) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Moderada):</h6>
                        <ul>
                            <li>Terapia manual para mejorar movilidad.</li>
                            <li>Ejercicios de control motor y estabilización cervical/escapular.</li>
                            <li>Reeducación postural y de patrones de movimiento.</li>
                            <li>Tratamiento de puntos gatillo y tensión miofascial.</li>
                             <li>Adaptaciones ergonómicas y pacing de actividades.</li>
                        </ul>`;
                 } else { // Severe or higher
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Severa/Completa):</h6>
                        <ul>
                            <li>Enfoque multidisciplinario (médico, psicólogo).</li>
                            <li>Manejo del dolor multimodal (terapia manual suave, modalidades, educación).</li>
                            <li>Ejercicios de control motor de baja carga y progresión muy lenta.</li>
                            <li>Neurodinámica y tratamiento de sensibilización si procede.</li>
                            <li>Abordaje de factores psicosociales (miedo, catastrofización).</li>
                            <li>Rehabilitación funcional gradual y adaptada.</li>
                            <li>Considerar evaluación médica especializada para descartar patología grave.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;

            } else {
                // Reset if incomplete or elements missing
                 if(valorTotalEl) valorTotalEl.textContent = "-/50";
                 if(valorPorcentajeEl) valorPorcentajeEl.textContent = "-%";
                 if(nivelDiscapacidadEl) nivelDiscapacidadEl.textContent = "-";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete el cuestionario";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado";
            }

            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular el puntaje del QuickDASH
        function calcularQuickDASH() {
            const items = [];
            let itemsRespondidos = 0;
            for (let i = 1; i <= 11; i++) {
                const item = document.querySelector(`input[name="quickdash_item${i}"]:checked`);
                items.push(item);
                if (item) itemsRespondidos++;
            }

            // QuickDASH requiere al menos 10 de 11 preguntas respondidas
            const respuestasMinimas = 10;
            const completo = itemsRespondidos >= respuestasMinimas;

            // Update UI elements safely
            const badge = document.getElementById('quickdash-badge');
            const valorTotalEl = document.getElementById('quickdash-valor-total');
            const nivelDiscapacidadEl = document.getElementById('quickdash-nivel-discapacidad');
            const interpretacionTotalEl = document.getElementById('quickdash-interpretacion-total');
            const resultadoContainer = document.getElementById('quickdash-resultado');
            const interpretacionClinicaEl = document.getElementById('quickdash-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('quickdash-recomendaciones');

            if (badge) {
                if (completo) {
                    badge.textContent = "Completado"; // Will update with level later
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde"); // Start green
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

            if (completo && valorTotalEl && nivelDiscapacidadEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let suma = 0;
                items.forEach(item => {
                    if (item !== null) {
                        suma += parseInt(item.value);
                    }
                });

                // Calcular el puntaje QuickDASH: [(suma / número de respuestas) - 1] × 25
                const puntajeQuickDASH = ((suma / itemsRespondidos) - 1) * 25;
                const puntajeRedondeado = puntajeQuickDASH.toFixed(1); // Keep one decimal

                let nivelDiscapacidad = "";
                let colorBadge = "";
                let colorClase = "";
                 // Common interpretation: <20 Minimal, 20-40 Moderate, >40 Severe (approx)
                if (puntajeQuickDASH < 20) {
                    nivelDiscapacidad = "Discapacidad mínima"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (puntajeQuickDASH < 40) {
                    nivelDiscapacidad = "Discapacidad moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else {
                    nivelDiscapacidad = "Discapacidad severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                }

                valorTotalEl.textContent = puntajeRedondeado + "/100";
                nivelDiscapacidadEl.textContent = nivelDiscapacidad;
                interpretacionTotalEl.textContent = nivelDiscapacidad;
                interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                resultadoContainer.className = "resultado-container " + colorClase;
                if(badge) badge.textContent = nivelDiscapacidad;
                if(badge) badge.className = "resultado-badge completado " + colorBadge;


                 // Generate clinical interpretation
                 let interpretacionClinica = "";
                 if (puntajeQuickDASH < 20) {
                     interpretacionClinica = `
                        <p>Puntuación QuickDASH de <strong>${puntajeRedondeado}/100</strong>: <strong>Discapacidad mínima</strong>.</p>
                        <p>Limitaciones funcionales mínimas en brazo/hombro/mano. Buen nivel funcional general.</p>`;
                 } else if (puntajeQuickDASH < 40) {
                     interpretacionClinica = `
                        <p>Puntuación QuickDASH de <strong>${puntajeRedondeado}/100</strong>: <strong>Discapacidad moderada</strong>.</p>
                        <p>Limitaciones moderadas en AVD y laborales. Dificultad con algunas tareas específicas. Requiere adaptaciones.</p>`;
                 } else {
                     interpretacionClinica = `
                        <p>Puntuación QuickDASH de <strong>${puntajeRedondeado}/100</strong>: <strong>Discapacidad severa</strong>.</p>
                        <p>Limitaciones importantes en la mayoría de AVD. Dificultad significativa en tareas básicas. Impacto notable en calidad de vida.</p>`;
                 }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Generate therapeutic recommendations (Simplified)
                 let recomendationsHTML = "";
                 if (puntajeQuickDASH < 20) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Mínima):</h6>
                        <ul>
                            <li>Terapia manual focalizada y ejercicios específicos.</li>
                            <li>Optimización de patrones de movimiento y ergonomía.</li>
                            <li>Programa preventivo y de mantenimiento.</li>
                        </ul>`;
                 } else if (puntajeQuickDASH < 40) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Moderada):</h6>
                        <ul>
                            <li>Programa multimodal: Terapia manual, ejercicio terapéutico, reeducación neuromuscular.</li>
                            <li>Fortalecimiento progresivo y estabilización escapular/hombro.</li>
                            <li>Educación en pacing y modificación de actividades.</li>
                        </ul>`;
                 } else {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Severa):</h6>
                        <ul>
                            <li>Enfoque interdisciplinario si es necesario.</li>
                            <li>Programa gradual con énfasis en manejo del dolor y función básica.</li>
                            <li>Estrategias de desensibilización y exposición gradual.</li>
                            <li>Entrenamiento funcional específico y adaptaciones.</li>
                            <li>Abordaje de factores psicosociales si existen.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else {
                // Reset if incomplete or elements missing
                 if(valorTotalEl) valorTotalEl.textContent = "-/100";
                 if(nivelDiscapacidadEl) nivelDiscapacidadEl.textContent = "-";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete al menos 10 preguntas";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                  if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular el puntaje del SPADI
        function calcularSPADI() {
            const itemsDolorRefs = [];
            let dolorRespondidos = 0;
            for (let i = 1; i <= 5; i++) {
                const item = document.querySelector(`input[name="spadi_dolor${i}"]:checked`);
                itemsDolorRefs.push(item);
                if (item) dolorRespondidos++;
            }

            const itemsDiscapacidadRefs = [];
            let discapacidadRespondidos = 0;
            for (let i = 1; i <= 8; i++) {
                const item = document.querySelector(`input[name="spadi_discap${i}"]:checked`);
                itemsDiscapacidadRefs.push(item);
                if (item) discapacidadRespondidos++;
            }

            const totalRespondidos = dolorRespondidos + discapacidadRespondidos;
            // SPADI requires at least 10/13 items (~80%)
            const respuestasMinimas = 10;
            const completo = totalRespondidos >= respuestasMinimas;

             // Update UI elements safely
            const badge = document.getElementById('spadi-badge');
            const valorTotalEl = document.getElementById('spadi-valor-total');
            const valorDolorEl = document.getElementById('spadi-valor-dolor');
            const valorDiscapacidadEl = document.getElementById('spadi-valor-discapacidad');
            const interpretacionTotalEl = document.getElementById('spadi-interpretacion-total');
            const resultadoContainer = document.getElementById('spadi-resultado');
            const interpretacionClinicaEl = document.getElementById('spadi-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('spadi-recomendaciones');

             if (badge) {
                if (completo) {
                    badge.textContent = "Completado"; // Will update later
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde");
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

            if (completo && valorTotalEl && valorDolorEl && valorDiscapacidadEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let sumaDolor = 0;
                itemsDolorRefs.forEach(item => { if (item) sumaDolor += parseInt(item.value); });
                const puntuacionDolor = dolorRespondidos > 0 ? (sumaDolor / (dolorRespondidos * 10)) * 100 : 0;

                let sumaDiscapacidad = 0;
                itemsDiscapacidadRefs.forEach(item => { if (item) sumaDiscapacidad += parseInt(item.value); });
                const puntuacionDiscapacidad = discapacidadRespondidos > 0 ? (sumaDiscapacidad / (discapacidadRespondidos * 10)) * 100 : 0;

                // Total score is the average only if BOTH subscales have enough responses
                // SPADI validity often requires >2 items per subscale answered, let's assume our 80% overall check is sufficient for now
                const puntuacionTotal = (puntuacionDolor + puntuacionDiscapacidad) / 2;
                const puntuacionRedondeada = puntuacionTotal.toFixed(1);

                let nivelAfectacion = "";
                let colorBadge = "";
                let colorClase = "";
                // Interpretation: <30 Mild, 30-60 Moderate, >60 Severe (common ranges)
                if (puntuacionTotal < 30) {
                    nivelAfectacion = "Afectación leve"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (puntuacionTotal < 60) {
                    nivelAfectacion = "Afectación moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else {
                    nivelAfectacion = "Afectación severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                }

                valorTotalEl.textContent = puntuacionRedondeada + "/100";
                valorDolorEl.textContent = puntuacionDolor.toFixed(1) + "%";
                valorDiscapacidadEl.textContent = puntuacionDiscapacidad.toFixed(1) + "%";
                interpretacionTotalEl.textContent = nivelAfectacion;
                 interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                 resultadoContainer.className = "resultado-container " + colorClase;
                 if(badge) badge.textContent = nivelAfectacion;
                 if(badge) badge.className = "resultado-badge completado " + colorBadge;


                // Clinical Interpretation
                let interpretacionClinica = "";
                const diff = Math.abs(puntuacionDolor - puntuacionDiscapacidad);
                const diffText = diff > 15 ? ` Muestra una discrepancia significativa (${diff.toFixed(1)}pts).` : ` Muestra coherencia entre dolor y discapacidad.`;

                 if (puntuacionTotal < 30) {
                     interpretacionClinica = `
                        <p>Puntuación SPADI de <strong>${puntuacionRedondeada}/100</strong>: <strong>Afectación leve</strong> (Dolor ${puntuacionDolor.toFixed(1)}%, Discapacidad ${puntuacionDiscapacidad.toFixed(1)}%).</p>
                        <p>Molestias leves/moderadas con buena funcionalidad general. Limitaciones en actividades específicas de hombro.${diffText}</p>`;
                 } else if (puntuacionTotal < 60) {
                     interpretacionClinica = `
                        <p>Puntuación SPADI de <strong>${puntuacionRedondeada}/100</strong>: <strong>Afectación moderada</strong> (Dolor ${puntuacionDolor.toFixed(1)}%, Discapacidad ${puntuacionDiscapacidad.toFixed(1)}%).</p>
                        <p>Dolor significativo que interfiere con varias AVD. Limitaciones funcionales moderadas (elevación, fuerza, autocuidado).${diffText}</p>`;
                 } else {
                     interpretacionClinica = `
                        <p>Puntuación SPADI de <strong>${puntuacionRedondeada}/100</strong>: <strong>Afectación severa</strong> (Dolor ${puntuacionDolor.toFixed(1)}%, Discapacidad ${puntuacionDiscapacidad.toFixed(1)}%).</p>
                        <p>Dolor intenso con limitaciones sustanciales en función diaria. Dificultades importantes en autocuidado y AVD. Impacto emocional probable.${diffText}</p>`;
                 }
                interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified)
                 let recomendationsHTML = "";
                 if (puntuacionTotal < 30) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Leve):</h6>
                        <ul>
                            <li>Terapia manual específica, ejercicios de estabilización escapular/control motor.</li>
                            <li>Reentrenamiento de patrones de movimiento, fortalecimiento manguito rotador.</li>
                            <li>Educación en biomecánica y ergonomía.</li>
                        </ul>`;
                 } else if (puntuacionTotal < 60) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Moderada):</h6>
                        <ul>
                            <li>Programa multimodal (manual + ejercicio activo).</li>
                            <li>Movilización articular, reeducación neuromuscular escapulohumeral.</li>
                            <li>Entrenamiento excéntrico, propioceptivo, funcional.</li>
                            <li>Educación en pacing y modificación de actividades.</li>
                        </ul>`;
                 } else {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Severa):</h6>
                        <ul>
                            <li>Enfoque interdisciplinario si es necesario.</li>
                            <li>Manejo del dolor multimodal, terapia manual gentil.</li>
                            <li>Ejercicio terapéutico muy gradual, entrenamiento funcional adaptado.</li>
                            <li>Estrategias de desensibilización, considerar órtesis/ayudas.</li>
                             <li>Abordaje de factores psicosociales.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else {
                // Reset if incomplete or elements missing
                 if(valorTotalEl) valorTotalEl.textContent = "-/100";
                 if(valorDolorEl) valorDolorEl.textContent = "-%";
                 if(valorDiscapacidadEl) valorDiscapacidadEl.textContent = "-%";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete al menos 10 preguntas";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // ***** FIN JAVASCRIPT PARTE 3 *****
    // ***** INICIO JAVASCRIPT PARTE 4 *****

        // Función para calcular el Índice de Discapacidad de Oswestry (ODI)
        function calcularOswestry() {
            const items = [];
            let itemsRespondidos = 0;
            for (let i = 1; i <= 10; i++) {
                const item = document.querySelector(`input[name="oswestry_item${i}"]:checked`);
                items.push(item);
                if (item) itemsRespondidos++;
            }

            // ODI requiere al menos 8/10 ítems respondidos
            const respuestasMinimas = 8;
            const completo = itemsRespondidos >= respuestasMinimas;

            // Update UI elements safely
            const badge = document.getElementById('oswestry-badge');
            const valorTotalEl = document.getElementById('oswestry-valor-total');
            const valorPorcentajeEl = document.getElementById('oswestry-valor-porcentaje');
            const nivelDiscapacidadEl = document.getElementById('oswestry-nivel-discapacidad');
            const interpretacionTotalEl = document.getElementById('oswestry-interpretacion-total');
            const resultadoContainer = document.getElementById('oswestry-resultado');
            const interpretacionClinicaEl = document.getElementById('oswestry-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('oswestry-recomendaciones');

            let mensajeIncompleto = completo ? "" : " (incompleto)";

             if (badge) {
                if (completo) {
                    badge.textContent = "Completado"; // Will update later
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde"); // Start green
                } else {
                    badge.textContent = "No completado";
                    badge.classList.remove("completado", "badge-verde");
                    badge.classList.add("no-completado");
                }
            }

            if (completo && valorTotalEl && valorPorcentajeEl && nivelDiscapacidadEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let suma = 0;
                items.forEach(item => { if (item) suma += parseInt(item.value); });

                const puntuacionMaximaPosible = itemsRespondidos * 5;
                const porcentajeDiscapacidad = (suma / puntuacionMaximaPosible) * 100;
                const porcentajeRedondeado = porcentajeDiscapacidad.toFixed(1);

                let nivelDiscapacidad = "";
                let colorBadge = "";
                let colorClase = "";
                // ODI interpretation ranges (0-20% Minimal, 21-40% Moderate, 41-60% Severe, 61-80% Crippled, 81-100% Bed-bound)
                if (porcentajeDiscapacidad <= 20) {
                    nivelDiscapacidad = "Discapacidad mínima"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (porcentajeDiscapacidad <= 40) {
                    nivelDiscapacidad = "Discapacidad moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else if (porcentajeDiscapacidad <= 60) {
                    nivelDiscapacidad = "Discapacidad severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                } else if (porcentajeDiscapacidad <= 80) {
                    nivelDiscapacidad = "Discapacidad muy severa"; colorBadge = "alto"; colorClase = "nivel-severo"; // Often grouped with severe
                } else {
                    nivelDiscapacidad = "Discapacidad extrema"; colorBadge = "alto"; colorClase = "nivel-severo"; // Often grouped with severe
                }

                valorTotalEl.textContent = `${suma}/${puntuacionMaximaPosible}${mensajeIncompleto}`;
                valorPorcentajeEl.textContent = porcentajeRedondeado + "%";
                nivelDiscapacidadEl.textContent = nivelDiscapacidad;
                interpretacionTotalEl.textContent = nivelDiscapacidad;
                interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                resultadoContainer.className = "resultado-container " + colorClase;
                if(badge) badge.textContent = nivelDiscapacidad;
                if(badge) badge.className = "resultado-badge completado " + colorBadge;


                // Clinical Interpretation
                 let interpretacionClinica = "";
                 if (porcentajeDiscapacidad <= 20) {
                     interpretacionClinica = `
                        <p>Puntuación ODI de <strong>${porcentajeRedondeado}%</strong>: <strong>Discapacidad mínima</strong>.</p>
                        <p>Puede realizar la mayoría de AVD. Dolor leve que no interfiere significativamente. Buen pronóstico.</p>`;
                 } else if (porcentajeDiscapacidad <= 40) {
                     interpretacionClinica = `
                        <p>Puntuación ODI de <strong>${porcentajeRedondeado}%</strong>: <strong>Discapacidad moderada</strong>.</p>
                        <p>Dificultades en AVD (sentarse, levantarse, trabajo). Dolor significativo. Posibles alteraciones sueño/vida social.</p>`;
                 } else if (porcentajeDiscapacidad <= 60) {
                     interpretacionClinica = `
                        <p>Puntuación ODI de <strong>${porcentajeRedondeado}%</strong>: <strong>Discapacidad severa</strong>.</p>
                        <p>Limitaciones importantes en AVD. Dolor intenso es problema principal. Dificultades en autocuidado, sueño. Vida social restringida.</p>`;
                 } else { // Muy severa / Extrema
                     interpretacionClinica = `
                        <p>Puntuación ODI de <strong>${porcentajeRedondeado}%</strong>: <strong>${nivelDiscapacidad}</strong>.</p>
                        <p>Limitaciones extremas en todas las áreas. Dolor incapacitante. Movilidad severamente comprometida. Posible dependencia. Requiere abordaje intensivo.</p>`;
                 }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified)
                 let recomendationsHTML = "";
                 if (porcentajeDiscapacidad <= 20) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Mínima):</h6>
                        <ul>
                            <li>Ejercicios de control motor lumbopélvico y estabilización.</li>
                            <li>Educación en ergonomía y mecánica corporal.</li>
                            <li>Terapia manual específica si hay hallazgos.</li>
                            <li>Programa preventivo y de autogestión.</li>
                        </ul>`;
                 } else if (porcentajeDiscapacidad <= 40) {
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Moderada):</h6>
                        <ul>
                            <li>Programa multimodal (manual + ejercicio).</li>
                            <li>Ejercicios progresivos de fortalecimiento y control motor.</li>
                            <li>Reeducación postural y de patrones de movimiento.</li>
                             <li>Educación en neurociencia del dolor y estrategias activas.</li>
                             <li>Pacing de actividades y ergonomía.</li>
                        </ul>`;
                 } else { // Severa o mayor
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Severa/Extrema):</h6>
                        <ul>
                            <li>Abordaje multidisciplinario (médico, psicólogo).</li>
                             <li>Manejo del dolor multimodal.</li>
                             <li>Ejercicio terapéutico muy gradual y supervisado.</li>
                             <li>Intervenciones cognitivo-conductuales (miedo-evitación).</li>
                             <li>Exposición gradual a actividades.</li>
                             <li>Educación intensiva y estrategias de autogestión avanzadas.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;

            } else {
                // Reset if incomplete or elements missing
                 if(valorTotalEl) valorTotalEl.textContent = "-/-";
                 if(valorPorcentajeEl) valorPorcentajeEl.textContent = "-%";
                 if(nivelDiscapacidadEl) nivelDiscapacidadEl.textContent = "-";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete al menos 8 preguntas";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular el Cuestionario de Discapacidad de Roland Morris (RMDQ)
        function calcularRolandMorris() {
            let puntuacionTotal = 0;
            let interaccionUsuario = false; // Check if any box is checked

            for (let i = 1; i <= 24; i++) {
                const item = document.getElementById(`rolandmorris_item${i}`);
                if (item && item.checked) {
                    puntuacionTotal++;
                    interaccionUsuario = true;
                } else if (item && !item.checked){
                     // Check if *any* box has been interacted with (even if unchecked later)
                     // This check might be too simple; ideally check if *at least one* is checked
                     // For simplicity, we'll rely on puntuacionTotal > 0 or if any box *exists*
                     if (item) interaccionUsuario = true; // If the element exists, assume potential interaction
                }
            }

             // RMDQ is considered complete if the function runs and elements exist.
             // Score of 0 is valid.
             const completo = true; // Assume complete if function runs

             // Update UI elements safely
            const badge = document.getElementById('rolandmorris-badge');
            const valorTotalEl = document.getElementById('rolandmorris-valor-total');
            const valorPorcentajeEl = document.getElementById('rolandmorris-valor-porcentaje');
            const nivelDiscapacidadEl = document.getElementById('rolandmorris-nivel-discapacidad');
            const interpretacionTotalEl = document.getElementById('rolandmorris-interpretacion-total');
            const resultadoContainer = document.getElementById('rolandmorris-resultado');
            const interpretacionClinicaEl = document.getElementById('rolandmorris-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('rolandmorris-recomendaciones');

             // Calculate percentage
             const porcentaje = (puntuacionTotal / 24) * 100;
             const porcentajeRedondeado = porcentaje.toFixed(1);

            // Determine disability level and colors
            let nivelDiscapacidad = "";
            let colorBadge = "";
            let colorClase = "";
             // RMDQ Interpretation: Often uses terciles or specific cutoffs.
             // Let's use approximate terciles: 0-7 (Mild), 8-16 (Moderate), 17-24 (Severe)
             if (puntuacionTotal <= 7) {
                 nivelDiscapacidad = "Discapacidad leve"; colorBadge = "bajo"; colorClase = "nivel-leve";
             } else if (puntuacionTotal <= 16) {
                 nivelDiscapacidad = "Discapacidad moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
             } else {
                 nivelDiscapacidad = "Discapacidad severa"; colorBadge = "alto"; colorClase = "nivel-severo";
             }

            // Update UI only if elements exist
            if (badge) {
                 badge.textContent = nivelDiscapacidad; // RMDQ score 0 is valid, so always show level
                 badge.classList.remove("no-completado");
                 badge.classList.add("completado", colorBadge);
            }
             if(valorTotalEl) valorTotalEl.textContent = puntuacionTotal + "/24";
             if(valorPorcentajeEl) valorPorcentajeEl.textContent = porcentajeRedondeado + "%";
             if(nivelDiscapacidadEl) nivelDiscapacidadEl.textContent = nivelDiscapacidad;
             if(interpretacionTotalEl) {
                 interpretacionTotalEl.textContent = nivelDiscapacidad;
                 interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
             }
             if(resultadoContainer) resultadoContainer.className = "resultado-container " + colorClase;

             if(interpretacionClinicaEl && recomendacionesEl){
                 // Clinical Interpretation
                 let interpretacionClinica = "";
                 if (puntuacionTotal <= 7) {
                     interpretacionClinica = `
                        <p>Puntuación RMDQ de <strong>${puntuacionTotal}/24 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad leve</strong>.</p>
                        <p>Limitaciones funcionales específicas pero realiza la mayoría de AVD. Dolor leve/moderado. Buen pronóstico.</p>`;
                 } else if (puntuacionTotal <= 16) {
                     interpretacionClinica = `
                        <p>Puntuación RMDQ de <strong>${puntuacionTotal}/24 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad moderada</strong>.</p>
                        <p>Limitaciones significativas en AVD (sentarse, caminar, tareas). Posibles adaptaciones/compensaciones. Requiere enfoque estructurado.</p>`;
                 } else {
                     interpretacionClinica = `
                        <p>Puntuación RMDQ de <strong>${puntuacionTotal}/24 (${porcentajeRedondeado}%)</strong>: <strong>Discapacidad severa</strong>.</p>
                        <p>Limitaciones importantes en mayoría de AVD. Dificultad en autocuidado, movilidad. Posibles factores psicosociales. Requiere abordaje intensivo.</p>`;
                 }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified)
                 let recomendationsHTML = "";
                  if (puntuacionTotal <= 7) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Leve):</h6>
                        <ul>
                            <li>Ejercicios de control motor lumbopélvico y estabilización.</li>
                            <li>Educación en ergonomía y mecánica corporal.</li>
                            <li>Terapia manual específica si hay hallazgos.</li>
                            <li>Programa preventivo y de autogestión.</li>
                        </ul>`;
                 } else if (puntuacionTotal <= 16) {
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Moderada):</h6>
                        <ul>
                            <li>Programa multimodal (manual + ejercicio).</li>
                            <li>Ejercicios progresivos de fortalecimiento y control motor.</li>
                            <li>Reeducación postural y de patrones de movimiento.</li>
                             <li>Educación en neurociencia del dolor y estrategias activas.</li>
                             <li>Pacing de actividades y ergonomía.</li>
                        </ul>`;
                 } else { // Severa
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Discapacidad Severa):</h6>
                        <ul>
                            <li>Abordaje multidisciplinario (médico, psicólogo).</li>
                             <li>Manejo del dolor multimodal.</li>
                             <li>Ejercicio terapéutico muy gradual y supervisado.</li>
                             <li>Intervenciones cognitivo-conductuales (miedo-evitación).</li>
                             <li>Exposición gradual a actividades.</li>
                             <li>Educación intensiva y estrategias de autogestión avanzadas.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;
             }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // Función para calcular el Índice WOMAC
        function calcularWOMAC() {
            const categorias = {
                dolor: { items: ["womac_a1", "womac_a2", "womac_a3", "womac_a4", "womac_a5"], maxScore: 20 },
                rigidez: { items: ["womac_b1", "womac_b2"], maxScore: 8 },
                funcion: { items: ["womac_c1", "womac_c2", "womac_c3", "womac_c4", "womac_c5", "womac_c6", "womac_c7", "womac_c8", "womac_c9", "womac_c10", "womac_c11", "womac_c12", "womac_c13", "womac_c14", "womac_c15", "womac_c16", "womac_c17"], maxScore: 68 }
            };

            const puntuaciones = {};
            const itemsRespondidos = {};
            let totalRespondidos = 0;
            let interaccionUsuario = false;

            for (const [categoria, data] of Object.entries(categorias)) {
                puntuaciones[categoria] = 0;
                itemsRespondidos[categoria] = 0;
                for (const item of data.items) {
                    const valor = document.querySelector(`input[name="${item}"]:checked`)?.value;
                    if (valor !== undefined) {
                        puntuaciones[categoria] += parseInt(valor);
                        itemsRespondidos[categoria]++;
                        totalRespondidos++;
                        interaccionUsuario = true; // Mark interaction if any item is selected
                    }
                }
            }

             // Update UI elements safely
            const badge = document.getElementById('womac-badge');
            const valorTotalEl = document.getElementById('womac-valor-total');
            const valorDolorEl = document.getElementById('womac-valor-dolor');
            const valorRigidezEl = document.getElementById('womac-valor-rigidez');
            const valorFuncionEl = document.getElementById('womac-valor-funcion');
            const interpretacionTotalEl = document.getElementById('womac-interpretacion-total');
            const resultadoContainer = document.getElementById('womac-resultado');
            const interpretacionClinicaEl = document.getElementById('womac-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('womac-recomendaciones');

             // WOMAC needs >= 80% of items responded for valid score (~20/24)
             const respuestasMinimas = 20;
             const completo = totalRespondidos >= respuestasMinimas;
             let mensajeIncompleto = completo ? "" : " (incompleto)";

             if (badge) {
                if (completo || interaccionUsuario) { // Show badge if user interacted, even if incomplete
                     badge.textContent = "Completado"; // Will update later
                     badge.classList.remove("no-completado");
                     badge.classList.add("completado", "badge-verde"); // Start green
                 }
                 if (!completo && interaccionUsuario) { // Add incomplete warning
                     badge.textContent = "Incompleto";
                     badge.classList.remove("badge-verde");
                     badge.classList.add("no-completado"); // Make it grey/default
                 }
                  if (!interaccionUsuario) { // Reset if no interaction
                      badge.textContent = "No completado";
                      badge.classList.remove("completado", "badge-verde");
                      badge.classList.add("no-completado");
                  }
            }

            if ( (completo || interaccionUsuario) && valorTotalEl && valorDolorEl && valorRigidezEl && valorFuncionEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl ) {
                // Calculate normalized scores (0-100, 0 = best, 100 = worst)
                const normDolor = itemsRespondidos.dolor > 0 ? (puntuaciones.dolor / (itemsRespondidos.dolor * 4)) * 100 : 0;
                const normRigidez = itemsRespondidos.rigidez > 0 ? (puntuaciones.rigidez / (itemsRespondidos.rigidez * 4)) * 100 : 0;
                const normFuncion = itemsRespondidos.funcion > 0 ? (puntuaciones.funcion / (itemsRespondidos.funcion * 4)) * 100 : 0;

                // Total score: Simple average of the three normalized subscales if they have data
                let numValidSubscales = 0;
                let sumValidSubscales = 0;
                if(itemsRespondidos.dolor > 0) { sumValidSubscales += normDolor; numValidSubscales++; }
                if(itemsRespondidos.rigidez > 0) { sumValidSubscales += normRigidez; numValidSubscales++; }
                if(itemsRespondidos.funcion > 0) { sumValidSubscales += normFuncion; numValidSubscales++; }
                const normTotal = numValidSubscales > 0 ? sumValidSubscales / numValidSubscales : 0;
                const totalPuntajeCrudo = puntuaciones.dolor + puntuaciones.rigidez + puntuaciones.funcion;
                const maxPuntajePosible = (itemsRespondidos.dolor + itemsRespondidos.rigidez + itemsRespondidos.funcion) * 4;

                valorTotalEl.textContent = `${totalPuntajeCrudo}/${maxPuntajePosible} (${normTotal.toFixed(1)}%)${mensajeIncompleto}`;
                valorDolorEl.textContent = `${puntuaciones.dolor}/${itemsRespondidos.dolor*4} (${normDolor.toFixed(1)}%)`;
                valorRigidezEl.textContent = `${puntuaciones.rigidez}/${itemsRespondidos.rigidez*4} (${normRigidez.toFixed(1)}%)`;
                valorFuncionEl.textContent = `${puntuaciones.funcion}/${itemsRespondidos.funcion*4} (${normFuncion.toFixed(1)}%)`;

                let nivelAfectacion = "";
                let colorBadge = "";
                let colorClase = "";
                 // Interpretation based on normalized total score (0=best, 100=worst)
                if (normTotal < 30) {
                    nivelAfectacion = "Afectación leve"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (normTotal < 60) {
                    nivelAfectacion = "Afectación moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else {
                    nivelAfectacion = "Afectación severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                }

                interpretacionTotalEl.textContent = completo ? nivelAfectacion : "Incompleto";
                interpretacionTotalEl.className = `resultado-interpretacion ${completo ? colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo") : ''}`;
                resultadoContainer.className = "resultado-container " + (completo ? colorClase : '');
                if(badge && (completo || interaccionUsuario)) badge.textContent = completo ? nivelAfectacion : "Incompleto";
                if(badge && completo) badge.className = "resultado-badge completado " + colorBadge;


                // Clinical Interpretation
                let interpretacionClinica = "";
                if (completo) {
                    if (normTotal < 30) {
                        interpretacionClinica = `
                            <p>Puntuación WOMAC <strong>${normTotal.toFixed(1)}%</strong>: <strong>Afectación leve</strong>.</p>
                            <p>Síntomas leves con impacto limitado en AVD. Buena funcionalidad general.</p>`;
                    } else if (normTotal < 60) {
                        interpretacionClinica = `
                            <p>Puntuación WOMAC <strong>${normTotal.toFixed(1)}%</strong>: <strong>Afectación moderada</strong>.</p>
                            <p>Síntomas significativos que impactan calidad de vida. Limitaciones funcionales moderadas. Requiere programa estructurado.</p>`;
                    } else {
                        interpretacionClinica = `
                            <p>Puntuación WOMAC <strong>${normTotal.toFixed(1)}%</strong>: <strong>Afectación severa</strong>.</p>
                            <p>Síntomas severos con impacto significativo. Limitaciones funcionales importantes. Requiere abordaje integral.</p>`;
                    }
                } else {
                    interpretacionClinica = `<p>Cuestionario incompleto. Se requieren al menos 20 respuestas para una interpretación fiable.</p>`;
                }
                interpretacionClinicaEl.innerHTML = interpretacionClinica;


                 // Therapeutic Recommendations (Simplified, only if complete)
                 let recomendationsHTML = "";
                 if(completo){
                     if (normTotal < 30) {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Afectación Leve):</h6>
                            <ul>
                                <li>Ejercicio terapéutico (fortalecimiento, control neuromuscular, aeróbico bajo impacto).</li>
                                <li>Educación en manejo de cargas y protección articular.</li>
                                <li>Terapia manual si hay disfunciones específicas.</li>
                            </ul>`;
                     } else if (normTotal < 60) {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Afectación Moderada):</h6>
                            <ul>
                                <li>Programa multimodal (ejercicio + educación + manual).</li>
                                <li>Fortalecimiento progresivo, entrenamiento funcional.</li>
                                <li>Estrategias de pacing y modificación de actividades.</li>
                                <li>Considerar ayudas técnicas si es necesario.</li>
                            </ul>`;
                     } else { // Severe
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Afectación Severa):</h6>
                            <ul>
                                <li>Abordaje multidisciplinar.</li>
                                <li>Ejercicio adaptado y de muy baja carga inicial.</li>
                                <li>Manejo del dolor multimodal, Terapia manual gentil.</li>
                                <li>Entrenamiento funcional básico, adaptaciones, órtesis.</li>
                                 <li>Considerar evaluación médica para opciones avanzadas.</li>
                            </ul>`;
                     }
                 } else {
                     recomendationsHTML = `<p>Complete el cuestionario (al menos 20 respuestas) para obtener recomendaciones.</p>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;

            } else if (!interaccionUsuario){
                 // Reset if no interaction
                  if(valorTotalEl) valorTotalEl.textContent = "-/- (%)";
                  if(valorDolorEl) valorDolorEl.textContent = "-/- (%)";
                  if(valorRigidezEl) valorRigidezEl.textContent = "-/- (%)";
                  if(valorFuncionEl) valorFuncionEl.textContent = "-/- (%)";
                  if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete el cuestionario";
                  if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                  if(resultadoContainer) resultadoContainer.className = "resultado-container";
                  if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                  if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                  if(badge) badge.className = "resultado-badge no-completado";
            }
             // If user interacted but not enough answers, the badge shows incomplete, and results area shows partial data.
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // ***** FIN JAVASCRIPT PARTE 4 *****
    // ***** INICIO JAVASCRIPT PARTE 5 *****

        // Función para calcular el START MSK Tool
        function calcularStartMSK() {
            const items = [];
            let itemsRespondidos = 0;
            for (let i = 1; i <= 10; i++) {
                const item = document.querySelector(`input[name="startmsk_item${i}"]:checked`);
                items.push(item);
                if (item) itemsRespondidos++;
            }

            // START MSK requiere al menos 8/10 items respondidos
            const respuestasMinimas = 8;
            const completo = itemsRespondidos >= respuestasMinimas;
            let mensajeIncompleto = completo ? "" : " (incompleto)";

            // Update UI elements safely
            const badge = document.getElementById('startmsk-badge');
            const valorTotalEl = document.getElementById('startmsk-valor-total');
            const valorFisicaEl = document.getElementById('startmsk-valor-fisica');
            const valorPsicosocialEl = document.getElementById('startmsk-valor-psicosocial');
            const interpretacionTotalEl = document.getElementById('startmsk-interpretacion-total');
            const resultadoContainer = document.getElementById('startmsk-resultado');
            const interpretacionClinicaEl = document.getElementById('startmsk-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('startmsk-recomendaciones');

             if (badge) {
                 if (completo || itemsRespondidos > 0) { // Show badge if user interacted
                     badge.textContent = "Completado"; // Update later
                     badge.classList.remove("no-completado");
                     badge.classList.add("completado", "badge-verde"); // Start green
                 }
                 if (!completo && itemsRespondidos > 0) {
                     badge.textContent = "Incompleto";
                     badge.classList.remove("badge-verde");
                     badge.classList.add("no-completado");
                 }
                 if (itemsRespondidos === 0){
                      badge.textContent = "No completado";
                      badge.classList.remove("completado", "badge-verde");
                      badge.classList.add("no-completado");
                 }
            }


            if ( (completo || itemsRespondidos > 0) && valorTotalEl && valorFisicaEl && valorPsicosocialEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl) {
                let puntuacionTotal = 0;
                let puntuacionFisica = 0;
                let puntuacionPsicosocial = 0;
                items.forEach((item, index) => {
                    if (item !== null) {
                        const valor = parseInt(item.value);
                        puntuacionTotal += valor;
                        if (index < 4) puntuacionFisica += valor; // Items 1-4
                        else puntuacionPsicosocial += valor; // Items 5-10
                    }
                });

                valorTotalEl.textContent = puntuacionTotal + "/10" + mensajeIncompleto;
                valorFisicaEl.textContent = puntuacionFisica + "/4";
                 const riesgoPsicosocial = puntuacionPsicosocial >= 4 ? "elevado" : "bajo";
                valorPsicosocialEl.textContent = `${puntuacionPsicosocial}/6 (${riesgoPsicosocial})`;

                let nivelRiesgo = "";
                let colorBadge = "";
                let colorClase = "";
                if (puntuacionTotal <= 3) {
                    nivelRiesgo = "Riesgo bajo"; colorBadge = "bajo"; colorClase = "nivel-leve";
                } else if (puntuacionTotal <= 6) {
                    nivelRiesgo = "Riesgo medio"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                } else {
                    nivelRiesgo = "Riesgo alto"; colorBadge = "alto"; colorClase = "nivel-severo";
                }

                interpretacionTotalEl.textContent = completo ? nivelRiesgo : "Incompleto";
                interpretacionTotalEl.className = `resultado-interpretacion ${completo ? colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo") : ''}`;
                resultadoContainer.className = "resultado-container " + (completo ? colorClase : '');
                if(badge && (completo || itemsRespondidos > 0)) badge.textContent = completo ? nivelRiesgo : "Incompleto";
                 if(badge && completo) badge.className = "resultado-badge completado " + colorBadge;


                 // Clinical Interpretation
                 let interpretacionClinica = "";
                 if(completo){
                     if (puntuacionTotal <= 3) {
                         interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/10</strong>: <strong>Riesgo bajo</strong> de cronicidad.</p>
                            <p>Predominan factores biomecánicos. Buen pronóstico con tratamiento estándar.</p>
                            <p>Subescala Psicosocial (${puntuacionPsicosocial}/6): Riesgo ${riesgoPsicosocial}. ${riesgoPsicosocial === 'elevado' ? '<span class="text-danger">Monitorizar factores psicosociales.</span>' : ''}</p>`;
                     } else if (puntuacionTotal <= 6) {
                         interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/10</strong>: <strong>Riesgo medio</strong> de cronicidad.</p>
                            <p>Combinación de factores físicos y psicosociales. Requiere abordaje combinado.</p>
                            <p>Subescala Psicosocial (${puntuacionPsicosocial}/6): Riesgo ${riesgoPsicosocial}. ${riesgoPsicosocial === 'elevado' ? '<span class="text-danger">Factores psicosociales significativos presentes.</span>' : ''}</p>`;
                     } else {
                         interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/10</strong>: <strong>Riesgo alto</strong> de cronicidad.</p>
                            <p>Condición compleja con factores psicosociales importantes. Alto riesgo de dolor persistente. Requiere abordaje multidisciplinar.</p>
                            <p>Subescala Psicosocial (${puntuacionPsicosocial}/6): Riesgo ${riesgoPsicosocial}. <span class="text-danger">Factores psicosociales elevados requieren atención específica.</span></p>`;
                     }
                 } else {
                      interpretacionClinica = `<p>Cuestionario incompleto. Se requieren al menos 8 respuestas para una interpretación fiable.</p>`;
                 }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified, only if complete)
                 let recomendationsHTML = "";
                 if(completo){
                     if (puntuacionTotal <= 3) {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Bajo):</h6>
                            <ul>
                                <li>Fisioterapia estándar: Educación, ejercicio terapéutico específico, terapia manual si es necesario.</li>
                                <li>Fomentar autogestión y retorno a actividad.</li>
                                ${riesgoPsicosocial === 'elevado' ? '<li>Monitorizar y abordar factores psicosociales básicos.</li>' : ''}
                            </ul>`;
                     } else if (puntuacionTotal <= 6) {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Medio):</h6>
                            <ul>
                                <li>Abordaje combinado físico-psicosocial.</li>
                                <li>Ejercicio terapéutico progresivo + Educación en neurociencia del dolor.</li>
                                <li>Técnicas de exposición gradual si hay miedo-evitación.</li>
                                 <li>Estrategias de afrontamiento activo.</li>
                            </ul>`;
                     } else { // Alto
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Alto):</h6>
                            <ul>
                                <li>Abordaje multidisciplinar (fisio + psicólogo).</li>
                                <li>Intervención cognitivo-conductual + Ejercicio gradual.</li>
                                <li>Educación intensiva en neurociencia del dolor.</li>
                                 <li>Manejo de factores específicos (catastrofización, ansiedad, etc.).</li>
                                 <li>Establecimiento de objetivos funcionales realistas.</li>
                            </ul>`;
                     }
                 } else {
                     recomendationsHTML = `<p>Complete el cuestionario (al menos 8 respuestas) para obtener recomendaciones.</p>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else if (!interaccionUsuario) {
                // Reset if no interaction
                 if(valorTotalEl) valorTotalEl.textContent = "-/10";
                 if(valorFisicaEl) valorFisicaEl.textContent = "-/4";
                 if(valorPsicosocialEl) valorPsicosocialEl.textContent = "-/6";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete el cuestionario";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                 if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular el START Back Tool
        function calcularStartBack() {
            const items1a8 = [];
            let items1a8Respondidos = 0;
            for (let i = 1; i <= 8; i++) {
                const item = document.querySelector(`input[name="startback_item${i}"]:checked`);
                items1a8.push(item);
                 if(item) items1a8Respondidos++;
            }
            const item9 = document.querySelector('input[name="startback_item9"]:checked');
            const item9Respondido = item9 !== null;
            const itemsRespondidos = items1a8Respondidos + (item9Respondido ? 1 : 0);

            // START Back requiere al menos 7/9 items respondidos
            const respuestasMinimas = 7;
            const completo = itemsRespondidos >= respuestasMinimas;
             let mensajeIncompleto = completo ? "" : " (incompleto)";

             // Update UI elements safely
            const badge = document.getElementById('startback-badge');
            const valorTotalEl = document.getElementById('startback-valor-total');
            const valorPsicosocialEl = document.getElementById('startback-valor-psicosocial');
            const grupoRiesgoEl = document.getElementById('startback-grupo-riesgo');
            const interpretacionTotalEl = document.getElementById('startback-interpretacion-total');
            const resultadoContainer = document.getElementById('startback-resultado');
            const interpretacionClinicaEl = document.getElementById('startback-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('startback-recomendaciones');

             if (badge) {
                 if (completo || itemsRespondidos > 0) { // Show badge if user interacted
                     badge.textContent = "Completado"; // Update later
                     badge.classList.remove("no-completado");
                     badge.classList.add("completado", "badge-verde"); // Start green
                 }
                  if (!completo && itemsRespondidos > 0) {
                     badge.textContent = "Incompleto";
                     badge.classList.remove("badge-verde");
                     badge.classList.add("no-completado");
                 }
                 if (itemsRespondidos === 0) {
                      badge.textContent = "No completado";
                      badge.classList.remove("completado", "badge-verde");
                      badge.classList.add("no-completado");
                 }
            }


            if ( (completo || itemsRespondidos > 0) && valorTotalEl && valorPsicosocialEl && grupoRiesgoEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl ) {
                 let puntuacionItems1a8 = 0;
                 items1a8.forEach(item => { if (item) puntuacionItems1a8 += parseInt(item.value); });

                 let puntuacionItem9 = 0;
                 if (item9) {
                     const valorItem9 = parseInt(item9.value);
                     // Original START Back v1: 0-3=0, 4-5=1. Check if JS logic reflects this.
                     // Assuming the provided JS used the value directly or handled it.
                     // Let's assume the original logic intended to use the value if >= 4:
                     if (valorItem9 >= 4) { puntuacionItem9 = 1; }
                 }

                 const puntuacionTotal = puntuacionItems1a8 + puntuacionItem9; // Max 9

                 let puntuacionPsicosocial = 0;
                 for (let i = 4; i < 8; i++) { // Items 5-8 (indices 4-7)
                     if (items1a8[i]) puntuacionPsicosocial += parseInt(items1a8[i].value);
                 }
                 puntuacionPsicosocial += puntuacionItem9; // Max 5

                 valorTotalEl.textContent = puntuacionTotal + "/9" + mensajeIncompleto;
                 valorPsicosocialEl.textContent = puntuacionPsicosocial + "/5";

                 let grupoRiesgo = "";
                 let colorBadge = "";
                 let colorClase = "";
                 if (puntuacionTotal <= 3) {
                     grupoRiesgo = "Riesgo bajo"; colorBadge = "bajo"; colorClase = "nivel-leve";
                 } else if (puntuacionPsicosocial < 4) { // Total > 3 and Psychosocial < 4
                     grupoRiesgo = "Riesgo medio"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                 } else { // Total > 3 and Psychosocial >= 4
                     grupoRiesgo = "Riesgo alto"; colorBadge = "alto"; colorClase = "nivel-severo";
                 }

                 grupoRiesgoEl.textContent = grupoRiesgo;
                 interpretacionTotalEl.textContent = completo ? grupoRiesgo : "Incompleto";
                 interpretacionTotalEl.className = `resultado-interpretacion ${completo ? colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo") : ''}`;
                 resultadoContainer.className = "resultado-container " + (completo ? colorClase : '');
                  if(badge && (completo || itemsRespondidos > 0)) badge.textContent = completo ? grupoRiesgo : "Incompleto";
                  if(badge && completo) badge.className = "resultado-badge completado " + colorBadge;


                 // Clinical Interpretation
                 let interpretacionClinica = "";
                 if(completo){
                     if (grupoRiesgo === "Riesgo bajo") {
                         interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/9</strong> (Psicosocial ${puntuacionPsicosocial}/5): <strong>Riesgo bajo</strong>.</p>
                            <p>Bajo riesgo de mal pronóstico. Predominan factores biomecánicos. Buen pronóstico con tratamiento estándar.</p>`;
                     } else if (grupoRiesgo === "Riesgo medio") {
                          interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/9</strong> (Psicosocial ${puntuacionPsicosocial}/5): <strong>Riesgo medio</strong>.</p>
                            <p>Combinación de factores físicos y psicosociales (bajos). Requiere enfoque fisioterapéutico más intenso.</p>`;
                     } else { // Alto
                          interpretacionClinica = `
                            <p>Puntuación <strong>${puntuacionTotal}/9</strong> (Psicosocial ${puntuacionPsicosocial}/5): <strong>Riesgo alto</strong>.</p>
                            <p>Alto riesgo por factores psicosociales. Requiere abordaje integrado psicológico-físico.</p>`;
                     }
                 } else {
                      interpretacionClinica = `<p>Cuestionario incompleto. Se requieren al menos 7 respuestas para una interpretación fiable.</p>`;
                 }
                  interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified, only if complete)
                 let recomendationsHTML = "";
                 if(completo){
                     if (grupoRiesgo === "Riesgo bajo") {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Bajo):</h6>
                            <ul>
                                <li>Fisioterapia estándar: Educación, autogestión, ejercicio específico.</li>
                                <li>Promover actividad y evitar reposo.</li>
                            </ul>`;
                     } else if (grupoRiesgo === "Riesgo medio") {
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Medio):</h6>
                            <ul>
                                <li>Fisioterapia más intensa: Ejercicio terapéutico progresivo, control motor.</li>
                                 <li>Abordaje de factores físicos con consideración de psicosociales emergentes.</li>
                                 <li>Educación y estrategias de autogestión activa.</li>
                            </ul>`;
                     } else { // Alto
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Riesgo Alto):</h6>
                            <ul>
                                <li>Abordaje combinado psicológico-físico.</li>
                                <li>Intervención cognitivo-conductual, exposición gradual.</li>
                                <li>Educación en neurociencia del dolor.</li>
                                <li>Ejercicio adaptado para reducir miedo-evitación.</li>
                                <li>Considerar enfoque multidisciplinar.</li>
                            </ul>`;
                     }
                 } else {
                      recomendationsHTML = `<p>Complete el cuestionario (al menos 7 respuestas) para obtener recomendaciones.</p>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else if (!interaccionUsuario){
                 // Reset if no interaction
                  if(valorTotalEl) valorTotalEl.textContent = "-/9";
                  if(valorPsicosocialEl) valorPsicosocialEl.textContent = "-/5";
                  if(grupoRiesgoEl) grupoRiesgoEl.textContent = "-";
                  if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete el cuestionario";
                  if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                  if(resultadoContainer) resultadoContainer.className = "resultado-container";
                  if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                  if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                  if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }

        // Función para calcular el LEFS (Lower Extremity Functional Scale)
        function calcularLEFS() {
            const items = [];
            let itemsRespondidos = 0;
            for (let i = 1; i <= 20; i++) {
                const item = document.querySelector(`input[name="lefs_item${i}"]:checked`);
                items.push(item);
                 if(item) itemsRespondidos++;
            }

            // LEFS requiere al menos 16/20 items respondidos (~80%)
            const respuestasMinimas = 16;
            const completo = itemsRespondidos >= respuestasMinimas;
            let mensajeIncompleto = completo ? "" : " (incompleto)";

             // Update UI elements safely
            const badge = document.getElementById('lefs-badge');
            const valorTotalEl = document.getElementById('lefs-valor-total');
            const valorPorcentajeEl = document.getElementById('lefs-valor-porcentaje');
            const nivelDiscapacidadEl = document.getElementById('lefs-nivel-discapacidad');
            const interpretacionTotalEl = document.getElementById('lefs-interpretacion-total');
            const resultadoContainer = document.getElementById('lefs-resultado');
            const interpretacionClinicaEl = document.getElementById('lefs-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('lefs-recomendaciones');

             if (badge) {
                if (completo || itemsRespondidos > 0) { // Show badge if user interacted
                    badge.textContent = "Completado"; // Update later
                    badge.classList.remove("no-completado");
                    badge.classList.add("completado", "badge-verde"); // Start green
                }
                 if (!completo && itemsRespondidos > 0) {
                    badge.textContent = "Incompleto";
                    badge.classList.remove("badge-verde");
                    badge.classList.add("no-completado");
                }
                 if (itemsRespondidos === 0) {
                     badge.textContent = "No completado";
                     badge.classList.remove("completado", "badge-verde");
                     badge.classList.add("no-completado");
                 }
            }


            if ( (completo || itemsRespondidos > 0) && valorTotalEl && valorPorcentajeEl && nivelDiscapacidadEl && interpretacionTotalEl && resultadoContainer && interpretacionClinicaEl && recomendacionesEl ) {
                 let puntuacionTotal = 0;
                 items.forEach(item => { if (item) puntuacionTotal += parseInt(item.value); });
                 const maxPuntajePosible = itemsRespondidos * 4;

                 // Calculate percentage function (0-100%, 100% is best)
                 const porcentajeFuncion = itemsRespondidos > 0 ? (puntuacionTotal / maxPuntajePosible) * 100 : 0;
                 const porcentajeRedondeado = porcentajeFuncion.toFixed(1);

                 // Determine disability level (higher score = better function)
                 // Common interpretation: < 35 Severe, 35-65 Moderate, > 65 Mild/Minimal
                  // Let's use cutoffs based on typical score ranges roughly correlating to disability
                 const umbralSevero = Math.round(32 * (itemsRespondidos / 20)); // ~40% function
                 const umbralModerado = Math.round(56 * (itemsRespondidos / 20)); // ~70% function

                 let nivelDiscapacidad = "";
                 let colorBadge = "";
                 let colorClase = "";

                 if (puntuacionTotal < umbralSevero) { // Low score = high disability
                     nivelDiscapacidad = "Limitación severa"; colorBadge = "alto"; colorClase = "nivel-severo";
                 } else if (puntuacionTotal < umbralModerado) {
                     nivelDiscapacidad = "Limitación moderada"; colorBadge = "moderado"; colorClase = "nivel-moderado";
                 } else { // High score = low disability
                     nivelDiscapacidad = "Limitación leve"; colorBadge = "bajo"; colorClase = "nivel-leve";
                 }

                 valorTotalEl.textContent = `${puntuacionTotal}/${maxPuntajePosible}${mensajeIncompleto}`;
                 valorPorcentajeEl.textContent = porcentajeRedondeado + "%";
                 nivelDiscapacidadEl.textContent = nivelDiscapacidad;
                 interpretacionTotalEl.textContent = completo ? nivelDiscapacidad : "Incompleto";
                  interpretacionTotalEl.className = `resultado-interpretacion ${completo ? colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo") : ''}`; // Colors represent disability level
                  resultadoContainer.className = "resultado-container " + (completo ? colorClase : '');
                  if(badge && (completo || itemsRespondidos > 0)) badge.textContent = completo ? nivelDiscapacidad : "Incompleto";
                  if(badge && completo) badge.className = "resultado-badge completado " + colorBadge;


                  // Clinical Interpretation
                 let interpretacionClinica = "";
                  const mcid = 9; // Minimal Clinically Important Difference for LEFS
                 if(completo){
                      if (puntuacionTotal >= umbralModerado) { // Limitación leve
                         interpretacionClinica = `
                            <p>Puntuación LEFS <strong>${puntuacionTotal}/${maxPuntajePosible} (${porcentajeRedondeado}%)</strong>: <strong>Limitación leve</strong>.</p>
                            <p>Buena capacidad funcional general. Posibles restricciones leves en actividades de alta demanda. MCID = ${mcid} pts.</p>`;
                     } else if (puntuacionTotal >= umbralSevero) { // Limitación moderada
                         interpretacionClinica = `
                            <p>Puntuación LEFS <strong>${puntuacionTotal}/${maxPuntajePosible} (${porcentajeRedondeado}%)</strong>: <strong>Limitación moderada</strong>.</p>
                            <p>Dificultades significativas en actividades de mayor demanda (correr, saltar, agacharse). Posibles compensaciones en AVD. MCID = ${mcid} pts.</p>`;
                     } else { // Limitación severa
                         interpretacionClinica = `
                            <p>Puntuación LEFS <strong>${puntuacionTotal}/${maxPuntajePosible} (${porcentajeRedondeado}%)</strong>: <strong>Limitación severa</strong>.</p>
                            <p>Restricciones importantes en mayoría de AVD (caminar, escaleras, autocuidado). Impacto significativo en calidad de vida. MCID = ${mcid} pts.</p>`;
                     }
                 } else {
                      interpretacionClinica = `<p>Cuestionario incompleto. Se requieren al menos 16 respuestas para una interpretación fiable.</p>`;
                 }
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;

                 // Therapeutic Recommendations (Simplified, only if complete)
                 let recomendationsHTML = "";
                  if(completo){
                       if (puntuacionTotal >= umbralModerado) { // Limitación leve
                         recomendationsHTML = `
                            <h6>Intervención Sugerida (Limitación Leve):</h6>
                            <ul>
                                <li>Fortalecimiento progresivo, control neuromuscular avanzado.</li>
                                <li>Entrenamiento funcional específico y readaptación deportiva.</li>
                                <li>Ejercicios pliométricos/potencia según demanda.</li>
                                <li>Prevención de recidivas.</li>
                            </ul>`;
                     } else if (puntuacionTotal >= umbralSevero) { // Limitación moderada
                          recomendationsHTML = `
                            <h6>Intervención Sugerida (Limitación Moderada):</h6>
                            <ul>
                                <li>Programa progresivo de fortalecimiento y control motor.</li>
                                <li>Entrenamiento propioceptivo y de equilibrio.</li>
                                <li>Reeducación de patrones de movimiento funcional.</li>
                                <li>Ejercicio aeróbico adaptado.</li>
                            </ul>`;
                     } else { // Limitación severa
                          recomendationsHTML = `
                            <h6>Intervención Sugerida (Limitación Severa):</h6>
                            <ul>
                                <li>Rehabilitación integral con progresión muy gradual.</li>
                                <li>Ejercicios iniciales en descarga/asistidos.</li>
                                <li>Entrenamiento funcional básico (transferencias, marcha).</li>
                                <li>Manejo del dolor multimodal.</li>
                                <li>Considerar ayudas técnicas.</li>
                            </ul>`;
                     }
                 } else {
                      recomendationsHTML = `<p>Complete el cuestionario (al menos 16 respuestas) para obtener recomendaciones.</p>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else if (!interaccionUsuario){
                 // Reset if no interaction
                  if(valorTotalEl) valorTotalEl.textContent = "-/80";
                  if(valorPorcentajeEl) valorPorcentajeEl.textContent = "-%";
                  if(nivelDiscapacidadEl) nivelDiscapacidadEl.textContent = "-";
                  if(interpretacionTotalEl) interpretacionTotalEl.textContent = "Complete el cuestionario";
                  if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                  if(resultadoContainer) resultadoContainer.className = "resultado-container";
                  if(interpretacionClinicaEl) interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica.";
                  if(recomendacionesEl) recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                   if(badge) badge.className = "resultado-badge no-completado";
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // ***** FIN JAVASCRIPT PARTE 5 *****
    // ***** INICIO JAVASCRIPT PARTE 6 *****

        // Función para calcular el HOOS (Hip Disability and Osteoarthritis Outcome Score)
        function calcularHOOS() {
            const categorias = {
                sintomas: { items: ['hoos_s1', 'hoos_s2', 'hoos_s3', 'hoos_s4', 'hoos_s5'], total: 5 },
                dolor: { items: ['hoos_p1', 'hoos_p2', 'hoos_p3', 'hoos_p4', 'hoos_p5', 'hoos_p6', 'hoos_p7', 'hoos_p8', 'hoos_p9', 'hoos_p10'], total: 10 },
                avd: { items: ['hoos_a1', 'hoos_a2', 'hoos_a3', 'hoos_a4', 'hoos_a5', 'hoos_a6', 'hoos_a7', 'hoos_a8', 'hoos_a9', 'hoos_a10', 'hoos_a11', 'hoos_a12', 'hoos_a13', 'hoos_a14', 'hoos_a15', 'hoos_a16', 'hoos_a17'], total: 17 },
                deporte: { items: ['hoos_sp1', 'hoos_sp2', 'hoos_sp3', 'hoos_sp4'], total: 4 },
                qol: { items: ['hoos_q1', 'hoos_q2', 'hoos_q3', 'hoos_q4'], total: 4 }
            };

            const puntuaciones = {};
            const itemsRespondidos = {};
            let totalRespondidosGeneral = 0;
            let interaccionUsuario = false;

            for (const [categoria, data] of Object.entries(categorias)) {
                puntuaciones[categoria] = 0;
                itemsRespondidos[categoria] = 0;
                for (const item of data.items) {
                    const valor = document.querySelector(`input[name="${item}"]:checked`)?.value;
                    if (valor !== undefined) {
                        puntuaciones[categoria] += parseInt(valor);
                        itemsRespondidos[categoria]++;
                        totalRespondidosGeneral++;
                        interaccionUsuario = true;
                    }
                }
            }

            // Update UI elements safely
            const badge = document.getElementById('hoos-badge');
            const valorTotalEl = document.getElementById('hoos-valor-total');
            const interpretacionTotalEl = document.getElementById('hoos-interpretacion-total');
            const resultadoContainer = document.getElementById('hoos-resultado');
            const interpretacionClinicaEl = document.getElementById('hoos-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('hoos-recomendaciones');
            const idsPorCategoria = {
                sintomas: 'hoos-valor-sintomas', dolor: 'hoos-valor-dolor', avd: 'hoos-valor-avd',
                deporte: 'hoos-valor-deporte', qol: 'hoos-valor-qol'
            };

            // Check if at least 2 items per category are answered for valid subscale score
            let categoriasValidas = 0;
            const puntuacionesNormalizadas = {};

            for (const [categoria, data] of Object.entries(categorias)) {
                 const elementoValorSubescala = document.getElementById(idsPorCategoria[categoria]);
                 if (itemsRespondidos[categoria] >= 2) { // Minimum 2 answers per subscale needed
                     // Calculate normalized score (0-100, 100 = best)
                     const puntuacionMedia = puntuaciones[categoria] / itemsRespondidos[categoria];
                     puntuacionesNormalizadas[categoria] = 100 - (puntuacionMedia * 25);
                     categoriasValidas++;
                      if(elementoValorSubescala) elementoValorSubescala.textContent = `${puntuacionesNormalizadas[categoria].toFixed(1)}%`;
                 } else {
                     puntuacionesNormalizadas[categoria] = null;
                     // Display 'N/A' or similar if not enough answers for the subscale
                      if(elementoValorSubescala) elementoValorSubescala.textContent = "N/A";
                 }
            }

            // Overall score is average of the 5 VALID subscale scores
             const puntuacionTotalNormalizada = categoriasValidas > 0 ?
                 Object.values(puntuacionesNormalizadas).filter(v => v !== null).reduce((sum, v) => sum + v, 0) / categoriasValidas
                 : null;

            // Update badge based on overall interaction
             let completoGeneral = totalRespondidosGeneral >= Math.ceil(Object.values(categorias).reduce((sum, cat) => sum + cat.total, 0) * 0.8); // Check if ~80% of ALL questions are answered
             let nivelAfectacion = "No evaluable";
             let colorBadge = "no-completado";
             let colorClase = "";

             if (badge) {
                 if (puntuacionTotalNormalizada !== null && completoGeneral) { // Check if overall score is calculable and most items answered
                     if (puntuacionTotalNormalizada >= 70) { nivelAfectacion = "Afectación leve"; colorBadge = "bajo"; colorClase="nivel-leve"; }
                     else if (puntuacionTotalNormalizada >= 40) { nivelAfectacion = "Afectación moderada"; colorBadge = "moderado"; colorClase="nivel-moderado";}
                     else { nivelAfectacion = "Afectación severa"; colorBadge = "alto"; colorClase="nivel-severo";}
                     badge.textContent = nivelAfectacion;
                     badge.className = "resultado-badge completado " + colorBadge;
                 } else if (interaccionUsuario) {
                     badge.textContent = "Incompleto";
                     badge.className = "resultado-badge no-completado";
                 } else {
                      badge.textContent = "No completado";
                      badge.className = "resultado-badge no-completado";
                 }
             }

              // Update total score display
              if (valorTotalEl) {
                 valorTotalEl.textContent = puntuacionTotalNormalizada !== null ? `${puntuacionTotalNormalizada.toFixed(1)}%` : "N/A";
                  if(!completoGeneral && interaccionUsuario) valorTotalEl.textContent += " (incompleto)";
              }
              if (interpretacionTotalEl) {
                  interpretacionTotalEl.textContent = nivelAfectacion;
                  if (puntuacionTotalNormalizada !== null && completoGeneral) {
                       interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                  } else {
                       interpretacionTotalEl.className = "resultado-interpretacion";
                  }
              }
              if (resultadoContainer) resultadoContainer.className = "resultado-container " + (completoGeneral ? colorClase : '');


            // Update clinical interpretation and recommendations only if overall score is valid
            if (puntuacionTotalNormalizada !== null && completoGeneral && interpretacionClinicaEl && recomendacionesEl) {
                 let interpretacionClinica = "";
                  if (puntuacionTotalNormalizada >= 70) {
                      interpretacionClinica = `
                        <p>Puntuación HOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación leve</strong>.</p>
                        <p>Buena funcionalidad general. Síntomas leves. Posibles limitaciones en actividades de alta demanda.</p>`;
                 } else if (puntuacionTotalNormalizada >= 40) {
                      interpretacionClinica = `
                        <p>Puntuación HOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación moderada</strong>.</p>
                        <p>Dolor/síntomas moderados. Dificultades en AVD y actividades deportivas. Calidad de vida afectada.</p>`;
                 } else {
                      interpretacionClinica = `
                        <p>Puntuación HOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación severa</strong>.</p>
                        <p>Dolor/síntomas severos. Limitaciones importantes en AVD y calidad de vida. Requiere abordaje integral.</p>`;
                 }
                 // Add subscale details
                 interpretacionClinica += "<p>Detalle subescalas (%): ";
                 interpretacionClinica += Object.entries(puntuacionesNormalizadas)
                     .map(([key, val]) => `${key.toUpperCase()}: ${val !== null ? val.toFixed(1) : 'N/A'}`)
                     .join('; ');
                 interpretacionClinica += "</p>";
                 interpretacionClinicaEl.innerHTML = interpretacionClinica;


                 // Simplified recommendations
                 let recomendationsHTML = "";
                  if (puntuacionTotalNormalizada >= 70) {
                     recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Leve):</h6>
                        <ul>
                            <li>Fortalecimiento específico cadera/core, control neuromuscular.</li>
                            <li>Entrenamiento funcional para actividades específicas.</li>
                             <li>Educación en biomecánica y prevención.</li>
                        </ul>`;
                 } else if (puntuacionTotalNormalizada >= 40) {
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Moderada):</h6>
                        <ul>
                            <li>Programa multimodal: Ejercicio (fuerza, control motor, aeróbico), terapia manual.</li>
                             <li>Educación en manejo de síntomas y pacing.</li>
                             <li>Reentrenamiento funcional y adaptaciones.</li>
                        </ul>`;
                 } else { // Severa
                      recomendationsHTML = `
                        <h6>Intervención Sugerida (Afectación Severa):</h6>
                        <ul>
                            <li>Abordaje integral, posiblemente multidisciplinar.</li>
                            <li>Ejercicio terapéutico muy gradual, manejo del dolor.</li>
                             <li>Entrenamiento funcional básico, ayudas técnicas si es necesario.</li>
                              <li>Educación avanzada y estrategias de autogestión.</li>
                               <li>Considerar evaluación médica para opciones avanzadas.</li>
                        </ul>`;
                 }
                 recomendacionesEl.innerHTML = recomendationsHTML;


            } else if (interpretacionClinicaEl && recomendacionesEl) {
                 // Reset if incomplete or no interaction
                 interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica (mínimo 2 respuestas por sección).";
                 recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                 if(interpretacionTotalEl) interpretacionTotalEl.textContent = "No evaluable";
                 if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                 if(resultadoContainer) resultadoContainer.className = "resultado-container";
                 // Badge handled above
            }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // Función para calcular el KOOS (Knee Injury and Osteoarthritis Outcome Score)
        function calcularKOOS() {
             const categorias = {
                sintomas: { items: ['koos_s1', 'koos_s2', 'koos_s3', 'koos_s4', 'koos_s5', 'koos_s6', 'koos_s7'], total: 7 },
                dolor: { items: ['koos_p1', 'koos_p2', 'koos_p3', 'koos_p4', 'koos_p5', 'koos_p6', 'koos_p7', 'koos_p8', 'koos_p9'], total: 9 },
                avd: { items: ['koos_a1', 'koos_a2', 'koos_a3', 'koos_a4', 'koos_a5', 'koos_a6', 'koos_a7', 'koos_a8', 'koos_a9', 'koos_a10', 'koos_a11', 'koos_a12', 'koos_a13', 'koos_a14', 'koos_a15', 'koos_a16', 'koos_a17'], total: 17 },
                deporte: { items: ['koos_sp1', 'koos_sp2', 'koos_sp3', 'koos_sp4', 'koos_sp5'], total: 5 },
                qol: { items: ['koos_q1', 'koos_q2', 'koos_q3', 'koos_q4'], total: 4 }
            };

            const puntuaciones = {};
            const itemsRespondidos = {};
            let totalRespondidosGeneral = 0;
             let interaccionUsuario = false;


            for (const [categoria, data] of Object.entries(categorias)) {
                puntuaciones[categoria] = 0;
                itemsRespondidos[categoria] = 0;
                for (const item of data.items) {
                    const valor = document.querySelector(`input[name="${item}"]:checked`)?.value;
                    if (valor !== undefined) {
                        puntuaciones[categoria] += parseInt(valor);
                        itemsRespondidos[categoria]++;
                        totalRespondidosGeneral++;
                        interaccionUsuario = true;
                    }
                }
            }

            // Update UI elements safely
            const badge = document.getElementById('koos-badge');
            const valorTotalEl = document.getElementById('koos-valor-total');
            const interpretacionTotalEl = document.getElementById('koos-interpretacion-total');
            const resultadoContainer = document.getElementById('koos-resultado');
            const interpretacionClinicaEl = document.getElementById('koos-interpretacion-clinica');
            const recomendacionesEl = document.getElementById('koos-recomendaciones');
            const idsPorCategoria = {
                sintomas: 'koos-valor-sintomas', dolor: 'koos-valor-dolor', avd: 'koos-valor-avd',
                deporte: 'koos-valor-deporte', qol: 'koos-valor-qol'
            };

             // Check if at least 2 items per category are answered
             let categoriasValidas = 0;
             const puntuacionesNormalizadas = {};

             for (const [categoria, data] of Object.entries(categorias)) {
                  const elementoValorSubescala = document.getElementById(idsPorCategoria[categoria]);
                  if (itemsRespondidos[categoria] >= 2) { // Minimum 2 answers per subscale needed
                      const puntuacionMedia = puntuaciones[categoria] / itemsRespondidos[categoria];
                      puntuacionesNormalizadas[categoria] = 100 - (puntuacionMedia * 25); // 100 = best
                      categoriasValidas++;
                      if(elementoValorSubescala) elementoValorSubescala.textContent = `${puntuacionesNormalizadas[categoria].toFixed(1)}%`;
                  } else {
                      puntuacionesNormalizadas[categoria] = null;
                      if(elementoValorSubescala) elementoValorSubescala.textContent = "N/A";
                  }
             }

            // Overall score is average of the 5 VALID subscale scores
             const puntuacionTotalNormalizada = categoriasValidas > 0 ?
                 Object.values(puntuacionesNormalizadas).filter(v => v !== null).reduce((sum, v) => sum + v, 0) / categoriasValidas
                 : null;

              // Update badge based on overall interaction and validity
              let completoGeneral = totalRespondidosGeneral >= Math.ceil(Object.values(categorias).reduce((sum, cat) => sum + cat.total, 0) * 0.8); // Check if ~80% of ALL questions are answered
              let nivelAfectacion = "No evaluable";
              let colorBadge = "no-completado";
              let colorClase = "";

              if (badge) {
                  if (puntuacionTotalNormalizada !== null && completoGeneral) {
                      if (puntuacionTotalNormalizada >= 70) { nivelAfectacion = "Afectación leve"; colorBadge = "bajo"; colorClase="nivel-leve"; }
                      else if (puntuacionTotalNormalizada >= 40) { nivelAfectacion = "Afectación moderada"; colorBadge = "moderado"; colorClase="nivel-moderado";}
                      else { nivelAfectacion = "Afectación severa"; colorBadge = "alto"; colorClase="nivel-severo";}
                      badge.textContent = nivelAfectacion;
                      badge.className = "resultado-badge completado " + colorBadge;
                  } else if (interaccionUsuario) {
                      badge.textContent = "Incompleto";
                      badge.className = "resultado-badge no-completado";
                  } else {
                       badge.textContent = "No completado";
                       badge.className = "resultado-badge no-completado";
                  }
              }

               // Update total score display
               if (valorTotalEl) {
                  valorTotalEl.textContent = puntuacionTotalNormalizada !== null ? `${puntuacionTotalNormalizada.toFixed(1)}%` : "N/A";
                   if(!completoGeneral && interaccionUsuario) valorTotalEl.textContent += " (incompleto)";
               }
               if (interpretacionTotalEl) {
                   interpretacionTotalEl.textContent = nivelAfectacion;
                   if (puntuacionTotalNormalizada !== null && completoGeneral) {
                        interpretacionTotalEl.className = `resultado-interpretacion ${colorBadge.replace("bajo", "verde").replace("moderado", "amarillo").replace("alto", "rojo")}`;
                   } else {
                        interpretacionTotalEl.className = "resultado-interpretacion";
                   }
               }
               if (resultadoContainer) resultadoContainer.className = "resultado-container " + (completoGeneral ? colorClase : '');


             // Update clinical interpretation and recommendations only if overall score is valid
             if (puntuacionTotalNormalizada !== null && completoGeneral && interpretacionClinicaEl && recomendacionesEl) {
                  let interpretacionClinica = "";
                   if (puntuacionTotalNormalizada >= 70) {
                       interpretacionClinica = `
                         <p>Puntuación KOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación leve</strong>.</p>
                         <p>Buena funcionalidad general. Síntomas leves. Posibles limitaciones en actividades de alta demanda/deportivas.</p>`;
                  } else if (puntuacionTotalNormalizada >= 40) {
                       interpretacionClinica = `
                         <p>Puntuación KOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación moderada</strong>.</p>
                         <p>Dolor/síntomas moderados. Dificultades en AVD (escaleras, cuclillas) y deportes. Calidad de vida afectada.</p>`;
                  } else {
                       interpretacionClinica = `
                         <p>Puntuación KOOS promedio <strong>${puntuacionTotalNormalizada.toFixed(1)}%</strong>: <strong>Afectación severa</strong>.</p>
                         <p>Dolor/síntomas severos. Limitaciones importantes en AVD y calidad de vida. Requiere abordaje integral.</p>`;
                  }
                   // Add subscale details
                  interpretacionClinica += "<p>Detalle subescalas (%): ";
                  interpretacionClinica += Object.entries(puntuacionesNormalizadas)
                      .map(([key, val]) => `${key.toUpperCase()}: ${val !== null ? val.toFixed(1) : 'N/A'}`)
                      .join('; ');
                  interpretacionClinica += "</p>";
                  interpretacionClinicaEl.innerHTML = interpretacionClinica;


                  // Simplified recommendations
                  let recomendationsHTML = "";
                   if (puntuacionTotalNormalizada >= 70) {
                      recomendationsHTML = `
                         <h6>Intervención Sugerida (Afectación Leve):</h6>
                         <ul>
                             <li>Fortalecimiento específico rodilla/cadera, control neuromuscular.</li>
                             <li>Entrenamiento funcional y readaptación deportiva.</li>
                             <li>Educación en biomecánica y prevención.</li>
                         </ul>`;
                  } else if (puntuacionTotalNormalizada >= 40) {
                       recomendationsHTML = `
                         <h6>Intervención Sugerida (Afectación Moderada):</h6>
                         <ul>
                             <li>Programa multimodal: Ejercicio (fuerza, control motor, aeróbico), terapia manual.</li>
                             <li>Educación en manejo de síntomas y pacing.</li>
                             <li>Reentrenamiento funcional y adaptaciones.</li>
                              <li>Entrenamiento propioceptivo y de equilibrio.</li>
                         </ul>`;
                  } else { // Severa
                       recomendationsHTML = `
                         <h6>Intervención Sugerida (Afectación Severa):</h6>
                         <ul>
                             <li>Abordaje integral, posiblemente multidisciplinar.</li>
                             <li>Ejercicio terapéutico muy gradual, manejo del dolor.</li>
                             <li>Entrenamiento funcional básico, ayudas técnicas si es necesario.</li>
                              <li>Educación avanzada y estrategias de autogestión.</li>
                               <li>Considerar evaluación médica para opciones avanzadas.</li>
                         </ul>`;
                  }
                  recomendacionesEl.innerHTML = recomendationsHTML;


             } else if (interpretacionClinicaEl && recomendacionesEl) {
                  // Reset if incomplete or no interaction
                  interpretacionClinicaEl.textContent = "Complete el cuestionario para obtener la interpretación clínica (mínimo 2 respuestas por sección).";
                  recomendacionesEl.textContent = "Complete el cuestionario para obtener recomendaciones terapéuticas.";
                   if(interpretacionTotalEl) interpretacionTotalEl.textContent = "No evaluable";
                   if(interpretacionTotalEl) interpretacionTotalEl.className = "resultado-interpretacion";
                   if(resultadoContainer) resultadoContainer.className = "resultado-container";
                   // Badge handled above
             }
            // Actualizar barra de progreso
            setTimeout(actualizarProgresoTotal, 100);
        }


        // ***** FIN JAVASCRIPT PARTE 6 *****
    // ***** INICIO NUEVA FUNCIÓN GUARDAR PDF *****

       async function guardarCuestionarioComoPDF(idContenidoCuestionario, nombreCuestionario) {
    console.log(`Iniciando generación de PDF para: ${nombreCuestionario}`);
    const { jsPDF } = window.jspdf;

    // Obtener información del paciente
    const nombrePaciente = document.getElementById('nombrePaciente')?.value || 'No especificado';
    const fechaInput = document.getElementById('fechaEvaluacion')?.value;
    let fechaFormateada = 'No especificada';
    if (fechaInput) {
        try {
            const parts = fechaInput.split('-');
            const fechaObj = new Date(parts[0], parts[1] - 1, parts[2]);
            if (!isNaN(fechaObj)) {
                fechaFormateada = fechaObj.toLocaleDateString('es-CL', { day: '2-digit', month: 'long', year: 'numeric' });
            }
        } catch (e) { console.error("Error formateando fecha:", e); }
    }

    // Crear PDF
    const pdf = new jsPDF({
        orientation: 'p',
        unit: 'mm',
        format: 'a4'
    });

    // Configuración de página
    const pageWidth = pdf.internal.pageSize.getWidth();
    const pageHeight = pdf.internal.pageSize.getHeight();
    const margin = 15;
    const contentWidth = pageWidth - (margin * 2);
    let yPos = margin;

    // Función para comprobar espacio y añadir nueva página si es necesario
    function checkNewPage(requiredSpace) {
        if (yPos + requiredSpace > pageHeight - margin) {
            pdf.addPage();
            yPos = margin;
            return true;
        }
        return false;
    }

    // Estilo de cabecera
    pdf.setFillColor(76, 123, 156); // Color primario
    pdf.rect(0, 0, pageWidth, 25, 'F');
    
    pdf.setFont("helvetica", "bold");
    pdf.setFontSize(16);
    pdf.setTextColor(255, 255, 255); // Texto blanco
    pdf.text(nombreCuestionario, pageWidth / 2, 15, { align: "center" });
    
    // Información del paciente
    yPos = 30;
    pdf.setFontSize(12);
    pdf.setTextColor(60, 60, 60);
    pdf.text("INFORMACIÓN DEL PACIENTE", margin, yPos);
    yPos += 8;
    
    pdf.setFontSize(10);
    pdf.setFont("helvetica", "normal");
    pdf.text(`Nombre: ${nombrePaciente}`, margin, yPos);
    yPos += 6;
    pdf.text(`Fecha de evaluación: ${fechaFormateada}`, margin, yPos);
    yPos += 10;

    // Línea separadora
    pdf.setDrawColor(76, 123, 156);
    pdf.setLineWidth(0.5);
    pdf.line(margin, yPos, pageWidth - margin, yPos);
    yPos += 10;

    // Obtener elemento del cuestionario
    const elementoContenido = document.getElementById(idContenidoCuestionario);
    if (!elementoContenido) {
        console.error(`Error: No se encontró el contenido para ${idContenidoCuestionario}`);
        alert(`Error al generar el PDF para ${nombreCuestionario}.`);
        return;
    }

    // ======== SECCIÓN: PREGUNTAS Y RESPUESTAS ========
    pdf.setFontSize(12);
    pdf.setFont("helvetica", "bold");
    pdf.setTextColor(76, 123, 156);
    pdf.text("CUESTIONARIO", margin, yPos);
    yPos += 8;

    pdf.setFont("helvetica", "normal");
    pdf.setFontSize(10);
    pdf.setTextColor(60, 60, 60);

    // Obtener todas las preguntas y respuestas
    const radioInputs = elementoContenido.querySelectorAll('input[type="radio"]:checked');
    const checkboxInputs = elementoContenido.querySelectorAll('input[type="checkbox"]:checked');
    const rangeInputs = elementoContenido.querySelectorAll('input[type="range"]');
    
    // Agrupar por pregunta para radios
    const respuestasPorPregunta = {};
    
    // Procesar radiobuttons
    radioInputs.forEach(radio => {
        if (!radio.name) return;
        
        let pregunta = '';
        let containerElement = radio.closest('tr') || radio.closest('.mb-3');
        
        if (containerElement) {
            // Buscar etiqueta de pregunta en el mismo contenedor
            const labelElement = containerElement.querySelector('td:first-child') || 
                                 containerElement.querySelector('label.form-label') ||
                                 containerElement.previousElementSibling;
                                 
            if (labelElement) {
                pregunta = labelElement.textContent.trim();
            }
            
            // Si no encontramos la pregunta en el contenedor inmediato, buscar hacia arriba
            if (!pregunta) {
                const sectionHeader = findClosestHeader(containerElement);
                if (sectionHeader) {
                    pregunta = sectionHeader.textContent.trim();
                }
            }
            
            // Si sigue sin encontrar, usar el nombre del input como último recurso
            if (!pregunta) {
                pregunta = radio.name.replace(/_/g, ' ').replace(/item\d+/i, 'Pregunta');
            }
            
            // Obtener el valor de la respuesta (etiqueta o valor)
            let respuesta = '';
            const radioLabel = radio.closest('label') || document.querySelector(`label[for="${radio.id}"]`);
            
            if (radioLabel && !radioLabel.textContent.includes('input')) {
                respuesta = radioLabel.textContent.trim();
            } else {
                // Si no hay etiqueta clara, usar el valor
                respuesta = radio.value;
                
                // Para algunos cuestionarios, convertir valores numéricos a texto descriptivo
                if (radio.name.includes('groc')) {
                    const valorNum = parseInt(radio.value);
                    if (valorNum < 0) respuesta = `${valorNum} (Peor)`;
                    else if (valorNum > 0) respuesta = `+${valorNum} (Mejor)`;
                    else respuesta = "0 (Sin cambios)";
                }
            }
            
            // Almacenar respuesta
            respuestasPorPregunta[pregunta] = respuesta;
        }
    });
    
    // Procesar checkboxes
    checkboxInputs.forEach(checkbox => {
        if (!checkbox.id) return;
        
        const checkboxLabel = document.querySelector(`label[for="${checkbox.id}"]`);
        if (checkboxLabel) {
            const pregunta = "Condiciones seleccionadas";
            
            if (!respuestasPorPregunta[pregunta]) {
                respuestasPorPregunta[pregunta] = [];
            }
            
            if (Array.isArray(respuestasPorPregunta[pregunta])) {
                respuestasPorPregunta[pregunta].push(checkboxLabel.textContent.trim());
            }
        }
    });
    
    // Procesar sliders
    rangeInputs.forEach(range => {
        if (!range.id) return;
        
        let pregunta = '';
        const labelElement = document.querySelector(`label[for="${range.id}"]`);
        
        if (labelElement) {
            pregunta = labelElement.textContent.trim();
            const valor = range.value;
            
            // Para algunos cuestionarios, añadir descripción al valor
            if (range.id.includes('sane')) {
                respuestasPorPregunta[pregunta] = `${valor}/100`;
            } else if (range.id.includes('dolor')) {
                respuestasPorPregunta[pregunta] = `${valor}/10`;
            } else {
                respuestasPorPregunta[pregunta] = valor;
            }
        }
    });
    
    // Función auxiliar para encontrar el encabezado más cercano
    function findClosestHeader(element) {
        let current = element;
        while (current) {
            const prevSibling = current.previousElementSibling;
            if (prevSibling && 
                (prevSibling.tagName === 'H5' || 
                 prevSibling.tagName === 'H4' || 
                 prevSibling.classList.contains('form-label'))) {
                return prevSibling;
            }
            current = current.parentElement;
        }
        return null;
    }
    
    // Imprimir preguntas y respuestas
    Object.entries(respuestasPorPregunta).forEach(([pregunta, respuesta]) => {
        // Verificar espacio para nueva pregunta y respuesta
        checkNewPage(15);
        
        pdf.setFont("helvetica", "bold");
        const preguntaLines = pdf.splitTextToSize(pregunta, contentWidth);
        pdf.text(preguntaLines, margin, yPos);
        yPos += preguntaLines.length * 5;
        
        pdf.setFont("helvetica", "normal");
        
        // Si la respuesta es un array (checkboxes), unir con comas
        let respuestaText = Array.isArray(respuesta) ? respuesta.join(", ") : respuesta.toString();
        
        const respuestaLines = pdf.splitTextToSize(`Respuesta: ${respuestaText}`, contentWidth);
        pdf.text(respuestaLines, margin, yPos);
        yPos += respuestaLines.length * 5 + 5;
    });
    
    // Añadir espacio después de preguntas
    yPos += 5;
    checkNewPage(20);
    
    // Línea separadora
    pdf.setDrawColor(76, 123, 156);
    pdf.line(margin, yPos, pageWidth - margin, yPos);
    yPos += 10;

    // ======== SECCIÓN: RESULTADOS ========
    const resultadoContainer = elementoContenido.querySelector('.resultado-container');
    if (resultadoContainer) {
        checkNewPage(40);
        
        // Título de resultados
        pdf.setFontSize(12);
        pdf.setFont("helvetica", "bold");
        pdf.setTextColor(76, 123, 156);
        pdf.text("RESULTADOS", margin, yPos);
        yPos += 8;
        
        pdf.setFont("helvetica", "normal");
        pdf.setFontSize(10);
        pdf.setTextColor(60, 60, 60);
        
        // Extracción de valores
        const valorTotal = resultadoContainer.querySelector('[id$="-valor-total"]')?.textContent || '';
        const interpretacion = resultadoContainer.querySelector('[id$="-interpretacion-total"]')?.textContent || '';
        const subescalas = {};
        
        // Buscar subescalas (elementos con id que terminen en "-valor-*")
        const subescalaElements = resultadoContainer.querySelectorAll('[id$="-valor-dolor"], [id$="-valor-rigidez"], [id$="-valor-funcion"], [id$="-valor-avd"], [id$="-valor-deporte"], [id$="-valor-qol"], [id$="-valor-fisica"], [id$="-valor-psicosocial"], [id$="-valor-rumiacion"], [id$="-valor-magnificacion"], [id$="-valor-desesperanza"], [id$="-valor-discapacidad"], [id$="-valor-porcentaje"]');
        
        subescalaElements.forEach(element => {
            if (element.id && element.id.includes('-valor-')) {
                const name = element.id.split('-valor-')[1];
                subescalas[name] = element.textContent;
            }
        });
        
        // Escribir resultados
        if (valorTotal) {
            pdf.setFont("helvetica", "bold");
            pdf.text(`Puntuación Total:`, margin, yPos);
            pdf.setFont("helvetica", "normal");
            pdf.text(valorTotal, margin + 40, yPos);
            yPos += 6;
        }
        
        if (interpretacion) {
            pdf.setFont("helvetica", "bold");
            pdf.text(`Interpretación:`, margin, yPos);
            pdf.setFont("helvetica", "normal");
            pdf.text(interpretacion, margin + 40, yPos);
            yPos += 6;
        }
        
        // Añadir subescalas si existen
        if (Object.keys(subescalas).length > 0) {
            pdf.setFont("helvetica", "bold");
            pdf.text(`Subescalas:`, margin, yPos);
            yPos += 6;
            
            pdf.setFont("helvetica", "normal");
            Object.entries(subescalas).forEach(([name, value]) => {
                // Formatear el nombre de la subescala para que sea más legible
                const formattedName = name.charAt(0).toUpperCase() + name.slice(1)
                    .replace(/([A-Z])/g, ' $1')
                    .replace(/-/g, ' ');
                
                pdf.text(`- ${formattedName}: ${value}`, margin + 5, yPos);
                yPos += 5;
                
                // Comprobar si necesitamos una nueva página
                checkNewPage(5);
            });
            
            yPos += 3;
        }
        
        // Añadir interpretación clínica si existe
        const interpretacionClinica = resultadoContainer.querySelector('[id$="-interpretacion-clinica"]');
        if (interpretacionClinica) {
            checkNewPage(30);
            
            pdf.setFontSize(12);
            pdf.setFont("helvetica", "bold");
            pdf.setTextColor(76, 123, 156);
            pdf.text("INTERPRETACIÓN CLÍNICA", margin, yPos);
            yPos += 8;
            
            pdf.setFontSize(10);
            pdf.setFont("helvetica", "normal");
            pdf.setTextColor(60, 60, 60);
            
            const textoLimpio = limpiarHTML(interpretacionClinica.innerHTML);
            const lineasInterpretacion = pdf.splitTextToSize(textoLimpio, contentWidth);
            
            pdf.text(lineasInterpretacion, margin, yPos);
            yPos += (lineasInterpretacion.length * 5) + 5;
        }
        
        // Añadir recomendaciones si existen
        const recomendaciones = resultadoContainer.querySelector('[id$="-recomendaciones"]');
        if (recomendaciones) {
            checkNewPage(30);
            
            pdf.setFontSize(12);
            pdf.setFont("helvetica", "bold");
            pdf.setTextColor(76, 123, 156);
            pdf.text("RECOMENDACIONES TERAPÉUTICAS", margin, yPos);
            yPos += 8;
            
            pdf.setFontSize(10);
            pdf.setFont("helvetica", "normal");
            pdf.setTextColor(60, 60, 60);
            
            const textoLimpio = limpiarHTML(recomendaciones.innerHTML);
            const lineasRecomendaciones = pdf.splitTextToSize(textoLimpio, contentWidth);
            
            pdf.text(lineasRecomendaciones, margin, yPos);
            yPos += (lineasRecomendaciones.length * 5);
        }
    } else {
        pdf.text("No se encontraron resultados para este cuestionario.", margin, yPos);
    }

    // Añadir pie de página con logo y número de página
    const totalPages = pdf.internal.getNumberOfPages();
    for (let i = 1; i <= totalPages; i++) {
        pdf.setPage(i);
        
        // Línea inferior
        pdf.setDrawColor(76, 123, 156);
        pdf.setLineWidth(0.5);
        pdf.line(margin, pageHeight - 15, pageWidth - margin, pageHeight - 15);
        
        // Información de página
        pdf.setFontSize(8);
        pdf.setTextColor(100, 100, 100);
        pdf.text(`Evaluación Kinesiológica - ${nombreCuestionario}`, margin, pageHeight - 10);
        pdf.text(`Página ${i} de ${totalPages}`, pageWidth - margin, pageHeight - 10, { align: "right" });
    }

    // Guardar el PDF
    const nombreLimpio = nombrePaciente.replace(/[^a-z0-9_-\s]/gi, '').replace(/\s+/g, '_') || 'SinNombre';
    const fechaLimpia = fechaFormateada.replace(/[^a-z0-9_-]/gi, '-') || 'SinFecha';
    const cuestionarioLimpio = nombreCuestionario.replace(/[^a-z0-9_-]/gi, '_');
    const nombreArchivo = `Cuestionario_${cuestionarioLimpio}_${nombreLimpio}_${fechaLimpia}.pdf`;
    
    pdf.save(nombreArchivo);
    console.log(`PDF generado con éxito: ${nombreArchivo}`);
}

// Función auxiliar para limpiar HTML
function limpiarHTML(html) {
    if (!html) return '';
    
    // Eliminar etiquetas HTML
    let texto = html.replace(/<\/?[^>]+(>|$)/g, " ")
                    .replace(/<li>/g, "• ") // Convertir <li> en viñetas
                    .replace(/<\/li>/g, "\n"); // Añadir salto después de cada item
    
    // Reemplazar entidades HTML comunes
    texto = texto.replace(/&nbsp;/g, " ")
                .replace(/&lt;/g, "<")
                .replace(/&gt;/g, ">")
                .replace(/&amp;/g, "&")
                .replace(/&quot;/g, '"')
                .replace(/&apos;/g, "'");
    
    // Preservar saltos de línea significativos pero eliminar extras
    texto = texto.replace(/\n+/g, "\n").trim();
    
    // Eliminar espacios múltiples
    texto = texto.replace(/\s+/g, " ").trim();
    
    return texto;
}

// Función auxiliar para limpiar HTML
function limpiarHTML(html) {
    if (!html) return '';
    
    // Eliminar etiquetas HTML
    let texto = html.replace(/<\/?[^>]+(>|$)/g, " ");
    
    // Reemplazar entidades HTML comunes
    texto = texto.replace(/&nbsp;/g, " ")
                .replace(/&lt;/g, "<")
                .replace(/&gt;/g, ">")
                .replace(/&amp;/g, "&")
                .replace(/&quot;/g, '"')
                .replace(/&apos;/g, "'");
    
    // Eliminar espacios múltiples
    texto = texto.replace(/\s+/g, " ").trim();
    
    return texto;
}

        // ***** FIN NUEVA FUNCIÓN GUARDAR PDF *****

    // ***** INICIO CÓDIGO DE INICIALIZACIÓN *****

        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha de hoy por defecto
            try {
                const today = new Date();
                // Ajuste para obtener la fecha local en formato YYYY-MM-DD independientemente de la zona horaria
                const offset = today.getTimezoneOffset() * 60000; // Offset en milisegundos
                const localDate = new Date(today.getTime() - offset);
                const formattedDate = localDate.toISOString().split('T')[0];

                const fechaInput = document.getElementById('fechaEvaluacion');
                if(fechaInput) {
                    fechaInput.value = formattedDate;
                }
            } catch (e) {
                 console.error("Error estableciendo fecha por defecto:", e);
            }


            // Llamar a todas las funciones de cálculo para inicializar los resultados
            // Se usan comprobaciones 'typeof' para evitar errores si alguna función no existe
            console.log("Inicializando cálculos de cuestionarios...");
            if (typeof calcularPSFS === 'function') calcularPSFS();
            if (typeof calcularGROC === 'function') calcularGROC();
            if (typeof calcularSANE === 'function') calcularSANE();
            if (typeof calcularBPI === 'function') calcularBPI();
            if (typeof calcularPCS === 'function') calcularPCS();
            if (typeof calcularCSI === 'function') calcularCSI();
            if (typeof calcularTSK === 'function') calcularTSK();
            if (typeof calcularDN4 === 'function') calcularDN4();
            if (typeof calcularNDI === 'function') calcularNDI();
            if (typeof calcularQuickDASH === 'function') calcularQuickDASH();
            if (typeof calcularSPADI === 'function') calcularSPADI();
            if (typeof calcularOswestry === 'function') calcularOswestry();
            if (typeof calcularRolandMorris === 'function') calcularRolandMorris();
            if (typeof calcularWOMAC === 'function') calcularWOMAC();
            if (typeof calcularStartMSK === 'function') calcularStartMSK();
            if (typeof calcularStartBack === 'function') calcularStartBack();
            if (typeof calcularLEFS === 'function') calcularLEFS();
            if (typeof calcularHOOS === 'function') calcularHOOS();
            if (typeof calcularKOOS === 'function') calcularKOOS();
             console.log("Cálculos iniciales completados.");

            // Reasignar evento onclick para headers del acordeón
            // Esto asegura que funcionen incluso si el script carga antes que el HTML
             console.log("Asignando eventos de acordeón...");
             document.querySelectorAll('.cuestionario-header').forEach(header => {
                 const contentElement = header.nextElementSibling; // El div de contenido es el siguiente elemento
                  if (contentElement && contentElement.id && contentElement.classList.contains('cuestionario-content')) {
                     const contentId = contentElement.id;
                     // Asignar directamente el evento onclick
                     header.onclick = function() { toggleCuestionario(contentId); };
                 } else {
                      console.warn("Elemento de contenido no encontrado o sin ID para el header:", header);
                  }
             });
             console.log("Eventos de acordeón asignados.");

        });
        // ***** FIN CÓDIGO DE INICIALIZACIÓN *****

    // Funciones para la interfaz moderna
document.addEventListener('DOMContentLoaded', function() {
    // Inicializar modo oscuro
    const darkModeToggle = document.getElementById('darkModeToggle');
    const body = document.body;
    
    // Comprobar preferencia guardada
    const darkModeSaved = localStorage.getItem('darkMode') === 'true';
    if (darkModeSaved) {
        body.classList.add('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }
    
    darkModeToggle.addEventListener('click', function() {
        body.classList.toggle('dark-mode');
        const isDarkMode = body.classList.contains('dark-mode');
        localStorage.setItem('darkMode', isDarkMode);
        
        darkModeToggle.innerHTML = isDarkMode 
            ? '<i class="fas fa-sun"></i>' 
            : '<i class="fas fa-moon"></i>';
    });
    
    // Generar navegación de pestañas
    const questionnaireTabs = document.getElementById('questionnaireTabs');
    const cuestionarioItems = document.querySelectorAll('.cuestionario-item');
    
    if (questionnaireTabs && cuestionarioItems.length > 0) {
        cuestionarioItems.forEach((item, index) => {
            const id = item.id;
            const titulo = item.querySelector('.cuestionario-header h4').innerText.trim();
            const badge = item.querySelector('.resultado-badge').cloneNode(true);
            
            const li = document.createElement('li');
            li.className = 'nav-item';
            
            const button = document.createElement('button');
            button.className = 'nav-link';
            button.textContent = titulo.replace(/\([^)]*\)/g, '').trim();
            if (index === 0) button.classList.add('active');
            
            button.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Activar pestaña
                document.querySelectorAll('#questionnaireTabs .nav-link').forEach(tab => {
                    tab.classList.remove('active');
                });
                button.classList.add('active');
                
                // Mostrar cuestionario y ocultar los demás
                cuestionarioItems.forEach(item => {
                    item.style.display = 'none';
                });
                document.getElementById(id).style.display = 'block';
                
                // Expandir el contenido
                const contentId = document.getElementById(id).querySelector('.cuestionario-content').id;
                if (document.getElementById(contentId).style.display === 'none') {
                    toggleCuestionario(contentId);
                }
            });
            
            li.appendChild(button);
            questionnaireTabs.appendChild(li);
        });
    }
    
    // Actualizar progreso de cuestionarios completados
    actualizarProgresoTotal();
});

// Función para actualizar la barra de progreso
function actualizarProgresoTotal() {
    const totalCuestionarios = document.querySelectorAll('.cuestionario-item').length;
    const completados = document.querySelectorAll('.resultado-badge.completado').length;
    
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    
    if (progressBar && progressText) {
        const porcentaje = totalCuestionarios > 0 ? (completados / totalCuestionarios) * 100 : 0;
        progressBar.style.width = `${porcentaje}%`;
        progressText.textContent = `${completados} de ${totalCuestionarios} cuestionarios completados`;
    }
}

// Sobrescribir la función toggleCuestionario para actualizar progreso
const originalToggleCuestionario = toggleCuestionario;
toggleCuestionario = function(contentId) {
    originalToggleCuestionario(contentId);
    setTimeout(actualizarProgresoTotal, 100); // Pequeño retraso para que se actualice después de los cálculos
}
    
    </script> 
    </body> 
</html>

